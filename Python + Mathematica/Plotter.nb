(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    275291,       6109]
NotebookOptionsPosition[    270592,       6025]
NotebookOutlinePosition[    271117,       6044]
CellTagsIndexPosition[    271074,       6041]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Clearing variables", "Title",
 CellChangeTimes->{{3.896880434009879*^9, 
  3.8968804370397625`*^9}},ExpressionUUID->"77f8df86-6a9f-4879-bc32-\
9275d4face24"],

Cell["\<\
This section is used to clear all the variables previously stored in \
Mathematica\
\>", "Text",
 CellChangeTimes->{{3.8968804615807247`*^9, 
  3.896880483388689*^9}},ExpressionUUID->"45326316-4145-432f-89a9-\
747b68a3aa30"],

Cell[BoxData[
 RowBox[{"Quiet", "@", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",ExpressionUUID->\
"2932a2ed-eea1-4963-8632-1e3547b3c238"]
}, Closed]],

Cell[CellGroupData[{

Cell["Auxiliary Functions", "Title",
 CellChangeTimes->{{3.8462929118646145`*^9, 3.846292914883447*^9}, 
   3.846296551105155*^9, 3.850457702086286*^9, {3.8968896288750563`*^9, 
   3.8968896291470537`*^9}},ExpressionUUID->"656e802e-4c40-491b-94a5-\
e18c034cec54"],

Cell[TextData[{
 "This section defines some auxiliary functions used to read ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"L", 
     StyleBox[
      AdjustmentBox["A",
       BoxBaselineShift->-0.4,
       BoxMargins->{{-0.5, -0.3}, {0, 0}}],
      FontSize->Smaller], "T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]],ExpressionUUID->
  "7c804fc6-9d77-477f-b610-da2b2aaaec06"],
 " input into Mathematica"
}], "Text",
 CellChangeTimes->{{3.8741446338101244`*^9, 
  3.874144661517753*^9}},ExpressionUUID->"333e06fd-bda8-481a-a7ae-\
e2bc0b510fa7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FormattingStrings", "[", "string_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"string", ",", 
        RowBox[{"\"\<+ \>\"", "->", "\"\<+\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\< +\>\"", "->", "\"\<+\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\<- \>\"", "->", "\"\<-\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\< -\>\"", "->", "\"\<-\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\<\\\\cdot \>\"", "->", "\"\<\\\\cdot\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\< \\\\cdot\>\"", "->", "\"\<\\\\cdot\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\< \>\"", "->", "\"\<\\\\times\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\<\\\\cdot\>\"", "->", "\"\<\\\\times\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\<\\\\times\>\"", "->", "\"\< \\\\times \>\""}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\<\\\\mu_{NF}\>\"", "->", "\"\<{muNF}\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"auxiliarystring", ",", "TeXForm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "auxiliarystring", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormattingStringsCommaSplit", "[", "string_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"string", ",", 
        RowBox[{"\"\<+ \>\"", "->", "\"\<+\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\< +\>\"", "->", "\"\<+\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\<- \>\"", "->", "\"\<-\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\< -\>\"", "->", "\"\<-\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\<\\\\cdot \>\"", "->", "\"\<\\\\cdot\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\< \\\\cdot\>\"", "->", "\"\<\\\\cdot\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\< \>\"", "->", "\"\<\\\\times\>\""}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\<\\\\cdot\>\"", "->", "\"\<\\\\times\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\<\\\\times\>\"", "->", "\"\< \\\\times \>\""}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"auxiliarystring", ",", 
        RowBox[{"\"\<\\\\mu_{NF}\>\"", "->", "\"\<{muNF}\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"auxiliarystring", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"auxiliarystring", ",", "\"\<,\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "auxiliarystring", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8462929289791536`*^9, 3.846292952437869*^9}, {
   3.8462930896506367`*^9, 3.84629330221982*^9}, {3.846293336538272*^9, 
   3.8462933425357523`*^9}, 3.8462933760532537`*^9, {3.846293453160466*^9, 
   3.846293559393343*^9}, {3.8462935989196525`*^9, 3.846293810290836*^9}, {
   3.8462938425426903`*^9, 3.846293852761169*^9}, {3.8462939461671457`*^9, 
   3.84629395018258*^9}, {3.846294030504323*^9, 3.8462940314091444`*^9}, {
   3.846294104855338*^9, 3.8462941340561934`*^9}, {3.8462941736313252`*^9, 
   3.846294209174167*^9}, {3.8462944743315964`*^9, 3.8462944972246456`*^9}, {
   3.84629463065096*^9, 3.846294708338766*^9}, {3.846294752225127*^9, 
   3.846294752411974*^9}, {3.8462947946479063`*^9, 3.8462948993657904`*^9}, {
   3.8462949366926966`*^9, 3.846294946270363*^9}, {3.846294999135788*^9, 
   3.8462951142519355`*^9}, {3.8462951506655817`*^9, 
   3.8462951508601923`*^9}, {3.8462953782561207`*^9, 3.8462953793313*^9}, {
   3.8462955142684917`*^9, 3.846295527836093*^9}, {3.846295718993743*^9, 
   3.846295793377288*^9}, {3.8462965439004564`*^9, 3.8462965641154814`*^9}, {
   3.8462976093055906`*^9, 3.846297781039149*^9}, 3.8462979971891747`*^9, {
   3.8479894694931974`*^9, 3.84798947690432*^9}, {3.8479910972215157`*^9, 
   3.847991097225444*^9}, {3.851719056450363*^9, 3.8517190565672235`*^9}, {
   3.8581161616292276`*^9, 3.8581161976945066`*^9}, {3.896880428155857*^9, 
   3.8968804294755836`*^9}},ExpressionUUID->"165428b9-478f-4fca-b265-\
766d7de2d9aa"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Vector field", "Title"]], "Title",
 CellChangeTimes->{
  3.868530938081033*^9, {3.8686303998898067`*^9, 
   3.8686304016488895`*^9}},ExpressionUUID->"cfb7ff55-9e3e-44eb-b010-\
aa12f359418b"],

Cell["\<\
This section loads the List of Kinetics and variables and finds the \
equilibria of the system if eqbool=1. Otherwise, it only loads Kinetics. This \
cell requires some input only if Mathematica finds more than one homogeneous \
steady-state\
\>", "Text",
 CellChangeTimes->{{3.8741446779167895`*^9, 
  3.874144764477979*^9}},ExpressionUUID->"603c7a43-6c76-4990-b1b0-\
a51d7a961bc4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqbool", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"FileExistsQ", "[", "\"\<Kinetics.txt\>\"", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nvar", "=", 
     RowBox[{"Length", "@", 
      RowBox[{"ReadList", "[", 
       RowBox[{"\"\<Kinetics.txt\>\"", ",", 
        RowBox[{"null", "@", "String"}], ",", 
        RowBox[{"NullRecords", "->", "True"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aux", "=", 
     RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"aux", ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<The file 'Kinetics.txt' was not found. Run the Python \
script first.\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Quit", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kinetics", "=", 
   RowBox[{"Range", "[", "nvar", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"Range", "[", "nvar", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"varnum", "=", "1"}], ",", 
    RowBox[{"varnum", "<=", "nvar"}], ",", 
    RowBox[{"varnum", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"kinetics", "[", 
       RowBox[{"[", "varnum", "]"}], "]"}], "=", 
      RowBox[{"ReadLine", "[", "\"\<Kinetics.txt\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kinetics", "[", 
       RowBox[{"[", "varnum", "]"}], "]"}], "=", 
      RowBox[{"FormattingStrings", "[", 
       RowBox[{"kinetics", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "\"\<List of variables.txt\>\"", "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}], "=", 
         RowBox[{"ReadLine", "[", "\"\<List of variables.txt\>\"", "]"}]}], 
        ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"aux", "=", 
         RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SelectionMove", "[", 
         RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"NotebookWrite", "[", 
         RowBox[{"aux", ",", 
          RowBox[{"Cell", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{
             "{", "\"\<The file 'List of variables.txt' was not be found. Run \
the Python script first.\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Quit", "[", "]"}]}]}], "\n", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"var", "[", 
       RowBox[{"[", "varnum", "]"}], "]"}], "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "varnum", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "\"\<Kinetics.txt\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "\"\<List of variables.txt\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"eqbool", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqs", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"kinetics", "==", "0"}], ",", "var"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "eqs", "]"}], ">", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Your system has \>\"", " ", "<>", " ", 
              RowBox[{"ToString", "[", 
               RowBox[{"Length", "[", "eqs", "]"}], "]"}], " ", "<>", " ", 
              "\"\< equilibria\>\""}], "}"}], "]"}], ",", "\"\<Output\>\""}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"eqnum", "=", "1"}], ",", 
         RowBox[{"eqnum", "<=", 
          RowBox[{"Length", "[", "eqs", "]"}]}], ",", 
         RowBox[{"eqnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SelectionMove", "[", 
           RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"NotebookWrite", "[", 
           RowBox[{"aux", ",", 
            RowBox[{"Cell", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<Equilibrium number \>\"", " ", "<>", " ", 
                  RowBox[{"ToString", "[", "eqnum", "]"}], " ", "<>", " ", 
                  "\"\< is equal to \>\""}], ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"eqs", "[", 
                    RowBox[{"[", "eqnum", "]"}], "]"}], ",", 
                   RowBox[{"FormatType", "->", "StandardForm"}]}], "]"}]}], 
                "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnumber", "=", 
        RowBox[{
        "Input", "[", 
         "\"\<Enter the number of the equilibrium point you would like to \
consider. Enter 0 if the software did not find your desired homogeneous \
steady-state or you want to consider them all\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookClose", "[", "aux", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"eqnumber", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eq", "=", 
           RowBox[{"{", "0", "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eq", "=", 
           RowBox[{
            RowBox[{"eqs", "[", 
             RowBox[{"[", "eqnumber", "]"}], "]"}], "//", "Simplify"}]}], 
          ";"}]}], "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Mathematica found only one homogeneous steady-state in your \
system. It will proceed with that one.\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eq", "=", 
        RowBox[{
         RowBox[{"eqs", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq", "=", 
     RowBox[{"{", "0", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8686304118487797`*^9, 3.868630420282346*^9}, {
  3.8695944793305273`*^9, 3.8695945152022142`*^9}, {3.869594560932351*^9, 
  3.869594563949497*^9}, {3.8695947207007346`*^9, 3.869594727070239*^9}, {
  3.8695950152154455`*^9, 3.869595123119829*^9}, {3.869595162750659*^9, 
  3.8695951629794173`*^9}, {3.86959523970187*^9, 3.86959524151783*^9}, {
  3.869667004524927*^9, 3.8696671049160542`*^9}, {3.8696675592844677`*^9, 
  3.8696677276714444`*^9}, {3.8696699421353617`*^9, 3.869669943210584*^9}, {
  3.871409127548854*^9, 3.871409128536146*^9}, {3.8726947689029846`*^9, 
  3.8726948121247168`*^9}, {3.896367465722149*^9, 
  3.8963674660641146`*^9}},ExpressionUUID->"e355d9ee-cf66-4ea3-b37b-\
80019a7b1bbf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Turing bifurcation variables and Fixed parameters", "Title",
 CellChangeTimes->{{3.8383016845273094`*^9, 3.8383017300970154`*^9}, {
  3.868461391711518*^9, 3.868461398442008*^9}, {3.896883116425784*^9, 
  3.8968831166799726`*^9}},ExpressionUUID->"6b1368fc-8535-487b-a757-\
1df89674a1ae"],

Cell["\<\
This section loads the functions required to find and continue Turing \
bifurcations, and evaluates the parameters that remain fixed throughout the \
computation\
\>", "Text",
 CellChangeTimes->{{3.874144780999271*^9, 
  3.8741448039215717`*^9}},ExpressionUUID->"7f370b43-db6a-4899-9799-\
13d0f3292753"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FileExistsQ", "[", "\"\<Third-order coefficient.txt\>\"", "]"}], 
    " ", "||", " ", 
    RowBox[{"FileExistsQ", "[", "\"\<Third-order coefficient.mx\>\"", "]"}]}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FileExistsQ", "[", "\"\<Third-order coefficient.mx\>\"", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C3", "=", 
       RowBox[{"Import", "[", "\"\<Third-order coefficient.mx\>\"", "]"}]}], 
      ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C3", "=", 
       RowBox[{"Import", "[", "\"\<Third-order coefficient.txt\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"C3", "=", 
       RowBox[{"FormattingStrings", "[", "C3", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<Third-order coefficient.mx\>\"", ",", "C3"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aux", "=", 
     RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"aux", ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<The file 'Third-order coefficient.txt' was not found. Run \
the Python script first.\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}],
      "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Quit", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
    "FileExistsQ", "[", "\"\<Determinant of the Jacobian matrix.txt\>\"", 
     "]"}], " ", "||", " ", 
    RowBox[{
    "FileExistsQ", "[", "\"\<Determinant of the Jacobian matrix.mx\>\"", 
     "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
     "FileExistsQ", "[", "\"\<Determinant of the Jacobian matrix.mx\>\"", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zerodet", "=", 
       RowBox[{
       "Import", "[", "\"\<Determinant of the Jacobian matrix.mx\>\"", 
        "]"}]}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zerodet", "=", 
       RowBox[{
       "Import", "[", "\"\<Determinant of the Jacobian matrix.txt\>\"", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zerodet", "=", 
       RowBox[{"FormattingStrings", "[", "zerodet", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
       "\"\<Determinant of the Jacobian matrix.mx\>\"", ",", " ", "zerodet"}],
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aux", "=", 
     RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"aux", ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<The file 'Determinant of the Jacobian matrix.txt' was not \
found. Run the Python script first.\>\"", "}"}], "]"}], ",", 
        "\"\<Output\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Quit", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
    "FileExistsQ", "[", "\"\<Derivative of the Determinant.txt\>\"", "]"}], 
    " ", "||", " ", 
    RowBox[{
    "FileExistsQ", "[", "\"\<Derivative of the Determinant.mx\>\"", "]"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
     "FileExistsQ", "[", "\"\<Derivative of the Determinant.mx\>\"", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zeroder", "=", 
       RowBox[{
       "Import", "[", "\"\<Derivative of the Determinant.mx\>\"", "]"}]}], 
      ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zeroder", "=", 
       RowBox[{
       "Import", "[", "\"\<Derivative of the Determinant.txt\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"zeroder", "=", 
       RowBox[{"FormattingStrings", "[", "zeroder", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
       "\"\<Derivative of the Determinant.mx\>\"", ",", " ", "zeroder"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aux", "=", 
     RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"aux", ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<The file 'Derivative of the Determinant.txt' was not \
found. Run the Python script first.\>\"", "}"}], "]"}], ",", 
        "\"\<Output\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Quit", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FileExistsQ", "[", "\"\<Non-zero variable.txt\>\"", "]"}], " ", "||",
     " ", 
    RowBox[{"FileExistsQ", "[", "\"\<Non-zero variable.mx\>\"", "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FileExistsQ", "[", "\"\<Non-zero variable.mx\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nonzero", "=", 
       RowBox[{"Import", "[", "\"\<Non-zero variable.mx\>\"", "]"}]}], ";"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nonzero", "=", 
       RowBox[{"Import", "[", "\"\<Non-zero variable.txt\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nonzero", "=", 
       RowBox[{"FormattingStrings", "[", "nonzero", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"\"\<Non-zero variable.mx\>\"", ",", " ", "nonzero"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aux", "=", 
     RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"aux", ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<The file 'Non-zero variable.txt' was not found. Run the \
Python script first.\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Quit", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"FileExistsQ", "[", "\"\<Fixed parameter values.txt\>\"", "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nparametereval", "=", 
     RowBox[{"Length", "@", 
      RowBox[{"ReadList", "[", 
       RowBox[{"\"\<Fixed parameter values.txt\>\"", ",", 
        RowBox[{"null", "@", "String"}], ",", 
        RowBox[{"NullRecords", "->", "True"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aux", "=", 
     RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"aux", ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<The file 'Fixed parameter values.txt' was not found. Run \
the Python script first.\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}],
      "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Quit", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fixedpar", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"Nparametereval", ">", "0"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", "Nparametereval"}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{
        "ReadLine", "[", "\"\<Fixed parameter values.txt\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"aux", "=", 
        RowBox[{"FormattingStringsCommaSplit", "[", "aux", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"parname", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"parval", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"fixedpar", ",", 
         RowBox[{"parname", "->", "parval"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Close", "[", "\"\<Fixed parameter values.txt\>\"", "]"}], 
    ";"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8358618234911523`*^9, 3.835861834178746*^9}, {
   3.835976512542263*^9, 3.8359765662913833`*^9}, {3.835976751510523*^9, 
   3.8359769302039914`*^9}, {3.8359771491583643`*^9, 3.8359772121196747`*^9}, 
   3.8359782144030414`*^9, 3.836039396935573*^9, {3.836049871042845*^9, 
   3.8360498734677*^9}, {3.8367224737203627`*^9, 3.8367224862180567`*^9}, 
   3.8383013118239822`*^9, {3.8387071674839787`*^9, 3.8387072180137005`*^9}, {
   3.838707248623996*^9, 3.838707341872489*^9}, {3.838707838034856*^9, 
   3.8387078988543596`*^9}, {3.838708010310297*^9, 3.838708013211622*^9}, {
   3.838709963526287*^9, 3.838709971436034*^9}, {3.838796407630077*^9, 
   3.8387964426079617`*^9}, {3.838879492357067*^9, 3.838879776012884*^9}, {
   3.839081290507903*^9, 3.839081337922917*^9}, {3.8390894776189184`*^9, 
   3.839089479591245*^9}, {3.8401329615891933`*^9, 3.840133042987008*^9}, {
   3.840133113355274*^9, 3.840133193883274*^9}, {3.840133233504379*^9, 
   3.840133246293227*^9}, {3.840133426436248*^9, 3.840133427812249*^9}, 
   3.8401335461380105`*^9, {3.840453476848151*^9, 3.8404535059802604`*^9}, {
   3.8404535401174927`*^9, 3.84045369293264*^9}, {3.8407383866446943`*^9, 
   3.8407384130862284`*^9}, {3.8410763982429905`*^9, 3.841076672399166*^9}, 
   3.841077044413261*^9, {3.8411445196687555`*^9, 3.8411446026905994`*^9}, {
   3.841145863532087*^9, 3.8411458840075912`*^9}, {3.8411459204436936`*^9, 
   3.8411461706787024`*^9}, {3.8411469416234303`*^9, 3.841146980682357*^9}, {
   3.8411471218382072`*^9, 3.8411471322908683`*^9}, {3.841147549972013*^9, 
   3.8411476120300913`*^9}, {3.84118506726151*^9, 3.8411851411098623`*^9}, {
   3.8412468247964687`*^9, 3.8412469206049995`*^9}, {3.84143538587745*^9, 
   3.84143541468617*^9}, {3.841436070224923*^9, 3.8414360702631626`*^9}, {
   3.8459382503542995`*^9, 3.845938273580656*^9}, {3.8459385063046703`*^9, 
   3.8459385769082336`*^9}, {3.846292590711358*^9, 3.8462927384756207`*^9}, {
   3.846295434311427*^9, 3.846295454488018*^9}, {3.846295547480464*^9, 
   3.846295590893399*^9}, {3.8462958113492365`*^9, 3.846295833618307*^9}, {
   3.855171380108647*^9, 3.855171400281336*^9}, {3.8678412794789224`*^9, 
   3.8678412801621084`*^9}, {3.8684613766452904`*^9, 
   3.8684613828514977`*^9}, {3.869667120241046*^9, 3.8696672237890244`*^9}, {
   3.8830580565125084`*^9, 3.883058105437085*^9}, {3.8968805529021034`*^9, 
   3.896880604091699*^9}, {3.8968807369576583`*^9, 3.8968807386076174`*^9}, {
   3.8968807822929754`*^9, 3.896880904228814*^9}, {3.896880940175233*^9, 
   3.8968810395791845`*^9}, {3.8968811399598913`*^9, 
   3.8968813286905794`*^9}, {3.8968831061039667`*^9, 
   3.8968831115627*^9}},ExpressionUUID->"47b09d0b-e895-4096-b07a-\
c4c7a19e5112"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameters on the axes of the bifurcation diagram", "Title",
 CellChangeTimes->{{3.8383017423065667`*^9, 3.8383017579170465`*^9}, {
  3.841185269608903*^9, 
  3.84118527141858*^9}},ExpressionUUID->"a4bdec2e-f6d4-4657-b8b4-\
76183b2ecf81"],

Cell["\<\
In this section, Mathematica loads the file with the parameters on the axes \
of the bifurcation diagram and the intervals over which they change\
\>", "Text",
 CellChangeTimes->{{3.8741448257822347`*^9, 
  3.874144854574851*^9}},ExpressionUUID->"b5477da1-e976-4ef3-9e69-\
45d9f3b72aeb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"npar", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"par", "=", 
   RowBox[{"Range", "[", "npar", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowerbound", "=", 
   RowBox[{"Range", "[", "npar", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upperbound", "=", 
   RowBox[{"Range", "[", "npar", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"parnum", "=", "1"}], ",", 
   RowBox[{"parnum", "<=", "npar"}], ",", 
   RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", "\"\<Parameters on axes.txt\>\"", "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"ReadLine", "[", "\"\<Parameters on axes.txt\>\"", "]"}]}], 
       ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{
            "{", "\"\<The file 'Parameters on axes.txt' was not found. Run \
the Python script first.\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Quit", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"aux", "=", 
     RowBox[{"FormattingStringsCommaSplit", "[", "aux", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"par", "[", 
      RowBox[{"[", "parnum", "]"}], "]"}], "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{
       RowBox[{"aux", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lowerbound", "[", 
      RowBox[{"[", "parnum", "]"}], "]"}], "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{
       RowBox[{"aux", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"upperbound", "[", 
      RowBox[{"[", "parnum", "]"}], "]"}], "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{
       RowBox[{"aux", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "\"\<Parameters on axes.txt\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
    "FileExistsQ", "[", "\"\<Actual names of parameters.txt\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"aux", "=", 
      RowBox[{
      "ReadLine", "[", "\"\<Actual names of parameters.txt\>\"", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"aux", "=", 
      RowBox[{"FormattingStringsCommaSplit", "[", "aux", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newparam1", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{
        RowBox[{"aux", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newparam2", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{
        RowBox[{"aux", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Close", "[", "\"\<Actual names of parameters.txt\>\"", "]"}], 
     ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newparam1", "=", 
      RowBox[{"par", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newparam2", "=", 
      RowBox[{"par", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.835861846474986*^9, 3.8358618568896494`*^9}, 
   3.838301327877832*^9, {3.8387964566580505`*^9, 3.8387964571501584`*^9}, {
   3.8388799389990497`*^9, 3.8388800325383625`*^9}, {3.840134026286628*^9, 
   3.8401340422328587`*^9}, {3.840653246528323*^9, 3.8406532523395443`*^9}, {
   3.8407384201330895`*^9, 3.8407384238812714`*^9}, {3.8410766846970325`*^9, 
   3.841076750584734*^9}, 3.8411462716128054`*^9, {3.8411465884704375`*^9, 
   3.8411466003358307`*^9}, {3.841185147974797*^9, 3.841185228274433*^9}, {
   3.841246925935276*^9, 3.841246938525836*^9}, {3.84133740103339*^9, 
   3.841337407919462*^9}, {3.841435419927191*^9, 3.841435421272247*^9}, 
   3.8414360702954845`*^9, {3.8459385840708256`*^9, 3.8459385918438606`*^9}, {
   3.846292750829569*^9, 3.846292807821407*^9}, {3.8462958705146513`*^9, 
   3.8462958768307486`*^9}, {3.847989283871208*^9, 3.847989302519949*^9}, {
   3.847989369057757*^9, 3.8479893695843277`*^9}, {3.848336801611143*^9, 
   3.8483368204336596`*^9}, {3.8578102363919497`*^9, 
   3.8578102375269413`*^9}, {3.8678413074110994`*^9, 
   3.8678413086665077`*^9}, {3.8683569442142487`*^9, 3.868356972488657*^9}, {
   3.868357002776072*^9, 3.868357093129767*^9}, {3.8694356879720993`*^9, 
   3.8694357144131703`*^9}, {3.869667233818798*^9, 3.869667241187331*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"47f29af5-90a6-416b-851b-bc0d861fff99"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bifurcation curves", "Title",
 CellChangeTimes->{{3.838301768996684*^9, 3.8383017820666866`*^9}, {
  3.8402216752640443`*^9, 3.840221678671386*^9}, {3.8968849881445084`*^9, 
  3.8968849883737097`*^9}, {3.8968851179574537`*^9, 3.8968851181633096`*^9}, {
  3.8968898058586016`*^9, 3.89688980604618*^9}, {3.896889945031101*^9, 
  3.896889945235834*^9}},ExpressionUUID->"ea7c5508-ed79-43b1-a153-\
1c2fd0b76f5b"],

Cell["\<\
In this section, this script reads the file \[OpenCurlyDoubleQuote]Initial \
conditions for Turing bifurcation curves\[CloseCurlyDoubleQuote] and goes \
fixing one parameter leaving the other parameter and \[Mu] free to solve the \
two equations that determine a Turing bifurcation curve. Then, the script \
poses an ordinary differential equation to use the method of pseudo-arclength \
continuation to continue the bifurcation curves as the parameters change. \
NOTE: Here, the variable \[OpenCurlyDoubleQuote]time\[CloseCurlyDoubleQuote] \
is just an auxiliary variable that can be understood as the arclength of the \
bifurcation curve but it has nothing to do with the actual time in the \
reaction-diffusion equation\
\>", "Text",
 CellChangeTimes->{{3.8741448717259703`*^9, 3.874144884100844*^9}, {
  3.874145444691832*^9, 3.874145474313789*^9}, {3.874146549259242*^9, 
  3.8741465609609146`*^9}, {3.8741466954925833`*^9, 
  3.8741469368076143`*^9}},ExpressionUUID->"5fec1db2-68c6-4b57-89c4-\
f85a05da35a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"initialt", "=", 
   RowBox[{"-", "1000"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalt", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curvespeed", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "9"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Choptol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "9"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpleeq", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"smalldifferential", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"variabledependence", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"var", "[", 
       RowBox[{"[", "varnum", "]"}], "]"}], "->", 
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kineticsaux", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"kinetics", "/.", "fixedpar"}], "/.", 
       RowBox[{
        RowBox[{"par", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"par", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "->", 
       RowBox[{
        RowBox[{"par", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
     RowBox[{"muNF", "->", 
      RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", "variabledependence"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerodetaux", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"zerodet", "/.", "fixedpar"}], "/.", 
       RowBox[{
        RowBox[{"par", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"par", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "->", 
       RowBox[{
        RowBox[{"par", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
     RowBox[{"muNF", "->", 
      RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", "variabledependence"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeroderaux", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"zeroder", "/.", "fixedpar"}], "/.", 
       RowBox[{
        RowBox[{"par", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"par", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "->", 
       RowBox[{
        RowBox[{"par", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
     RowBox[{"muNF", "->", 
      RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", "variabledependence"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equations", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"equations", ",", "zeroderaux"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equations", "=", 
   RowBox[{"D", "[", 
    RowBox[{"equations", ",", "time"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"equations", ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{
       RowBox[{
        RowBox[{"par", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{
       RowBox[{
        RowBox[{"par", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{
       RowBox[{"muNF", "'"}], "[", "time", "]"}], "2"], "+", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"varnum", "=", "1"}], "nvar"], 
      SuperscriptBox[
       RowBox[{
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
       "2"]}], "-", 
     SuperscriptBox["curvespeed", "2"]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equations", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"equations", "[", 
       RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"equationnumber", ",", 
       RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equationsGlobalLP", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"kineticsaux", ",", 
     RowBox[{"zerodetaux", "/.", 
      RowBox[{
       RowBox[{"muNF", "[", "time", "]"}], "->", "0"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equationsGlobalLP", "=", 
   RowBox[{"D", "[", 
    RowBox[{"equationsGlobalLP", ",", "time"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"equationsGlobalLP", ",", 
    RowBox[{
     SuperscriptBox[
      RowBox[{
       RowBox[{
        RowBox[{"par", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{
       RowBox[{
        RowBox[{"par", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], "+", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"varnum", "=", "1"}], "nvar"], 
      SuperscriptBox[
       RowBox[{
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
       "2"]}], "-", 
     SuperscriptBox["curvespeed", "2"]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equationsGlobalLP", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"equationsGlobalLP", "[", 
       RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"equationnumber", ",", 
       RowBox[{"Length", "[", "equationsGlobalLP", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allvar", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"var", "[", 
      RowBox[{"[", "varnum", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"allvar", ",", 
    RowBox[{"par", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"allvar", ",", 
    RowBox[{"par", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"allvar", ",", "muNF"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allvartimedependent", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"allvar", "[", 
       RowBox[{"[", "nvar", "]"}], "]"}], "[", "time", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"nvar", ",", 
       RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allvarGlobalLP", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"var", "[", 
      RowBox[{"[", "varnum", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"allvarGlobalLP", ",", 
    RowBox[{"par", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"allvarGlobalLP", ",", 
    RowBox[{"par", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allvarGlobalLPtimedependent", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"allvarGlobalLP", "[", 
       RowBox[{"[", "nvar", "]"}], "]"}], "[", "time", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"nvar", ",", 
       RowBox[{"Length", "[", "allvarGlobalLP", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
   "FileExistsQ", "[", 
    "\"\<Initial conditions for Turing bifurcation curves.txt\>\"", "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numberofbifurcationcurves", "=", 
     RowBox[{"Length", "@", 
      RowBox[{"ReadList", "[", 
       RowBox[{
       "\"\<Initial conditions for Turing bifurcation curves.txt\>\"", ",", 
        RowBox[{"null", "@", "String"}], ",", 
        RowBox[{"NullRecords", "->", "True"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aux", "=", 
     RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"aux", ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<Initial conditions for Turing bifurcation curves.txt' was \
not found. Run the Python script first.\>\"", "}"}], "]"}], ",", 
        "\"\<Output\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Quit", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialvalueTuring", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"bifnum", "=", "1"}], ",", 
   RowBox[{"bifnum", "<=", "numberofbifurcationcurves"}], ",", 
   RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aux", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<Initial conditions for Turing bifurcation curves.txt\>\"", "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"aux", "=", 
     RowBox[{"FormattingStringsCommaSplit", "[", "aux", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"initialvalueTuring", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "TeXForm"}], "]"}], ",", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], "}"}]}],
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Close", "[", 
   "\"\<Initial conditions for Turing bifurcation curves.txt\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solutioncurves", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solutioncurvesGlobalLP", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"bifnum", "=", "1"}], ",", 
   RowBox[{"bifnum", "<=", "numberofbifurcationcurves"}], ",", 
   RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fixedparameter", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"par", ",", 
         RowBox[{
          RowBox[{"initialvalueTuring", "[", 
           RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"fixedparameter", "==", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"anotherparameter", "=", "2"}], ";"}], "\[IndentingNewLine]", 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"anotherparameter", "=", "1"}], ";"}]}], "\[IndentingNewLine]",
      "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "eq", "]"}], "==", "1"}], " ", "||", " ", 
       RowBox[{"simpleeq", "==", "0"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"initialvalues", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"zerodet", ",", "zeroder"}], "}"}], ",", 
                "kinetics"}], "]"}], "==", "0"}], "/.", "fixedpar"}], "/.", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"initialvalueTuring", "[", 
               RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "anotherparameter", "]"}], "]"}], ",", "muNF"}],
                "}"}], ",", "var"}], "]"}], "//", "Evaluate"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"initialvaluesGlobalLP", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", "zerodet", "}"}], ",", "kinetics"}], "]"}], "==",
                "0"}], "/.", "fixedpar"}], "/.", 
             RowBox[{"muNF", "->", "0"}]}], "/.", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"initialvalueTuring", "[", 
               RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"par", "[", 
                RowBox[{"[", "anotherparameter", "]"}], "]"}], "}"}], ",", 
              "var"}], "]"}], "//", "Evaluate"}]}], "]"}]}]}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"initialvalues", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"zerodet", ",", "zeroder"}], "}"}], "==", "0"}], "/.",
               "eq"}], "/.", "fixedpar"}], "/.", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"initialvalueTuring", "[", 
               RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "anotherparameter", "]"}], "]"}], ",", "muNF"}], 
             "}"}], "//", "Evaluate"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initialvaluesGlobalLP", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"zerodet", "==", "0"}], "/.", 
               RowBox[{"muNF", "->", "0"}]}], "/.", "eq"}], "/.", 
             "fixedpar"}], "/.", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"initialvalueTuring", "[", 
               RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"par", "[", 
             RowBox[{"[", "anotherparameter", "]"}], "]"}], "//", 
            "Evaluate"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"initialvalues", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"initialvalues", "[", 
              RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"varnum", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"initialsolnum", ",", 
         RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"initialvalues", "=", 
     RowBox[{"DeleteDuplicates", "[", "initialvalues", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"initialsolnum", "=", "1"}], ",", 
      RowBox[{"initialsolnum", "<=", 
       RowBox[{"Length", "[", "initialvalues", "]"}]}], ",", 
      RowBox[{"initialsolnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"initialvalues", "[", 
          RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"initialvalueTuring", "[", 
            RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"simpleeq", "==", "1"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Length", "[", "eq", "]"}], ">", "1"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Quiet", " ", "@", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[Not]", 
                 RowBox[{"(", 
                  RowBox[{"var", "\[Element]", "Reals"}], ")"}]}], "/.", 
                "eq"}], "/.", "fixedpar"}], "/.", 
              RowBox[{"initialvalues", "[", 
               RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"initialvalues", "[", 
            RowBox[{"[", "initialsolnum", "]"}], "]"}], "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"initialvalues", "[", 
              RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "/.", "eq"}], "/.", 
                   "fixedpar"}], "/.", 
                  RowBox[{"initialvalues", "[", 
                   RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ")"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
            "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Activate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Inactivate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Chop", "[", 
                RowBox[{"muNF", ",", "Choptol"}], "]"}], "!=", "0"}], " ", "&&",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"zerodet", ",", "zeroder"}], "}"}], "/.", 
                  "fixedpar"}], "]"}], "]"}], "<", "tol"}], " ", "&&", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "eq", "]"}], ">", "1"}], ",", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"var", "/.", "eq"}], "/.", "fixedpar"}], ")"}], 
                   "-", "var"}], "]"}], "<", "tol"}], ",", "True"}], "]"}], 
              " ", "&&", " ", 
              RowBox[{
               RowBox[{"lowerbound", "[", 
                RowBox[{"[", "anotherparameter", "]"}], "]"}], "<=", 
               RowBox[{"par", "[", 
                RowBox[{"[", "anotherparameter", "]"}], "]"}], "<=", 
               RowBox[{"upperbound", "[", 
                RowBox[{"[", "anotherparameter", "]"}], "]"}]}]}], "]"}], " ",
             "&&", " ", 
            RowBox[{
             RowBox[{"Chop", "[", 
              RowBox[{
               RowBox[{"nonzero", "/.", "fixedpar"}], ",", "Choptol"}], "]"}],
              "!=", "0"}]}], "/.", 
           RowBox[{"initialvalues", "[", 
            RowBox[{"[", "initialsolnum", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dereval", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
              RowBox[{
               RowBox[{
                RowBox[{"initialvalues", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "varnum", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"varnum", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"initialvalues", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], "}"}]}],
             "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"initialderivatives", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"equations", "/.", 
                RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
               RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"dernumber", "=", "1"}], ",", 
            RowBox[{"dernumber", "<=", 
             RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
            RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"equationsaux", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"equations", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                   "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"equationsaux", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"equationsaux", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"equationsaux", ",", 
               RowBox[{"WhenEvent", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                   RowBox[{
                    RowBox[{"lowerbound", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                 "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"equationsaux", ",", 
               RowBox[{"WhenEvent", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                   RowBox[{
                    RowBox[{"upperbound", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                 "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"equationsaux", ",", 
               RowBox[{"WhenEvent", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                   RowBox[{
                    RowBox[{"lowerbound", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                 "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"equationsaux", ",", 
               RowBox[{"WhenEvent", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                   RowBox[{
                    RowBox[{"upperbound", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                 "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"sol", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"NDSolve", "[", 
                RowBox[{"equationsaux", ",", "allvar", ",", 
                 RowBox[{"{", 
                  RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], 
                 ",", 
                 RowBox[{"Method", "->", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<EquationSimplification\>\"", "->", 
                    "\"\<Residual\>\""}], "}"}]}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "sol", "]"}], ">", "0"}], " ", "&&", 
                " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"solutioncurves", ",", "sol"}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"initialvaluesGlobalLP", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"initialvaluesGlobalLP", "[", 
             RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"initialvaluesGlobalLP", "[", 
              RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"varnum", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"initialvaluesGlobalLP", "[", 
             RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"initialsolnum", ",", 
         RowBox[{"Length", "[", "initialvaluesGlobalLP", "]"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"initialvaluesGlobalLP", "=", 
     RowBox[{"DeleteDuplicates", "[", "initialvaluesGlobalLP", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"initialsolnum", "=", "1"}], ",", 
      RowBox[{"initialsolnum", "<=", 
       RowBox[{"Length", "[", "initialvaluesGlobalLP", "]"}]}], ",", 
      RowBox[{"initialsolnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"initialvaluesGlobalLP", "[", 
          RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"initialvalueTuring", "[", 
            RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"simpleeq", "==", "1"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Length", "[", "eq", "]"}], ">", "1"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Quiet", "@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[Not]", 
                 RowBox[{"(", 
                  RowBox[{"var", "\[Element]", "Reals"}], ")"}]}], "/.", 
                "eq"}], "/.", "fixedpar"}], "/.", 
              RowBox[{"initialvaluesGlobalLP", "[", 
               RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"initialvaluesGlobalLP", "[", 
            RowBox[{"[", "initialsolnum", "]"}], "]"}], "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"initialvaluesGlobalLP", "[", 
              RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "/.", "eq"}], "/.", 
                   "fixedpar"}], "/.", 
                  RowBox[{"initialvaluesGlobalLP", "[", 
                   RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ")"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
            "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Activate", "[", 
          RowBox[{
           RowBox[{"Inactivate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"zerodet", "/.", "fixedpar"}], "/.", 
                RowBox[{"muNF", "->", "0"}]}], "]"}], "<", "tol"}], " ", "&&",
              " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "eq", "]"}], ">", "1"}], ",", 
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"var", "/.", "eq"}], "/.", "fixedpar"}], ")"}], 
                  "-", "var"}], "]"}], "<", "tol"}], ",", "True"}], "]"}], 
             " ", "&&", " ", 
             RowBox[{
              RowBox[{"lowerbound", "[", 
               RowBox[{"[", "anotherparameter", "]"}], "]"}], "<=", 
              RowBox[{"par", "[", 
               RowBox[{"[", "anotherparameter", "]"}], "]"}], "<=", 
              RowBox[{"upperbound", "[", 
               RowBox[{"[", "anotherparameter", "]"}], "]"}]}]}], "]"}], "/.", 
           RowBox[{"initialvaluesGlobalLP", "[", 
            RowBox[{"[", "initialsolnum", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dereval", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"initialvaluesGlobalLP", "[", 
                  RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
              RowBox[{
               RowBox[{
                RowBox[{"initialvaluesGlobalLP", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "varnum", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"varnum", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"initialvaluesGlobalLP", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], "}"}]}],
             "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"initialderivatives", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"equationsGlobalLP", "/.", 
                RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"allvarGlobalLPtimedependent", ",", "time"}], "]"}], "/.", 
               RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"dernumber", "=", "1"}], ",", 
            RowBox[{"dernumber", "<=", 
             RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
            RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"equationsaux", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"equationsGlobalLP", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                   "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"equationsaux", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"equationsaux", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"equationsaux", ",", 
               RowBox[{"WhenEvent", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                   RowBox[{
                    RowBox[{"lowerbound", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                 "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"equationsaux", ",", 
               RowBox[{"WhenEvent", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                   RowBox[{
                    RowBox[{"upperbound", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                 "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"equationsaux", ",", 
               RowBox[{"WhenEvent", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                   RowBox[{
                    RowBox[{"lowerbound", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                 "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"equationsaux", ",", 
               RowBox[{"WhenEvent", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                   RowBox[{
                    RowBox[{"upperbound", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                 "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"sol", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"NDSolve", "[", 
                RowBox[{"equationsaux", ",", "allvarGlobalLP", ",", 
                 RowBox[{"{", 
                  RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], 
                 ",", 
                 RowBox[{"Method", "->", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<EquationSimplification\>\"", "->", 
                    "\"\<Residual\>\""}], "}"}]}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "sol", "]"}], ">", "0"}], " ", "&&", 
                " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"solutioncurvesGlobalLP", ",", "sol"}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&", 
    " ", 
    RowBox[{
     RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aux", "=", 
     RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SelectionMove", "[", 
     RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"aux", ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<This script could not find a Turing bifurcation curve or a \
BD-line for your desired parameters. Try changing tolerances or lines to \
search.\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.835800383149931*^9, 3.8358003936255913`*^9}, {
   3.8358004689307795`*^9, 3.835800497959199*^9}, {3.8358005710557995`*^9, 
   3.835800574600037*^9}, {3.83584625338284*^9, 3.835846309888193*^9}, 
   3.835862616778392*^9, {3.8358670113511*^9, 3.8358670156196556`*^9}, {
   3.835897053872555*^9, 3.83589711543025*^9}, {3.8358978475887423`*^9, 
   3.835897899130804*^9}, {3.8358979371748686`*^9, 3.835897975068133*^9}, {
   3.835898460505728*^9, 3.8358985226680603`*^9}, {3.8358986304062147`*^9, 
   3.835898661077633*^9}, {3.8358991377606764`*^9, 3.8358991480262012`*^9}, {
   3.835954974810278*^9, 3.835954986266225*^9}, 3.835975065553357*^9, {
   3.835975096962427*^9, 3.835975098570182*^9}, 3.8359944368303776`*^9, {
   3.835994489439521*^9, 3.835994491881981*^9}, {3.8360385441166973`*^9, 
   3.836038704191036*^9}, {3.8360387418841333`*^9, 3.836038779680051*^9}, {
   3.8360388271956835`*^9, 3.8360389048792233`*^9}, {3.8360389850375376`*^9, 
   3.8360390849474554`*^9}, {3.8360392007749596`*^9, 3.836039217657132*^9}, {
   3.836039247925152*^9, 3.836039314006222*^9}, {3.836039471575602*^9, 
   3.8360395018953133`*^9}, 3.8360395451918135`*^9, {3.83604990890736*^9, 
   3.836049911875804*^9}, {3.836049990459853*^9, 3.836050074811844*^9}, {
   3.836050172836014*^9, 3.83605017328491*^9}, {3.836050316900804*^9, 
   3.8360503180032234`*^9}, {3.8364266535244455`*^9, 
   3.8364266536699295`*^9}, {3.8364658546253986`*^9, 
   3.8364658559199114`*^9}, {3.836477355418887*^9, 3.836477360974831*^9}, 
   3.836544420034695*^9, 3.8365453758179703`*^9, {3.837104927581094*^9, 
   3.8371049319102345`*^9}, {3.8371063831359262`*^9, 
   3.8371063867340083`*^9}, {3.8371069028055487`*^9, 3.837106904209049*^9}, {
   3.8371073291975665`*^9, 3.837107349195794*^9}, {3.8371073823551598`*^9, 
   3.837107396720112*^9}, {3.8371086273754234`*^9, 3.837108627515154*^9}, {
   3.8371091247270327`*^9, 3.8371091403763213`*^9}, {3.8371092863245564`*^9, 
   3.83710929143787*^9}, {3.8371101155803823`*^9, 3.837110125625069*^9}, {
   3.8371866608933134`*^9, 3.837186708437179*^9}, {3.8371871844820127`*^9, 
   3.837187201355115*^9}, {3.837187240203229*^9, 3.8371872503186197`*^9}, {
   3.8371889694130335`*^9, 3.8371889985982018`*^9}, {3.837189054913746*^9, 
   3.83718905523176*^9}, {3.837189738907127*^9, 3.837189743182128*^9}, {
   3.8371917458989763`*^9, 3.8371917543275223`*^9}, {3.837192367547785*^9, 
   3.8371923698031425`*^9}, {3.8373080847991204`*^9, 3.837308088228018*^9}, {
   3.837311087075122*^9, 3.837311111653232*^9}, {3.8373111569641223`*^9, 
   3.8373112075908422`*^9}, {3.8373116739633455`*^9, 3.83731174762152*^9}, {
   3.837357489715435*^9, 3.8373575327020006`*^9}, {3.8373576475126343`*^9, 
   3.8373577582898445`*^9}, {3.837358291304659*^9, 3.8373582918733325`*^9}, {
   3.837364864635292*^9, 3.8373648673549013`*^9}, {3.837365268277214*^9, 
   3.8373652685433674`*^9}, {3.8373698866014895`*^9, 3.837369889045862*^9}, {
   3.8373761417312284`*^9, 3.837376165113722*^9}, {3.8373761996968956`*^9, 
   3.8373762165797806`*^9}, {3.8373777539882364`*^9, 
   3.8373777711376157`*^9}, {3.8373778326002765`*^9, 3.83737788963726*^9}, {
   3.837378007335975*^9, 3.8373780264891644`*^9}, {3.8373791021337166`*^9, 
   3.8373791256607175`*^9}, {3.837379187290717*^9, 3.837379197188246*^9}, {
   3.837379465638403*^9, 3.837379469583686*^9}, {3.8373795354269776`*^9, 
   3.8373795503499327`*^9}, {3.837379681191613*^9, 3.837379689422118*^9}, {
   3.837381014485571*^9, 3.8373810564847803`*^9}, {3.837381126572015*^9, 
   3.837381154094487*^9}, {3.837384402872485*^9, 3.837384411551257*^9}, {
   3.837384672297243*^9, 3.837384706139934*^9}, {3.8373847376010847`*^9, 
   3.8373848109285717`*^9}, {3.8373848476847944`*^9, 3.837384856471878*^9}, {
   3.837384887250767*^9, 3.837384887488547*^9}, {3.837384917950872*^9, 
   3.8373849321075506`*^9}, {3.8373850078848677`*^9, 3.837385016319351*^9}, {
   3.837385093302801*^9, 3.8373851378394804`*^9}, {3.8373851855040636`*^9, 
   3.8373851896346564`*^9}, {3.837508676621073*^9, 3.837508771865509*^9}, {
   3.8375088163658676`*^9, 3.837508861995283*^9}, {3.8375089686277103`*^9, 
   3.8375089990993347`*^9}, {3.8375091369287276`*^9, 
   3.8375091390421934`*^9}, {3.837509181621002*^9, 3.8375091819583206`*^9}, {
   3.8375092424672623`*^9, 3.8375092929362135`*^9}, {3.837509426483735*^9, 
   3.837509428091234*^9}, {3.8375094618931217`*^9, 3.8375094817777967`*^9}, {
   3.8375096460183516`*^9, 3.837509714115513*^9}, {3.8375098195776715`*^9, 
   3.8375098919491367`*^9}, {3.837510055192695*^9, 3.837510055389578*^9}, {
   3.837534820853589*^9, 3.8375348296736784`*^9}, {3.837536429455612*^9, 
   3.837536436825438*^9}, {3.8375370888713064`*^9, 3.8375371859871244`*^9}, {
   3.8375374198695993`*^9, 3.8375374231140537`*^9}, {3.837538084110098*^9, 
   3.837538098373076*^9}, {3.8375388799176645`*^9, 3.8375389106224413`*^9}, {
   3.8375389991475983`*^9, 3.8375390015019436`*^9}, {3.8375390434336405`*^9, 
   3.8375390839668384`*^9}, {3.8375393165103707`*^9, 3.83753931901241*^9}, {
   3.837542642495079*^9, 3.8375426482296963`*^9}, {3.8375430944190254`*^9, 
   3.8375431214604945`*^9}, {3.837543170074698*^9, 3.8375431877960978`*^9}, {
   3.8375432915616837`*^9, 3.837543312946097*^9}, {3.8375494482043934`*^9, 
   3.8375495411948867`*^9}, {3.8375495820391207`*^9, 
   3.8375496863512526`*^9}, {3.8375497164443097`*^9, 3.837549716664372*^9}, {
   3.8375511741869726`*^9, 3.8375512146767406`*^9}, {3.837551718141234*^9, 
   3.8375517404912186`*^9}, {3.837551775329587*^9, 3.8375518218581543`*^9}, {
   3.837551912140464*^9, 3.8375519886676235`*^9}, {3.8375521236200137`*^9, 
   3.8375521290105524`*^9}, {3.837971345919276*^9, 3.8379716216389265`*^9}, {
   3.837971662603212*^9, 3.837971667081127*^9}, {3.8379717236121492`*^9, 
   3.8379717453663645`*^9}, {3.837971806378834*^9, 3.8379718398933945`*^9}, {
   3.837972013966257*^9, 3.8379720331836667`*^9}, {3.837973493992594*^9, 
   3.8379735004593782`*^9}, {3.837977096733562*^9, 3.8379771262888546`*^9}, {
   3.8379771722963243`*^9, 3.837977176000654*^9}, {3.837977216137413*^9, 
   3.837977309813052*^9}, {3.8379813577194147`*^9, 3.837981387029849*^9}, 
   3.83808387556483*^9, {3.838083911872466*^9, 3.8380839274266768`*^9}, {
   3.838084240201948*^9, 3.838084247067055*^9}, {3.838084294944995*^9, 
   3.8380843266355124`*^9}, {3.8380843972832155`*^9, 
   3.8380844814269834`*^9}, {3.8381311084468727`*^9, 3.838131318320835*^9}, {
   3.8381314945748434`*^9, 3.8381314949358444`*^9}, {3.83823108513987*^9, 
   3.8382311619117355`*^9}, {3.838231765014847*^9, 3.8382317833631616`*^9}, {
   3.8382318492956305`*^9, 3.838232031633013*^9}, {3.838232083913842*^9, 
   3.838232093514103*^9}, {3.838232166721301*^9, 3.8382321958461394`*^9}, {
   3.838301344487853*^9, 3.8383013605481253`*^9}, {3.8387414690469337`*^9, 
   3.8387414816889954`*^9}, {3.838747369445839*^9, 3.8387474688187246`*^9}, {
   3.838796483233977*^9, 3.8387965005388527`*^9}, {3.838810352388736*^9, 
   3.8388105004092073`*^9}, {3.838810547321121*^9, 3.8388106660571175`*^9}, {
   3.838811013832047*^9, 3.838811081701328*^9}, {3.838811116311629*^9, 
   3.8388112009983816`*^9}, {3.838811283516902*^9, 3.838811319073077*^9}, {
   3.8388113657638884`*^9, 3.838811405959751*^9}, {3.838811708667879*^9, 
   3.838812018860524*^9}, 3.8388122160796027`*^9, {3.8388123912585497`*^9, 
   3.8388123917816615`*^9}, {3.8388124893703165`*^9, 
   3.8388124899927206`*^9}, {3.838812549388631*^9, 3.838812578096362*^9}, 
   3.8388126773141336`*^9, {3.838812827549537*^9, 3.8388128733384047`*^9}, {
   3.83881290705975*^9, 3.8388129741602564`*^9}, {3.838813077742201*^9, 
   3.8388131706483035`*^9}, {3.8388132312233896`*^9, 3.838813231702568*^9}, {
   3.8388132633004036`*^9, 3.8388134682404003`*^9}, {3.838813512231194*^9, 
   3.838813515341589*^9}, {3.838813547296441*^9, 3.838813568039531*^9}, {
   3.838813611595213*^9, 3.838813624665961*^9}, {3.838813726860441*^9, 
   3.838813729149622*^9}, {3.838813799108779*^9, 3.8388141857797613`*^9}, {
   3.838814219236156*^9, 3.8388142493607173`*^9}, {3.838814322195019*^9, 
   3.8388144110854993`*^9}, {3.838814500626199*^9, 3.8388145009887667`*^9}, {
   3.838828000529066*^9, 3.838828015464631*^9}, {3.838828154776548*^9, 
   3.8388281618094487`*^9}, {3.838829351916663*^9, 3.8388294074712*^9}, 
   3.8388294432681427`*^9, {3.8388800659431324`*^9, 3.8388800743905125`*^9}, {
   3.8388801525503364`*^9, 3.838880233103219*^9}, {3.838880269942597*^9, 
   3.8388803959184656`*^9}, {3.8388804351026583`*^9, 3.838880463591443*^9}, {
   3.83888055714185*^9, 3.838880580997241*^9}, {3.838880616294364*^9, 
   3.838880746521001*^9}, {3.8388807925983763`*^9, 3.8388808444514694`*^9}, {
   3.8388808751838536`*^9, 3.838880934271415*^9}, {3.8388809693508654`*^9, 
   3.8388811773678684`*^9}, 3.8388812257608075`*^9, {3.838881277185156*^9, 
   3.838881278591305*^9}, {3.8388813455921183`*^9, 3.8388813460473366`*^9}, {
   3.8388814088238044`*^9, 3.8388814106706357`*^9}, {3.8388815171862245`*^9, 
   3.838881542286347*^9}, {3.8388906275324783`*^9, 3.83889065808566*^9}, {
   3.838890700574201*^9, 3.838890705869517*^9}, {3.838891743230632*^9, 
   3.8388917508540745`*^9}, {3.838891790717725*^9, 3.8388917945678697`*^9}, {
   3.838892980280107*^9, 3.8388929868871503`*^9}, {3.8388933033924465`*^9, 
   3.8388933188023915`*^9}, {3.8388936621194606`*^9, 
   3.8388937102798557`*^9}, {3.838893954632893*^9, 3.838893957423991*^9}, {
   3.838893990255821*^9, 3.838894016754078*^9}, {3.8388940775710516`*^9, 
   3.8388940830662193`*^9}, 3.838894295095812*^9, {3.8388946160324183`*^9, 
   3.8388946722244315`*^9}, {3.83889529515209*^9, 3.83889530262904*^9}, {
   3.838896723677289*^9, 3.838896748253347*^9}, {3.838896785547475*^9, 
   3.8388967906445503`*^9}, {3.838896929732786*^9, 3.8388969610740585`*^9}, {
   3.83890278289402*^9, 3.8389028202723017`*^9}, {3.8389043742166634`*^9, 
   3.8389043898962154`*^9}, {3.8389046077753487`*^9, 3.8389047007851*^9}, {
   3.838904747108817*^9, 3.8389047843951073`*^9}, {3.838904833272793*^9, 
   3.8389049419001455`*^9}, {3.838905169205252*^9, 3.838905171250698*^9}, {
   3.8389055817588825`*^9, 3.8389055821976604`*^9}, {3.8389057484567103`*^9, 
   3.8389057488208528`*^9}, {3.8389060566419945`*^9, 
   3.8389060703882904`*^9}, {3.8389061304908204`*^9, 3.838906144635081*^9}, {
   3.838906181610157*^9, 3.83890618236909*^9}, {3.8389063250283585`*^9, 
   3.8389063264049473`*^9}, {3.838979519909726*^9, 3.8389795206901894`*^9}, {
   3.838980284585846*^9, 3.8389802854895515`*^9}, {3.8389914109299264`*^9, 
   3.8389915009768376`*^9}, {3.838992095824698*^9, 3.8389920962202797`*^9}, {
   3.8389921762491035`*^9, 3.8389921779189377`*^9}, {3.8389922213922033`*^9, 
   3.8389922243179164`*^9}, {3.838992642393637*^9, 3.8389926440294385`*^9}, 
   3.839054913719394*^9, {3.83905534733001*^9, 3.8390553991471677`*^9}, 
   3.839055937975178*^9, {3.8390609628110323`*^9, 3.839060985894556*^9}, {
   3.8390610621644745`*^9, 3.8390611381695395`*^9}, {3.8390630361148586`*^9, 
   3.839063076876239*^9}, {3.8390634301478024`*^9, 3.8390634357761927`*^9}, {
   3.8390813838281565`*^9, 3.8390814007996902`*^9}, {3.839085493093603*^9, 
   3.8390854987263193`*^9}, 3.8390857095841494`*^9, {3.839216335649143*^9, 
   3.839216346410342*^9}, {3.8392167901828365`*^9, 3.83921679223428*^9}, {
   3.8392173710597396`*^9, 3.839217400289626*^9}, {3.8392174795405393`*^9, 
   3.83921751442457*^9}, {3.839761883548346*^9, 3.839761911062467*^9}, {
   3.8397643037335033`*^9, 3.8397643074780917`*^9}, 3.839790394187364*^9, {
   3.8397904367133923`*^9, 3.839790437189267*^9}, {3.8398050875321226`*^9, 
   3.839805201490574*^9}, {3.839963412835384*^9, 3.8399634199895706`*^9}, {
   3.8399635572701025`*^9, 3.839963614738102*^9}, 3.839963714405026*^9, {
   3.83996383421261*^9, 3.839963906982401*^9}, {3.8399639843539286`*^9, 
   3.839963988381708*^9}, {3.839964252540183*^9, 3.8399643152688046`*^9}, {
   3.839964383879295*^9, 3.8399643870146837`*^9}, {3.84013293458531*^9, 
   3.840132941045353*^9}, {3.8401340903246117`*^9, 3.840134418357593*^9}, {
   3.8401344572877936`*^9, 3.840134461961065*^9}, {3.8401345021658754`*^9, 
   3.840134653868057*^9}, {3.8401348473518224`*^9, 3.84013484949346*^9}, {
   3.8401349096505527`*^9, 3.8401349143856397`*^9}, {3.8401356166640177`*^9, 
   3.8401356555242558`*^9}, {3.840135754382082*^9, 3.840135800194893*^9}, 
   3.840137319135564*^9, {3.8401373492021217`*^9, 3.8401373681256895`*^9}, {
   3.8405397058881207`*^9, 3.840539956828848*^9}, {3.8405400177071075`*^9, 
   3.840540081981908*^9}, {3.8405402324813848`*^9, 3.840540256855384*^9}, {
   3.8405403074954767`*^9, 3.840540428043013*^9}, {3.8405405421546445`*^9, 
   3.840540562010919*^9}, {3.840540612036805*^9, 3.8405406179158225`*^9}, {
   3.8405406860874677`*^9, 3.840540825081979*^9}, {3.840540895016867*^9, 
   3.840540946203818*^9}, {3.8405410533963933`*^9, 3.8405411028730817`*^9}, {
   3.840541154239851*^9, 3.840541165032542*^9}, {3.840541209198126*^9, 
   3.8405412281272955`*^9}, {3.840541259337778*^9, 3.8405415319528875`*^9}, {
   3.8405415652931423`*^9, 3.8405416545714817`*^9}, {3.8405417161299353`*^9, 
   3.8405417916633635`*^9}, 3.8405418847215943`*^9, {3.8405419298603096`*^9, 
   3.8405421082634864`*^9}, {3.840542148597626*^9, 3.840542154410224*^9}, {
   3.8405422254522142`*^9, 3.8405422499952955`*^9}, {3.840542359360195*^9, 
   3.8405423670804405`*^9}, {3.840542405569627*^9, 3.840542416322298*^9}, {
   3.8405424620936193`*^9, 3.8405424994470434`*^9}, {3.8405437140568914`*^9, 
   3.840543785620564*^9}, {3.8405438425410366`*^9, 3.840543888857636*^9}, {
   3.8405439784766784`*^9, 3.8405440369868693`*^9}, {3.8405445874764085`*^9, 
   3.8405445890843983`*^9}, {3.8406314095850763`*^9, 
   3.8406315606470604`*^9}, {3.8406317305651464`*^9, 3.840631893174654*^9}, 
   3.8406319674641914`*^9, {3.840632069694498*^9, 3.84063207089443*^9}, {
   3.840632131735094*^9, 3.8406321523695717`*^9}, {3.8406322195623665`*^9, 
   3.8406323181593266`*^9}, {3.8406323612739267`*^9, 
   3.8406325222563066`*^9}, {3.840632607244535*^9, 3.84063262700891*^9}, {
   3.840632687284032*^9, 3.8406327382017856`*^9}, {3.8406327766709957`*^9, 
   3.8406327841215277`*^9}, {3.8406328231427283`*^9, 
   3.8406328543506145`*^9}, {3.8406329153528824`*^9, 3.840632916212194*^9}, {
   3.8406329661489787`*^9, 3.840633052371058*^9}, 3.8406330853039894`*^9, {
   3.8406337083427563`*^9, 3.8406337531474605`*^9}, {3.8406338211575623`*^9, 
   3.8406338248096733`*^9}, {3.84063388154035*^9, 3.8406339391444216`*^9}, {
   3.8406339697770095`*^9, 3.8406340405947676`*^9}, {3.840634372459752*^9, 
   3.840634386005232*^9}, {3.8406344298553057`*^9, 3.840634484376216*^9}, {
   3.840634515415203*^9, 3.840634535290094*^9}, {3.840634760665497*^9, 
   3.84063478559654*^9}, {3.840634845024702*^9, 3.8406348474543495`*^9}, {
   3.840634906313851*^9, 3.840634906413858*^9}, {3.8406489202208304`*^9, 
   3.8406489406373167`*^9}, {3.8406548313444767`*^9, 3.840654835542582*^9}, {
   3.8407384309221983`*^9, 3.840738433956179*^9}, {3.8408879137521877`*^9, 
   3.8408880349785805`*^9}, {3.8408880674699826`*^9, 
   3.8408880803684683`*^9}, {3.8408881523755074`*^9, 3.840888230838975*^9}, {
   3.840888646117558*^9, 3.840888652769765*^9}, {3.840888689146883*^9, 
   3.840888703730502*^9}, {3.841076766428794*^9, 3.8410768178245697`*^9}, {
   3.8410768644846134`*^9, 3.841076890270355*^9}, {3.841086282627287*^9, 
   3.8410863065771327`*^9}, 3.8411464824464025`*^9, {3.8411466093562994`*^9, 
   3.8411466167401667`*^9}, {3.84118523857973*^9, 3.8411852390035563`*^9}, {
   3.841246945250167*^9, 3.8412469604443855`*^9}, {3.8413414755253496`*^9, 
   3.8413416008041463`*^9}, {3.8414354263220835`*^9, 3.841435427595044*^9}, 
   3.841436070375393*^9, {3.8459386087274075`*^9, 3.845938625362542*^9}, {
   3.8462928179245167`*^9, 3.8462928343661346`*^9}, {3.84629589606824*^9, 
   3.8462959024719677`*^9}, {3.847990441141614*^9, 3.8479904453507648`*^9}, {
   3.8479904853026457`*^9, 3.847990491433774*^9}, {3.8479906288978834`*^9, 
   3.847990638094104*^9}, {3.847990850687535*^9, 3.847990851835201*^9}, {
   3.847991097289144*^9, 3.847991097379142*^9}, {3.8600128623028154`*^9, 
   3.8600128666793847`*^9}, {3.860181885273491*^9, 3.8601819447919135`*^9}, {
   3.860181978880512*^9, 3.8601819933859024`*^9}, {3.8601820254968557`*^9, 
   3.8601820263070855`*^9}, {3.8601820947375097`*^9, 
   3.8601820962636747`*^9}, {3.8601821550385637`*^9, 3.860182177384737*^9}, {
   3.860186447240735*^9, 3.8601865149851346`*^9}, {3.8601865813050175`*^9, 
   3.8601866439149275`*^9}, {3.8601866809318075`*^9, 3.860186683633257*^9}, {
   3.860186725865335*^9, 3.860186796140732*^9}, {3.860187632854713*^9, 
   3.860187636822962*^9}, {3.86018768162639*^9, 3.860187682079415*^9}, {
   3.8602637683147907`*^9, 3.860264046181512*^9}, {3.8602641119247704`*^9, 
   3.8602641485139103`*^9}, 3.8602642049450784`*^9, {3.8602642549987583`*^9, 
   3.8602642656425905`*^9}, {3.8602643718830895`*^9, 
   3.8602643767761106`*^9}, {3.860264420881585*^9, 3.8602644211412945`*^9}, {
   3.8602644575202117`*^9, 3.8602644596547995`*^9}, {3.8604399247225966`*^9, 
   3.8604399260841265`*^9}, {3.861031562680611*^9, 3.8610316076573353`*^9}, {
   3.8610316423232527`*^9, 3.8610316431480007`*^9}, {3.8610325023377132`*^9, 
   3.861032602609974*^9}, {3.86103266624883*^9, 3.861032672806709*^9}, {
   3.8610423942405367`*^9, 3.86104239479082*^9}, {3.8612154011129465`*^9, 
   3.8612155588033094`*^9}, {3.861215622743631*^9, 3.8612156231746764`*^9}, {
   3.8612156548239384`*^9, 3.861215657412531*^9}, {3.861215708211717*^9, 
   3.861215717671447*^9}, {3.8612158765719004`*^9, 3.8612159004678793`*^9}, {
   3.8612230197187424`*^9, 3.8612230444754767`*^9}, {3.861378450456607*^9, 
   3.861378502944149*^9}, {3.8614361180782795`*^9, 3.861436166079014*^9}, {
   3.861713004573823*^9, 3.861713013534011*^9}, {3.861713045460729*^9, 
   3.8617132511122665`*^9}, {3.861713315702606*^9, 3.861713597373539*^9}, {
   3.861713630192927*^9, 3.861713697200325*^9}, {3.861713734254774*^9, 
   3.8617137499225464`*^9}, {3.861714078265586*^9, 3.861714079259121*^9}, {
   3.8617145227011876`*^9, 3.8617145888922834`*^9}, {3.8617151779406953`*^9, 
   3.861715183425907*^9}, {3.8617152667243195`*^9, 3.8617153437826777`*^9}, {
   3.8617153742773323`*^9, 3.8617154398358793`*^9}, {3.861715480090219*^9, 
   3.8617154807265663`*^9}, {3.861715714364832*^9, 3.8617157488504286`*^9}, {
   3.8617157806095066`*^9, 3.8617158161138864`*^9}, {3.8617158668386164`*^9, 
   3.861715902094202*^9}, {3.8617159563353834`*^9, 3.861716044106382*^9}, {
   3.8617160837585196`*^9, 3.861716234322649*^9}, {3.861716318707727*^9, 
   3.8617163625998216`*^9}, {3.8617164292977896`*^9, 3.86171650142026*^9}, {
   3.861716540363999*^9, 3.861716572147723*^9}, {3.862928486221151*^9, 
   3.8629284863511724`*^9}, {3.8629285681283593`*^9, 3.862928568376583*^9}, {
   3.863105498005196*^9, 3.863105498099107*^9}, {3.8631055818764515`*^9, 
   3.863105663291836*^9}, {3.8631061475764*^9, 3.863106153292693*^9}, {
   3.863106205172043*^9, 3.8631062556108665`*^9}, {3.8631063773669252`*^9, 
   3.8631063862499857`*^9}, {3.863106419499442*^9, 3.863106434969813*^9}, {
   3.8631064972013283`*^9, 3.863106540888563*^9}, {3.8631065801935153`*^9, 
   3.8631065889855256`*^9}, {3.863106628422604*^9, 3.86310668384881*^9}, {
   3.8631067141831255`*^9, 3.8631067294643526`*^9}, 3.8631068612105055`*^9, {
   3.863106979155182*^9, 3.86310699863488*^9}, {3.863107175678976*^9, 
   3.8631071772296495`*^9}, {3.863107239941474*^9, 3.8631072816409793`*^9}, {
   3.863107337768202*^9, 3.86310735092317*^9}, {3.8631074309701824`*^9, 
   3.8631074463350973`*^9}, {3.863107517906161*^9, 3.8631075195153437`*^9}, {
   3.8631075543316107`*^9, 3.8631076486373053`*^9}, {3.8631079988407717`*^9, 
   3.8631079996517363`*^9}, {3.8631082048349113`*^9, 3.863108205466988*^9}, {
   3.8632082726138153`*^9, 3.863208327156189*^9}, {3.8632697351397643`*^9, 
   3.863269770864497*^9}, {3.8683665104250727`*^9, 3.868366510853592*^9}, {
   3.868366546031404*^9, 3.8683665702503076`*^9}, {3.8683666327642956`*^9, 
   3.8683667450117235`*^9}, {3.8683668049593477`*^9, 3.868366852243841*^9}, {
   3.86959527016084*^9, 3.8695953047577195`*^9}, {3.8696672519323406`*^9, 
   3.869667302256092*^9}, {3.8696677477852015`*^9, 3.8696677768044214`*^9}, {
   3.8696679359775686`*^9, 3.8696680873027506`*^9}, {3.8696682546954513`*^9, 
   3.8696682871166315`*^9}, {3.869668388540259*^9, 3.8696684022763586`*^9}, {
   3.8696684739714603`*^9, 3.869668487713237*^9}, {3.8696686975852675`*^9, 
   3.86966873613135*^9}, {3.8696688194732685`*^9, 3.8696688234093857`*^9}, {
   3.8696689329508142`*^9, 3.8696689770562563`*^9}, {3.8696691474349885`*^9, 
   3.869669157633773*^9}, {3.8696692071744757`*^9, 3.869669228218024*^9}, {
   3.8696692655411096`*^9, 3.869669281400027*^9}, {3.8696693292870164`*^9, 
   3.869669330089698*^9}, {3.8696694817486773`*^9, 3.8696694869718776`*^9}, {
   3.869669548824684*^9, 3.8696695492271156`*^9}, {3.869669960473612*^9, 
   3.8696700413837214`*^9}, {3.869670257003083*^9, 3.8696702646153817`*^9}, {
   3.869677189056265*^9, 3.869677189405475*^9}, 3.871411499972601*^9, {
   3.883058164000578*^9, 3.883058176103432*^9}, {3.883058220270136*^9, 
   3.883058260132867*^9}, {3.8830584068753357`*^9, 3.8830584977141085`*^9}, {
   3.883063136317121*^9, 3.8830631515431805`*^9}, {3.8963670680828977`*^9, 
   3.8963671297583704`*^9}, {3.896367203443728*^9, 3.896367247231536*^9}, {
   3.896880631560849*^9, 3.8968806683326645`*^9}, {3.896883275703681*^9, 
   3.896883317673907*^9}, {3.8968833985892134`*^9, 3.8968834252950125`*^9}, {
   3.8968849622645617`*^9, 3.896884965003276*^9}, {3.8968851041538734`*^9, 
   3.896885109861706*^9}, {3.896885243988021*^9, 3.8968852496980934`*^9}, {
   3.896889607565486*^9, 3.8968896217932863`*^9}, {3.8968897879922733`*^9, 
   3.8968897988290396`*^9}, {3.8968899291864944`*^9, 
   3.896889937334505*^9}},ExpressionUUID->"9919ef6e-2978-4802-bd05-\
8061f7920bda"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross-order coefficient", "Title",
 CellChangeTimes->{{3.907871314955657*^9, 3.90787132004045*^9}, {
  3.908054977681008*^9, 
  3.9080549785390234`*^9}},ExpressionUUID->"4684d111-706c-433d-8a4b-\
d34dca57b6d5"],

Cell["\<\
This cell computes the cross-order coefficient, provided that all the \
parameters were appropriately given in Python.\
\>", "Text",
 CellChangeTimes->{{3.9078715444534855`*^9, 3.9078715788140516`*^9}, {
  3.907871613616828*^9, 
  3.9078716459262676`*^9}},ExpressionUUID->"c28fe9c7-075c-4be0-a77a-\
35b2a8d3cfa8"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Not]", 
     RowBox[{
     "FileExistsQ", "[", "\"\<To get cross-order coefficient.txt\>\"", 
      "]"}]}], " ", "||", " ", 
    RowBox[{"\[Not]", 
     RowBox[{"FileExistsQ", "[", "\"\<Kernels.txt\>\"", "]"}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Throw", "[", "\"\<The cross-order coefficient will not be computed\>\"", 
     "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"counter", "=", "1"}], ",", 
      RowBox[{"counter", "<=", "2"}], ",", 
      RowBox[{"counter", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{
        "ReadLine", "[", "\"\<To get cross-order coefficient.txt\>\"", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"aux2", "=", 
        RowBox[{"ReadLine", "[", "\"\<Kernels.txt\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"counter", "==", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"crosspar", "=", 
           RowBox[{"FormattingStrings", "[", "aux", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"phiNF", "=", 
           RowBox[{"FormattingStringsCommaSplit", "[", "aux2", "]"}]}], ";"}],
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"C11", "=", 
           RowBox[{"FormattingStrings", "[", "aux", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psiNF", "=", 
           RowBox[{"FormattingStringsCommaSplit", "[", "aux2", "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Close", "[", "\"\<To get cross-order coefficient.txt\>\"", "]"}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Close", "[", "\"\<Kernels.txt\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"phiNF", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"phiNF", ",", "TeXForm"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"psiNF", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"psiNF", ",", "TeXForm"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"C11", "=", 
     RowBox[{"C11", "/.", "eq"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"C11", "=", 
     RowBox[{"D", "[", 
      RowBox[{"C11", ",", "crosspar"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"varnum", "=", "0"}], ",", 
      RowBox[{"varnum", "<=", 
       RowBox[{"nvar", "-", "1"}]}], ",", 
      RowBox[{"varnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"C11", "=", 
        RowBox[{"C11", "/.", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Phi]", "varnum"], "NF"], "->", 
          RowBox[{"phiNF", "[", 
           RowBox[{"[", 
            RowBox[{"varnum", "+", "1"}], "]"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"C11", "=", 
        RowBox[{"C11", "/.", 
         RowBox[{
          SuperscriptBox[
           SubscriptBox["\[Psi]", "varnum"], "NF"], "->", 
          RowBox[{"psiNF", "[", 
           RowBox[{"[", 
            RowBox[{"varnum", "+", "1"}], "]"}], "]"}]}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9078713969204855`*^9, 3.9078714990486465`*^9}, 
   3.907871583271462*^9, {3.9080549625061445`*^9, 
   3.9080549697286825`*^9}},ExpressionUUID->"e502312f-1ef8-470b-9311-\
ad61bfb6028a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Changes of criticality and fifth-order coefficient", "Title",
 CellChangeTimes->{{3.8383017929569187`*^9, 3.838301808356631*^9}, 
   3.8390811661706953`*^9, {3.8854778414675913`*^9, 3.8854778518920474`*^9}, {
   3.8968881729063807`*^9, 3.8968881732941933`*^9}, {3.8968884726043835`*^9, 
   3.8968884728415995`*^9}},ExpressionUUID->"741eb1d1-ecb6-4601-bec9-\
e01c0e2cd7d8"],

Cell[TextData[{
 "In this section, the script finds zeroes of the third-order coefficient \
along Turing bifurcation curves. To do that, it firsts evaluates the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "3"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "91b02f05-363f-45ac-ae5a-2a2ea4e29f8f"],
 " at different points of the bifurcation curves looking for changes of sign. \
In particular, if the product of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "3"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dd13faa7-a0cd-460a-8cb8-024e0a31ae97"],
 " at two different consecutive points is negative, then one of those points \
si saved to be used as an initial condition to find the actual root of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "3"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c136df33-b3b8-4e4a-960e-aaef70098e70"],
 "."
}], "Text",
 CellChangeTimes->{{3.874146959158119*^9, 
  3.874147179530388*^9}},ExpressionUUID->"4471743e-7c28-41e1-9073-\
41bf3f51418a"],

Cell[BoxData[
 RowBox[{"Catch", "[", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&", 
     " ", 
     RowBox[{
      RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Throw", "[", 
      "\"\<This script could not find a bifurcation curve for this \
system\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timedifference", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"disttol", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tol", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"criticalitybool", "=", 
      RowBox[{
      "Import", "[", "\"\<Find codimension-two bifurcation points.txt\>\"", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "criticalitybool", "]"}], "==", 
        "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "FileExistsQ", "[", "\"\<Fifth-order coefficient.txt\>\"", "]"}], 
           " ", "||", " ", 
           RowBox[{
           "FileExistsQ", "[", "\"\<Fifth-order coefficient.mx\>\"", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
             "FileExistsQ", "[", "\"\<Fifth-order coefficient.mx\>\"", "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"C5", "=", 
              RowBox[{
              "Import", "[", "\"\<Fifth-order coefficient.mx\>\"", "]"}]}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nC5Bool", "=", 
               RowBox[{"Length", "@", 
                RowBox[{"ReadList", "[", 
                 RowBox[{"\"\<Fifth-order coefficient.txt\>\"", ",", 
                  RowBox[{"null", "@", "String"}], ",", 
                  RowBox[{"NullRecords", "->", "True"}]}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"nC5Bool", ">", "0"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"C5", "=", 
                  RowBox[{
                  "Import", "[", "\"\<Fifth-order coefficient.txt\>\"", 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"C5", "=", 
                  RowBox[{"FormattingStrings", "[", "C5", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                  "\"\<Fifth-order coefficient.mx\>\"", ",", " ", "C5"}], 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"fifthcoeff", "=", 
            RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"codimensiontwopoints", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"outersolnum", "=", "1"}], ",", 
          RowBox[{"outersolnum", "<=", 
           RowBox[{"Length", "[", "solutioncurves", "]"}]}], ",", 
          RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"innersolnum", "=", "1"}], ",", 
            RowBox[{"innersolnum", "<=", 
             RowBox[{"Length", "[", 
              RowBox[{"solutioncurves", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"auxC3", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Compile", "[", 
                 RowBox[{
                  RowBox[{"{", "time", "}"}], ",", "#", ",", 
                  RowBox[{"RuntimeOptions", "->", 
                   RowBox[{
                   "\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], "]"}],
                 "&"}], "@", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"C3", "/.", "fixedpar"}], "/.", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                   RowBox[{"muNF", "->", 
                    RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
                  "variabledependence"}], "/.", 
                 RowBox[{
                  RowBox[{"solutioncurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"allvals", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"time", ",", 
                  RowBox[{"auxC3", "[", "time", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"time", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "timedifference"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"vals", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"valnum", "=", "1"}], ",", 
               RowBox[{"valnum", "<=", 
                RowBox[{
                 RowBox[{"Length", "[", "allvals", "]"}], "-", "1"}]}], ",", 
               RowBox[{"valnum", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"allvals", "[", 
                    RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"allvals", "[", 
                    RowBox[{"[", 
                    RowBox[{"valnum", "+", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "<", "0"}], " ", "&&", 
                  " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"allvals", "[", 
                    RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"muNF", "[", 
                    RowBox[{
                    RowBox[{"allvals", "[", 
                    RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"vals", ",", 
                   RowBox[{
                    RowBox[{"allvals", "[", 
                    RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"tnum", "=", "1"}], ",", 
               RowBox[{"tnum", "<=", 
                RowBox[{"Length", "[", "vals", "]"}]}], ",", 
               RowBox[{"tnum", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"initialvalueoft", "=", 
                 RowBox[{"vals", "[", 
                  RowBox[{"[", "tnum", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"critchangetemp", "=", 
                 RowBox[{"time", "/.", 
                  RowBox[{"Quiet", "@", 
                   RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"time", ",", "initialvalueoft"}], "}"}]}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<=", "critchangetemp", "<=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], " ", "&&", " ", 
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], "/.", 
                    RowBox[{"time", "->", "critchangetemp"}]}], "]"}], "<", 
                    "tol"}], " ", "&&", " ", 
                   RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"muNF", "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
                    RowBox[{"time", "->", "critchangetemp"}]}], ",", 
                    "Choptol"}], "]"}], ">", "0"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"auxiliaryarray", "=", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"muNF", "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"muNF", "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}], 
                    "/.", 
                    RowBox[{"time", "->", "critchangetemp"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"codimensiontwopoints", ",", "auxiliaryarray"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "[", "C5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"fifthcoeff", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
                    RowBox[{"time", "->", "critchangetemp"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"C5", "/.", "fixedpar"}], "/.", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                    RowBox[{"muNF", "->", 
                    RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
                    "variabledependence"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
                    RowBox[{"time", "->", "critchangetemp"}]}], "}"}]}], 
                    "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "codimensiontwopoints", "]"}], ">", "0"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"codimensiontwopoints", "=", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"par", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "muNF"}], "}"}], ",", 
               "var"}], "]"}], "/.", "codimensiontwopoints"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"codimensiontwopoints", "=", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"codimensiontwopoints", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"EuclideanDistance", "[", "##", "]"}], "<", 
                "disttol"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"critchange", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"codimensiontwopoints", "[", 
                   RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"codimensiontwopoints", "[", 
                   RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"critnum", ",", 
                RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"codimensiontwopoints", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"codimensiontwopoints", "[", 
                    RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"codimensiontwopoints", "[", 
                    RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{"muNF", "->", 
                   RowBox[{
                    RowBox[{"codimensiontwopoints", "[", 
                    RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"codimensiontwopoints", "[", 
                    RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"3", "+", "varnum"}], "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"critnum", ",", 
                RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ValueQ", "[", "fifthcoeff", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"auxarr", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"critnum", "=", "1"}], ",", 
                RowBox[{"critnum", "<=", 
                 RowBox[{"Length", "[", "critchange", "]"}]}], ",", 
                RowBox[{"critnum", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"getout", "=", "0"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"fifthnum", "=", "1"}], ",", 
                   RowBox[{"fifthnum", "<=", 
                    RowBox[{"Length", "[", "fifthcoeff", "]"}]}], ",", 
                   RowBox[{"fifthnum", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"getout", "==", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"fifthcoeff", "[", 
                    RowBox[{"[", "fifthnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "/.", 
                    RowBox[{"critchange", "[", 
                    RowBox[{"[", "critnum", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"auxarr", ",", 
                    RowBox[{"fifthcoeff", "[", 
                    RowBox[{"[", "fifthnum", "]"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"getout", "=", "1"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                  "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fifthcoeff", "=", "auxarr"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ValueQ", "[", "fifthcoeff", "]"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Length", "[", "fifthcoeff", "]"}], ">", "0"}]}], ",", 
             RowBox[{
              RowBox[{"Export", "[", 
               RowBox[{
               "\"\<Fifth-order coefficient at codimension-two bifurcation \
points.txt\>\"", ",", "fifthcoeff"}], "]"}], ";"}], "\[IndentingNewLine]", 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ValueQ", "[", "critchange", "]"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"Length", "[", "critchange", "]"}], ">", "0"}]}], 
                ",", 
                RowBox[{"Export", "[", 
                 RowBox[{
                 "\"\<Codimension-two bifurcation points.txt\>\"", ",", 
                  "critchange"}], "]"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8358176580453634`*^9, 3.8358176609874134`*^9}, {
   3.835817700848744*^9, 3.83581770286805*^9}, 3.8358472895036387`*^9, {
   3.8358473271444035`*^9, 3.8358476513237867`*^9}, {3.8358476909839907`*^9, 
   3.8358476973336706`*^9}, {3.835861873930725*^9, 3.835861907523102*^9}, {
   3.835862044712819*^9, 3.835862054737645*^9}, {3.835862085676695*^9, 
   3.835862094490827*^9}, 3.8358621257787466`*^9, {3.835862164309356*^9, 
   3.8358622786592617`*^9}, {3.8358623286341286`*^9, 
   3.8358623716908474`*^9}, {3.8358625159961596`*^9, 3.835862572621502*^9}, {
   3.8358992166566772`*^9, 3.8358992649643345`*^9}, {3.835899305539336*^9, 
   3.835899310210873*^9}, {3.835899345951815*^9, 3.8358994317728558`*^9}, {
   3.835899547734671*^9, 3.8358995526800275`*^9}, 3.8359000195640306`*^9, {
   3.8359009777759914`*^9, 3.835901069287366*^9}, {3.8359520777420416`*^9, 
   3.8359521203425694`*^9}, {3.8359522500473423`*^9, 
   3.8359523951807756`*^9}, {3.8359524432539086`*^9, 
   3.8359525368955927`*^9}, {3.835952573238288*^9, 3.8359526686633606`*^9}, {
   3.8359527376954174`*^9, 3.835952757574113*^9}, {3.835952849807453*^9, 
   3.8359528824561105`*^9}, {3.8359530983379354`*^9, 3.835953137935157*^9}, {
   3.8359531760070086`*^9, 3.835953176095206*^9}, {3.8359532148714457`*^9, 
   3.835953218112492*^9}, {3.8359532725102324`*^9, 3.835953321064498*^9}, {
   3.835953355370459*^9, 3.8359533916865473`*^9}, {3.835953442326184*^9, 
   3.8359534766462865`*^9}, {3.835953565303767*^9, 3.835953588936907*^9}, {
   3.8359610517286196`*^9, 3.835961064494547*^9}, {3.835961405808676*^9, 
   3.8359615923619547`*^9}, {3.8359617003707705`*^9, 
   3.8359619771206665`*^9}, {3.8359620487698727`*^9, 
   3.8359621058028135`*^9}, {3.835962423868933*^9, 3.8359624292998724`*^9}, {
   3.8359624950158296`*^9, 3.835962528171492*^9}, {3.8359627156817093`*^9, 
   3.8359627235632586`*^9}, {3.835962926354054*^9, 3.8359629306502705`*^9}, {
   3.835963022456034*^9, 3.83596303443404*^9}, {3.835963181795141*^9, 
   3.8359631848510413`*^9}, {3.8359633270691404`*^9, 
   3.8359633490521126`*^9}, {3.8359634295661907`*^9, 3.83596343367756*^9}, {
   3.8359635047632275`*^9, 3.835963594235185*^9}, {3.8360511304600687`*^9, 
   3.8360511384230175`*^9}, 3.836544453858473*^9, {3.8367225278707104`*^9, 
   3.8367225381322517`*^9}, {3.8367288585853715`*^9, 3.836728860607075*^9}, {
   3.8375520372477736`*^9, 3.83755204536111*^9}, 3.8379719373159637`*^9, {
   3.8382311955551634`*^9, 3.8382312315042324`*^9}, 3.8383013846225915`*^9, {
   3.838301496487171*^9, 3.8383015105971775`*^9}, {3.83830159310761*^9, 
   3.8383016133861246`*^9}, {3.8387080402107477`*^9, 3.838708042780555*^9}, {
   3.838710057460165*^9, 3.8387100762974367`*^9}, {3.838741534663869*^9, 
   3.838741547781953*^9}, {3.8387965156216583`*^9, 3.838796532473645*^9}, {
   3.838889812125836*^9, 3.8388899628615074`*^9}, {3.838890053095225*^9, 
   3.8388900565592566`*^9}, {3.8388901186489205`*^9, 
   3.8388901524227076`*^9}, {3.8388902375962944`*^9, 3.838890417038416*^9}, {
   3.838890478719706*^9, 3.838890572926078*^9}, {3.8388907575654125`*^9, 
   3.8388908214172783`*^9}, {3.838890857742445*^9, 3.838890930610362*^9}, {
   3.8388909985755215`*^9, 3.838891015671769*^9}, {3.838891052396581*^9, 
   3.838891138094528*^9}, {3.838891172399213*^9, 3.8388912345982985`*^9}, {
   3.8388913055754623`*^9, 3.838891306358051*^9}, {3.8388914239831038`*^9, 
   3.838891437325471*^9}, {3.8388915296290894`*^9, 3.8388915346491337`*^9}, {
   3.838891579648512*^9, 3.838891581174282*^9}, {3.8388919061744947`*^9, 
   3.8388919551628866`*^9}, {3.83889201678225*^9, 3.838892026566554*^9}, {
   3.8388921413996105`*^9, 3.838892277311399*^9}, {3.8388923134307027`*^9, 
   3.8388923691308975`*^9}, {3.8388924621587753`*^9, 
   3.8388925691767907`*^9}, {3.838892633929101*^9, 3.838892635472485*^9}, {
   3.8388926909521*^9, 3.838892702310959*^9}, {3.838892761487085*^9, 
   3.8388927847613225`*^9}, {3.838892817441066*^9, 3.8388928799446363`*^9}, {
   3.8388930136394367`*^9, 3.838893016951042*^9}, {3.83889313809437*^9, 
   3.8388931526882377`*^9}, {3.838893387375102*^9, 3.8388933947693396`*^9}, {
   3.8388941676329317`*^9, 3.838894196002098*^9}, {3.838894418432832*^9, 
   3.8388944201849155`*^9}, {3.838894450648204*^9, 3.8388944677201304`*^9}, {
   3.8388947094865365`*^9, 3.8388947163283997`*^9}, {3.8388948357063923`*^9, 
   3.838894836832409*^9}, 3.8388949308488455`*^9, {3.838895359019549*^9, 
   3.8388954184194927`*^9}, {3.8388954768948565`*^9, 
   3.8388954813833714`*^9}, {3.8388955148126545`*^9, 3.838895544276351*^9}, {
   3.8388956175345373`*^9, 3.8388956936066275`*^9}, {3.83889572923372*^9, 
   3.8388957415180316`*^9}, {3.8388959619028273`*^9, 
   3.8388960377578344`*^9}, {3.838898333899905*^9, 3.8388983343034625`*^9}, {
   3.838898441097701*^9, 3.8388984543525453`*^9}, {3.8388986796085663`*^9, 
   3.8388986981509037`*^9}, {3.838902837091834*^9, 3.838902843933877*^9}, {
   3.83890291467496*^9, 3.83890297362682*^9}, {3.8389076527914*^9, 
   3.8389076675385857`*^9}, {3.8389169668206296`*^9, 3.838916967266859*^9}, {
   3.8389171112823772`*^9, 3.838917142236562*^9}, {3.838917214741177*^9, 
   3.8389172769414287`*^9}, {3.8389173469182396`*^9, 
   3.8389173494959407`*^9}, {3.838979610108582*^9, 3.838979826665964*^9}, {
   3.8389806490662766`*^9, 3.8389806539334974`*^9}, {3.8389823527133274`*^9, 
   3.8389823537809267`*^9}, {3.838983162315789*^9, 3.838983428190143*^9}, {
   3.838983465902862*^9, 3.8389835246393514`*^9}, {3.83898355727625*^9, 
   3.8389836127223105`*^9}, {3.8389836737051115`*^9, 
   3.8389837534885044`*^9}, {3.838983816544614*^9, 3.8389838169681*^9}, {
   3.8389839346031237`*^9, 3.8389839575929646`*^9}, {3.83898406143824*^9, 
   3.8389840887321067`*^9}, {3.8389841700374546`*^9, 3.838984170381954*^9}, {
   3.8389900143799877`*^9, 3.8389900566263657`*^9}, {3.8389903549945173`*^9, 
   3.8389904362041464`*^9}, {3.8389904716614046`*^9, 3.838990502054242*^9}, 
   3.8389915284600687`*^9, {3.8390563391736593`*^9, 3.839056414443556*^9}, {
   3.839056455005014*^9, 3.8390564755551186`*^9}, {3.8390571086926985`*^9, 
   3.8390571271922283`*^9}, {3.839057382733118*^9, 3.839057422290203*^9}, {
   3.839057467972953*^9, 3.8390575107392936`*^9}, {3.8390606442598567`*^9, 
   3.8390606649982777`*^9}, {3.8390631482041283`*^9, 
   3.8390631788834906`*^9}, {3.839077154331633*^9, 3.8390771548716073`*^9}, {
   3.8390783513893647`*^9, 3.8390783660723696`*^9}, {3.839081429889949*^9, 
   3.839081438150999*^9}, {3.839085718246745*^9, 3.8390857306860228`*^9}, {
   3.8392183391699405`*^9, 3.8392183463954887`*^9}, {3.840023434032231*^9, 
   3.8400235113528104`*^9}, {3.840023549946597*^9, 3.840023550833576*^9}, {
   3.8400236051264887`*^9, 3.840023654247006*^9}, {3.8400237713008785`*^9, 
   3.8400237998424406`*^9}, {3.8401346823264637`*^9, 3.84013480412119*^9}, {
   3.8401388171137505`*^9, 3.840138894948578*^9}, {3.840138952757769*^9, 
   3.8401389887527*^9}, {3.8401390911494713`*^9, 3.840139106246976*^9}, {
   3.8401393026298018`*^9, 3.840139371877578*^9}, {3.8401398519736724`*^9, 
   3.8401398522495613`*^9}, {3.840213338983342*^9, 3.84021345460369*^9}, {
   3.8402204592261515`*^9, 3.8402205349526243`*^9}, {3.8402205686366673`*^9, 
   3.8402206351483974`*^9}, {3.8404902318972216`*^9, 
   3.8404902589247913`*^9}, {3.84049031011017*^9, 3.8404903108476796`*^9}, {
   3.840490433714881*^9, 3.8404904618253527`*^9}, {3.8404905154459667`*^9, 
   3.8404905311159816`*^9}, {3.8404924445102825`*^9, 
   3.8404924713851557`*^9}, {3.840638150604563*^9, 3.840638210742326*^9}, {
   3.840638871655634*^9, 3.8406389141875806`*^9}, {3.840639233957506*^9, 
   3.840639240671155*^9}, 3.8406520958031178`*^9, 3.8407059602466316`*^9, {
   3.8407384921026187`*^9, 3.8407385483875055`*^9}, 3.8407389935300355`*^9, {
   3.840903922370655*^9, 3.8409039313857813`*^9}, {3.8410768324242535`*^9, 
   3.8410768556840715`*^9}, {3.841076887927569*^9, 3.841076902623412*^9}, {
   3.8410769629882965`*^9, 3.84107699124023*^9}, {3.841146502254611*^9, 
   3.8411465460371294`*^9}, {3.841146623437829*^9, 3.8411466526737823`*^9}, {
   3.8411476728808804`*^9, 3.8411476826137652`*^9}, {3.841185254809842*^9, 
   3.8411852902735786`*^9}, {3.841185324936002*^9, 3.841185344836151*^9}, {
   3.841246968995834*^9, 3.8412469808767138`*^9}, {3.841435432953311*^9, 
   3.841435449372101*^9}, 3.8414360704111366`*^9, {3.8459382930794125`*^9, 
   3.8459383036825976`*^9}, {3.845938675611824*^9, 3.8459386939037313`*^9}, {
   3.8462928448929977`*^9, 3.8462928829849887`*^9}, {3.8462956620287533`*^9, 
   3.8462956699009953`*^9}, {3.84629591725121*^9, 3.8462959228276167`*^9}, {
   3.8479904412796206`*^9, 3.8479904413796206`*^9}, {3.8479909019619284`*^9, 
   3.847990937786975*^9}, {3.847990967856501*^9, 3.8479909893173103`*^9}, {
   3.8479910974201393`*^9, 3.8479910974531393`*^9}, {3.847991173527854*^9, 
   3.847991173891291*^9}, {3.8479929886934557`*^9, 3.8479930442089763`*^9}, {
   3.861031614094322*^9, 3.8610316257308598`*^9}, {3.861032726587596*^9, 
   3.86103274064736*^9}, {3.861033216157567*^9, 3.8610332311750994`*^9}, {
   3.863087040428357*^9, 3.8630871771605415`*^9}, {3.8630872096438384`*^9, 
   3.863087224548785*^9}, {3.863087316340645*^9, 3.8630875136977963`*^9}, {
   3.863087592069928*^9, 3.863087594801123*^9}, {3.863087694291294*^9, 
   3.8630876966215744`*^9}, {3.863087766010917*^9, 3.8630877986176744`*^9}, {
   3.86308785542852*^9, 3.8630879170253725`*^9}, {3.8630879817907763`*^9, 
   3.863088017789445*^9}, 3.8630880627479706`*^9, {3.863088105831793*^9, 
   3.8630881835461016`*^9}, {3.863088283799271*^9, 3.8630883481078167`*^9}, {
   3.8630883949818754`*^9, 3.8630884606996155`*^9}, {3.8630885110424495`*^9, 
   3.8630885422634597`*^9}, {3.8630886007561564`*^9, 
   3.8630886169540205`*^9}, {3.863088671282034*^9, 3.86308870132719*^9}, {
   3.8630887776696978`*^9, 3.8630888243089285`*^9}, {3.8630888633833885`*^9, 
   3.863088865088606*^9}, {3.8630889135646524`*^9, 3.8630889461984277`*^9}, {
   3.8630908725356617`*^9, 3.8630908727256594`*^9}, {3.863090990784317*^9, 
   3.863091001441702*^9}, 3.863091038258648*^9, {3.863091110556364*^9, 
   3.8630911212429676`*^9}, {3.8630912162211046`*^9, 3.863091232277753*^9}, {
   3.863091264131504*^9, 3.863091359573165*^9}, {3.8630914013280916`*^9, 
   3.8630916387861524`*^9}, {3.8630917019629073`*^9, 3.863091745515465*^9}, {
   3.8630917873268166`*^9, 3.8630917996910515`*^9}, 3.863093264891555*^9, {
   3.8630933842826157`*^9, 3.8630933952211113`*^9}, {3.863093436707405*^9, 
   3.8630934750531635`*^9}, {3.863093513314895*^9, 3.8630935146831074`*^9}, {
   3.86309559717185*^9, 3.863095623844427*^9}, {3.863178979132382*^9, 
   3.863179009037285*^9}, 3.8631790715177555`*^9, {3.8631791593522577`*^9, 
   3.8631791739370503`*^9}, {3.863179526811865*^9, 3.8631795305072217`*^9}, {
   3.863179570720178*^9, 3.8631795709911146`*^9}, {3.8632723783991156`*^9, 
   3.8632723787281446`*^9}, {3.8678428476720514`*^9, 
   3.8678430437847805`*^9}, {3.8683577110941286`*^9, 3.8683577585428057`*^9}, 
   3.8683577975329084`*^9, {3.868453298809174*^9, 3.868453301424528*^9}, 
   3.868453363801334*^9, {3.8684534857114325`*^9, 3.8684536225982494`*^9}, {
   3.8684538255241623`*^9, 3.868453847142359*^9}, {3.868454495530142*^9, 
   3.8684545448446474`*^9}, {3.8684545758768325`*^9, 3.868454632108178*^9}, {
   3.868454673542986*^9, 3.868454825338028*^9}, {3.8684548697340984`*^9, 
   3.86845493553333*^9}, {3.8684551210557623`*^9, 3.8684551293063045`*^9}, {
   3.8684551939113827`*^9, 3.8684551940083833`*^9}, {3.8684554151920137`*^9, 
   3.868455422015976*^9}, {3.8684558400609694`*^9, 3.8684558413404613`*^9}, {
   3.8684559209425573`*^9, 3.8684559217959976`*^9}, {3.868455964565977*^9, 
   3.8684559688969307`*^9}, {3.868632798650941*^9, 3.868632835032716*^9}, {
   3.868707443959603*^9, 3.868707446487818*^9}, {3.8687078451134315`*^9, 
   3.8687078567947683`*^9}, 3.8687083036822033`*^9, {3.8687095425010586`*^9, 
   3.868709565408679*^9}, {3.8687121654153724`*^9, 3.868712210381412*^9}, {
   3.868712243614208*^9, 3.8687123540203433`*^9}, {3.868712384757185*^9, 
   3.868712423922245*^9}, {3.8687125005758295`*^9, 3.8687125453896103`*^9}, 
   3.8687125874010115`*^9, {3.868712650897421*^9, 3.8687126557710857`*^9}, {
   3.868712723216051*^9, 3.8687127279843864`*^9}, {3.8687128146460805`*^9, 
   3.8687128536973495`*^9}, {3.868712922165224*^9, 3.8687129267473097`*^9}, {
   3.868712973908067*^9, 3.8687129887645955`*^9}, {3.868713040228586*^9, 
   3.8687130519301825`*^9}, {3.869676931667527*^9, 3.8696770433158236`*^9}, {
   3.883058906947466*^9, 3.883058914366321*^9}, {3.8968814142502112`*^9, 
   3.8968815103442163`*^9}, {3.8968829107918463`*^9, 3.896882947922763*^9}, {
   3.8968881201480937`*^9, 3.8968881217665014`*^9}, 3.896888161321929*^9, {
   3.896888363527421*^9, 3.8968884198097205`*^9}, {3.896888566619338*^9, 
   3.8968885712635736`*^9}, {3.896891779656255*^9, 
   3.8968918229996247`*^9}},ExpressionUUID->"fb8b154a-015f-45ba-964e-\
1aa654390a6e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bifurcation diagram plotting", "Title",
 CellChangeTimes->{{3.838301821263669*^9, 3.8383018262863755`*^9}, {
  3.868630474197912*^9, 3.868630479143034*^9}, {3.869595327413012*^9, 
  3.8695953305267463`*^9}},ExpressionUUID->"335983e1-ddfc-4628-a13f-\
400ae567ecbb"],

Cell[TextData[{
 "This section plots each of the parametric bifurcation curves found colored \
according to the sign of ",
 Cell[BoxData[
  FormBox["\[Mu]", TraditionalForm]],ExpressionUUID->
  "f40b8e65-5434-4a62-bd3e-ac81b8ba2e9a"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "3"], TraditionalForm]],ExpressionUUID->
  "039df2dc-14ca-4308-ba7b-f1c03dc267cf"],
 ". In particular, if \[Mu]>0 and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "3"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "af6e4c96-9a7e-40c1-9ea6-b969dee603e5"],
 ">0 (respectively, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "3"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "125bc5f6-55b7-4363-a0cb-df7b09893292"],
 "<0), then the curve will be coloured Blue (respectively, red). On the othe \
hand, if \[Mu]<0, then the curve will be green dotted. Besides, if \[Mu]=0, \
then the curve will be plotted Gray. Also, if the codimension-two bifurcation \
points were found in the previous step, they will be plotted in the graph"
}], "Text",
 CellChangeTimes->{
  3.874147195917084*^9, {3.87414725182213*^9, 
   3.874147410104519*^9}},ExpressionUUID->"c3a28e72-11cc-4488-b25f-\
12fc8d97dce5"],

Cell[BoxData[
 RowBox[{"Catch", "[", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&", 
     " ", 
     RowBox[{
      RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Throw", "[", 
      "\"\<This script could not find a bifurcation curve for this \
system\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ValueQ", "[", "critchange", "]"}], " ", "&&", " ", 
        RowBox[{
         RowBox[{"Length", "[", "critchange", "]"}], ">=", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"critpoints", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/.", 
                RowBox[{"critchange", "[", 
                 RowBox[{"[", "critnum", "]"}], "]"}]}], "]"}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"critnum", ",", 
             RowBox[{"Length", "[", "critchange", "]"}]}], "}"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"bifcurveplot", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GlobalLPplot", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"outersolnum", "=", "1"}], ",", 
       RowBox[{"outersolnum", "<=", 
        RowBox[{"Length", "[", "solutioncurves", "]"}]}], ",", 
       RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"innersolnum", "=", "1"}], ",", 
         RowBox[{"innersolnum", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"solutioncurves", "[", 
            RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"auxnonzero", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", "time", "}"}], ",", "#", ",", 
               RowBox[{"RuntimeOptions", "->", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
              "]"}], "&"}], "@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar"}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{"muNF", "->", 
                 RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
               "variabledependence"}], "/.", 
              RowBox[{
               RowBox[{"solutioncurves", "[", 
                RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"auxC3", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", "time", "}"}], ",", "#", ",", 
               RowBox[{"RuntimeOptions", "->", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
              "]"}], "&"}], "@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"C3", "/.", "fixedpar"}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{"muNF", "->", 
                 RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
               "variabledependence"}], "/.", 
              RowBox[{
               RowBox[{"solutioncurves", "[", 
                RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempplot", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"ParametricPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"muNF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                     " ", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], "\[Element]", 
                    "Reals"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], "<", "0"}]}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"muNF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                     " ", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], "\[Element]", 
                    "Reals"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ">", "0"}]}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"muNF", "[", "time", "]"}], "<", "0"}]}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"muNF", "[", "time", "]"}], "==", "0"}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], " ", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"time", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Red", ",", "Blue", ",", 
                 RowBox[{"{", 
                  RowBox[{"Green", ",", "Dotted"}], "}"}], ",", "Gray"}], 
                "}"}]}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"lowerbound", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"upperbound", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"lowerbound", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"upperbound", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"bifcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"outersolnum", "=", "1"}], ",", 
       RowBox[{"outersolnum", "<=", 
        RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}]}], ",", 
       RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"innersolnum", "=", "1"}], ",", 
         RowBox[{"innersolnum", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"solutioncurvesGlobalLP", "[", 
            RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tempplot", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"ParametricPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                "}"}], "/.", " ", 
               RowBox[{
                RowBox[{"solutioncurvesGlobalLP", "[", 
                 RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"time", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurvesGlobalLP", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurvesGlobalLP", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", "Gray", "}"}]}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"lowerbound", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"upperbound", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"lowerbound", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"upperbound", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"GlobalLPplot", ",", "tempplot"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bifcurveplot", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"bifcurveplot", ",", "GlobalLPplot"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CreateDocument", "[", 
      RowBox[{
       RowBox[{"Dynamic", "[", "plot2", "]"}], ",", 
       RowBox[{"WindowSize", "->", 
        RowBox[{"{", 
         RowBox[{"500", ",", "500"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", "critpoints", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plot2", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"bifcurveplot", ",", "critpoints", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"newparam1", ",", "StandardForm"}], "]"}], ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"newparam2", ",", "StandardForm"}], "]"}]}], "}"}]}], 
          ",", 
          RowBox[{"RotateLabel", "->", "False"}], ",", 
          RowBox[{"FrameStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
          RowBox[{"AspectRatio", "->", "1"}]}], "]"}]}], " ", 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"plot2", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"bifcurveplot", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"newparam1", ",", "StandardForm"}], "]"}], ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"newparam2", ",", "StandardForm"}], "]"}]}], "}"}]}], 
          ",", 
          RowBox[{"RotateLabel", "->", "False"}], ",", 
          RowBox[{"FrameStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
          RowBox[{"AspectRatio", "->", "1"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.835796213342993*^9, 3.8357962623494596`*^9, {3.8357972447530913`*^9, 
   3.8357973048194036`*^9}, {3.8357973403357835`*^9, 
   3.8357973534231377`*^9}, {3.8357974221922007`*^9, 
   3.8357974353404045`*^9}, {3.835797503898506*^9, 3.835797526184392*^9}, {
   3.8358169924294963`*^9, 3.8358170122542334`*^9}, {3.8358177116224785`*^9, 
   3.8358177544643917`*^9}, {3.8358464088433633`*^9, 3.8358464789960413`*^9}, 
   3.8358467474503284`*^9, {3.8358626334749985`*^9, 3.8358626620204787`*^9}, {
   3.835863135539633*^9, 3.835863135698433*^9}, {3.8358642992637844`*^9, 
   3.83586430047645*^9}, {3.8358661188369904`*^9, 3.8358661193248854`*^9}, {
   3.835874504046071*^9, 3.835874504869238*^9}, {3.835874546308709*^9, 
   3.8358745608207617`*^9}, {3.8358746616955795`*^9, 
   3.8358746621738605`*^9}, {3.8358985627831*^9, 3.8358985906445293`*^9}, {
   3.835898653048764*^9, 3.8358987255257683`*^9}, 3.8358988553109627`*^9, {
   3.835899035731711*^9, 3.835899056227641*^9}, {3.835953789910282*^9, 
   3.8359540801765337`*^9}, 3.8359541298877554`*^9, {3.835960993496622*^9, 
   3.8359610051295824`*^9}, {3.8359615037615576`*^9, 
   3.8359615135627356`*^9}, {3.8360536079162297`*^9, 3.836053618115733*^9}, {
   3.8360537137828207`*^9, 3.8360538188691463`*^9}, {3.8360813382993593`*^9, 
   3.8360813385313215`*^9}, {3.836119018673108*^9, 3.8361190197412186`*^9}, {
   3.836126553918936*^9, 3.836126588066052*^9}, {3.8361266476422663`*^9, 
   3.8361266511978025`*^9}, {3.8364620909364176`*^9, 3.836462112650015*^9}, 
   3.836462150380229*^9, {3.8364622936831303`*^9, 3.836462302936552*^9}, {
   3.83646251830147*^9, 3.83646252065205*^9}, 3.836477336382619*^9, {
   3.8364774337859163`*^9, 3.83647758230012*^9}, {3.836477621077223*^9, 
   3.8364776248528166`*^9}, {3.8364776637922606`*^9, 
   3.8364776781295547`*^9}, {3.836477821918666*^9, 3.836478078517007*^9}, {
   3.8364782014360447`*^9, 3.836478224111833*^9}, {3.8364782843675814`*^9, 
   3.8364783065331907`*^9}, {3.836478376526963*^9, 3.836478462261367*^9}, {
   3.836478506476094*^9, 3.8364786341847334`*^9}, {3.836478762581764*^9, 
   3.8364787764754343`*^9}, {3.8364788185381813`*^9, 
   3.8364788757300076`*^9}, {3.836478908194691*^9, 3.8364790989077377`*^9}, {
   3.8364800258601465`*^9, 3.8364800306672378`*^9}, {3.8365444720554276`*^9, 
   3.836544495242521*^9}, {3.836722795808168*^9, 3.836722807821574*^9}, {
   3.8375497574595437`*^9, 3.837550071458211*^9}, {3.837550111953613*^9, 
   3.837550134339423*^9}, {3.837550174215392*^9, 3.837550196262848*^9}, {
   3.8375502475867157`*^9, 3.8375502908414717`*^9}, {3.8375503242850857`*^9, 
   3.8375503775629272`*^9}, {3.8375504215035086`*^9, 3.837550522131129*^9}, {
   3.8375505790429277`*^9, 3.837550818688393*^9}, {3.8375508578314476`*^9, 
   3.8375508635777254`*^9}, {3.8375509399818068`*^9, 
   3.8375509659377437`*^9}, {3.837551241351018*^9, 3.837551286130142*^9}, {
   3.837551326931965*^9, 3.8375513315866184`*^9}, {3.8375513618297033`*^9, 
   3.837551447928874*^9}, {3.8375514980434704`*^9, 3.8375514985201273`*^9}, {
   3.8375515330404744`*^9, 3.8375515332406826`*^9}, {3.837551588625061*^9, 
   3.837551608594487*^9}, {3.837552076420869*^9, 3.837552084095451*^9}, {
   3.83797235038163*^9, 3.8379723516262426`*^9}, {3.8379724337065763`*^9, 
   3.8379725684649305`*^9}, {3.83797270520432*^9, 3.8379727057917757`*^9}, {
   3.8379727470118823`*^9, 3.837972808301222*^9}, {3.83797291681316*^9, 
   3.8379730859074078`*^9}, {3.8379731383333025`*^9, 3.837973165306095*^9}, {
   3.8379732119476323`*^9, 3.8379732223934035`*^9}, {3.8379732571672626`*^9, 
   3.8379733241827564`*^9}, {3.8379735360468884`*^9, 
   3.8379739041987896`*^9}, {3.83797395968092*^9, 3.8379740409390745`*^9}, {
   3.837974087502879*^9, 3.8379740876028194`*^9}, {3.837974129049155*^9, 
   3.8379742383465*^9}, {3.837974333230545*^9, 3.8379743632193995`*^9}, {
   3.837974462505777*^9, 3.8379744629794335`*^9}, {3.837974697934939*^9, 
   3.837974703498412*^9}, {3.8379747587306824`*^9, 3.8379747772484436`*^9}, {
   3.8379751776325006`*^9, 3.8379751850004563`*^9}, {3.8379753849914856`*^9, 
   3.837975441160324*^9}, {3.8379755253271437`*^9, 3.837975553202236*^9}, {
   3.8379756187606707`*^9, 3.837975623235577*^9}, {3.8379756562765603`*^9, 
   3.837975683656191*^9}, {3.8379757137345247`*^9, 3.8379757154635897`*^9}, {
   3.8379758319434004`*^9, 3.8379758846436462`*^9}, {3.8379759151159315`*^9, 
   3.8379760711249375`*^9}, {3.8379762860645533`*^9, 
   3.8379763562171707`*^9}, {3.837976393834804*^9, 3.837976450997903*^9}, {
   3.8379764895837183`*^9, 3.8379764912685986`*^9}, {3.8379765654620094`*^9, 
   3.8379765964762487`*^9}, {3.837976885082964*^9, 3.8379769037444115`*^9}, {
   3.8379769369803715`*^9, 3.8379770395306144`*^9}, {3.837977374067445*^9, 
   3.8379774329705276`*^9}, {3.8379774899713087`*^9, 3.83797756623205*^9}, {
   3.837977605826434*^9, 3.8379776192425137`*^9}, {3.8379814538190646`*^9, 
   3.837981474526546*^9}, {3.837982932309546*^9, 3.837982934804923*^9}, {
   3.83808402938957*^9, 3.8380840303947535`*^9}, {3.8380841670193295`*^9, 
   3.838084197382947*^9}, {3.838084525844055*^9, 3.8380845261296015`*^9}, {
   3.838084740810538*^9, 3.838084743778062*^9}, {3.8380849292383738`*^9, 
   3.838084964496997*^9}, {3.838131345931035*^9, 3.8381313564665966`*^9}, {
   3.8381314406768293`*^9, 3.8381314446188917`*^9}, {3.838131479798818*^9, 
   3.838131480392623*^9}, {3.8382312515042496`*^9, 3.8382312604791226`*^9}, {
   3.8382320503126144`*^9, 3.8382320558962584`*^9}, {3.83823210751184*^9, 
   3.8382321188840704`*^9}, {3.838232224155901*^9, 3.8382322534722548`*^9}, {
   3.838232334951073*^9, 3.8382323366694155`*^9}, {3.8382365335465536`*^9, 
   3.838236535179391*^9}, {3.8387415657705965`*^9, 3.838741702076095*^9}, {
   3.8387417423405914`*^9, 3.838741761473418*^9}, {3.8387474967779994`*^9, 
   3.8387475461273184`*^9}, 3.8388145378246884`*^9, {3.838814578066798*^9, 
   3.8388145802656164`*^9}, {3.8388294663021994`*^9, 3.838829525446354*^9}, {
   3.8388327372596083`*^9, 3.838832848276805*^9}, {3.8388339305882163`*^9, 
   3.838833939526228*^9}, {3.8388960750918736`*^9, 3.838896117886017*^9}, {
   3.8388961524065723`*^9, 3.838896216622188*^9}, {3.83889625427909*^9, 
   3.8388962652540054`*^9}, {3.8388962978310566`*^9, 3.8388963384002*^9}, {
   3.838896810548645*^9, 3.838896810973827*^9}, {3.8388968426944475`*^9, 
   3.838896843228986*^9}, {3.838897082486844*^9, 3.8388972613419704`*^9}, {
   3.838897291974121*^9, 3.838897371806575*^9}, {3.838897409539964*^9, 
   3.838897485048192*^9}, {3.8388975193659678`*^9, 3.8388975813775597`*^9}, {
   3.8388977417001*^9, 3.838897767585107*^9}, {3.8388979234648104`*^9, 
   3.8388979655959053`*^9}, {3.8388979998524466`*^9, 
   3.8388980144122696`*^9}, {3.8388982043634324`*^9, 
   3.8388982248726845`*^9}, {3.8388982885374184`*^9, 3.83889829419646*^9}, {
   3.838898493355857*^9, 3.8388985053646393`*^9}, {3.8388985410056095`*^9, 
   3.8388985419570913`*^9}, 3.838898609723894*^9, {3.8389028557132845`*^9, 
   3.838902887166459*^9}, {3.8389073483529224`*^9, 3.838907350295617*^9}, {
   3.8389075167472425`*^9, 3.838907579897197*^9}, {3.8389076293524804`*^9, 
   3.8389076402493787`*^9}, 3.838907822410889*^9, {3.8389167482962933`*^9, 
   3.83891675098886*^9}, {3.8389798551895914`*^9, 3.8389802319354305`*^9}, {
   3.8389841359639587`*^9, 3.838984142894208*^9}, {3.838989944124899*^9, 
   3.838990001080721*^9}, {3.8389900684353714`*^9, 3.8389900726391354`*^9}, {
   3.838990194146763*^9, 3.838990208278329*^9}, {3.8389902992246804`*^9, 
   3.838990333179845*^9}, 3.8389909622066393`*^9, 3.8389915372774887`*^9, {
   3.8390611530399437`*^9, 3.839061183946931*^9}, {3.839063129867611*^9, 
   3.8390631398964214`*^9}, {3.8390640709434443`*^9, 
   3.8390640828864965`*^9}, {3.8390783557748137`*^9, 3.839078355827815*^9}, {
   3.8392164918522663`*^9, 3.8392165047696447`*^9}, {3.83921663350692*^9, 
   3.8392166397166386`*^9}, {3.8399641162537937`*^9, 
   3.8399641388634305`*^9}, {3.840652103364238*^9, 3.840652108671632*^9}, {
   3.8406985159212017`*^9, 3.8406985367138853`*^9}, {3.840904676992308*^9, 
   3.8409046877885895`*^9}, {3.841155621879593*^9, 3.841155645162751*^9}, {
   3.8413350039959793`*^9, 3.8413354817108*^9}, {3.84133558189361*^9, 
   3.8413355841028643`*^9}, {3.8413356497822704`*^9, 3.841335650732249*^9}, {
   3.841335693464593*^9, 3.8413357110947657`*^9}, {3.841335745264724*^9, 
   3.8413357519930706`*^9}, {3.841335785873283*^9, 3.841335797304764*^9}, {
   3.841335828834642*^9, 3.841335949272729*^9}, {3.8413360475829744`*^9, 
   3.8413360845218573`*^9}, {3.8413361445031605`*^9, 
   3.8413361930725036`*^9}, {3.8413364986209774`*^9, 3.841336634505803*^9}, {
   3.841336721291553*^9, 3.841336721770151*^9}, {3.841337391859993*^9, 
   3.841337393587206*^9}, {3.841439917787873*^9, 3.8414399236905355`*^9}, {
   3.847990441385621*^9, 3.8479904414326277`*^9}, {3.8479910426762114`*^9, 
   3.8479910430409756`*^9}, {3.847991097469144*^9, 3.847991097494142*^9}, {
   3.8601826645529747`*^9, 3.8601826726039143`*^9}, {3.8610328299937706`*^9, 
   3.861032834634549*^9}, {3.8617137966466274`*^9, 3.861713938936759*^9}, {
   3.862301017952145*^9, 3.8623010670515404`*^9}, {3.862928608181116*^9, 
   3.8629287458110485`*^9}, {3.8686304861145687`*^9, 3.868630486766383*^9}, {
   3.868632865564847*^9, 3.8686328958354836`*^9}, {3.8687074577906923`*^9, 
   3.868707460622797*^9}, {3.869594757779509*^9, 3.86959483485527*^9}, {
   3.8695954796694784`*^9, 3.8695954843400555`*^9}, {3.869677051569944*^9, 
   3.8696770692911296`*^9}, {3.8726947393671465`*^9, 
   3.8726947430962095`*^9}, {3.8738951894327345`*^9, 
   3.8738951903791804`*^9}, {3.883058603729489*^9, 3.8830586116116323`*^9}, {
   3.8830586436769094`*^9, 3.8830586947199016`*^9}, {3.8830593046244254`*^9, 
   3.883059304941242*^9}, {3.896883522019199*^9, 
   3.8968835284450283`*^9}},ExpressionUUID->"7f0bdfc8-c8b7-4f06-9635-\
3f6fa686187c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameters on the axes of the 3D bifurcation diagram", "Title",
 CellChangeTimes->{
  3.867988969995775*^9, {3.868531574897338*^9, 3.868531576657237*^9}, {
   3.896891551487225*^9, 3.896891551850604*^9}, {3.8968926022724257`*^9, 
   3.8968926025314527`*^9}, {3.8968960492987804`*^9, 
   3.8968960495353885`*^9}, {3.89690562499691*^9, 
   3.8969056253140893`*^9}},ExpressionUUID->"22396d79-1554-4bd1-b57b-\
3637995f26e1"],

Cell["\<\
This section loads the extra parameter that will be on the codimension-two \
plotter\
\>", "Text",
 CellChangeTimes->{
  3.874147434693591*^9},ExpressionUUID->"1d798801-9506-4883-bd0a-\
503a8c94ea1e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"checker", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"!", 
     RowBox[{
     "FileExistsQ", "[", "\"\<Codimension-two parameters on axes.txt\>\"", 
      "]"}]}], " ", "||", " ", 
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "critchange", "]"}]}], " ", "||", " ", 
    RowBox[{
     RowBox[{"Length", "[", "critchange", "]"}], "==", "0"}], " ", "||", 
    RowBox[{"!", 
     RowBox[{"ValueQ", "[", "codimensiontwopoints", "]"}]}], " ", "||", " ", 
    RowBox[{
     RowBox[{"Length", "[", "codimensiontwopoints", "]"}], "==", "0"}]}], ",",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"checker", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"npar", "=", "3"}], ";", "\[IndentingNewLine]", 
    RowBox[{"auxpar", "=", "par"}], ";", "\[IndentingNewLine]", 
    RowBox[{"par", "=", 
     RowBox[{"Range", "[", "npar", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"lowerbound", "=", 
     RowBox[{"Range", "[", "npar", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"upperbound", "=", 
     RowBox[{"Range", "[", "npar", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", "npar"}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{
        "ReadLine", "[", "\"\<Codimension-two parameters on axes.txt\>\"", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"aux", "=", 
        RowBox[{"FormattingStringsCommaSplit", "[", "aux", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"auxval", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"par", "[", 
         RowBox[{"[", "parnum", "]"}], "]"}], "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"auxpar", ",", 
            RowBox[{"par", "[", 
             RowBox[{"[", "parnum", "]"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fixedparameternumber", "=", "parnum"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lowerbound", "[", 
         RowBox[{"[", "parnum", "]"}], "]"}], "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"upperbound", "[", 
         RowBox[{"[", "parnum", "]"}], "]"}], "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";"}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "Close", "[", "\"\<Codimension-two parameters on axes.txt\>\"", "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", 
       RowBox[{"Length", "[", "fixedpar", "]"}]}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"fixedpar", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "==", 
         RowBox[{"par", "[", 
          RowBox[{"[", "fixedparameternumber", "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"fixedpar3", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"fixedpar", ",", 
           RowBox[{"{", 
            RowBox[{"fixedpar", "[", 
             RowBox[{"[", "parnum", "]"}], "]"}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"fixedparameternumber", "==", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"anotherparameter1", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"anotherparameter2", "=", "3"}], ";"}], "\[IndentingNewLine]", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fixedparameternumber", "==", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"anotherparameter1", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"anotherparameter2", "=", "3"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"anotherparameter1", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"anotherparameter2", "=", "2"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
      "FileExistsQ", "[", 
       "\"\<Codimension-two actual names of parameters.txt\>\"", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{
        "ReadLine", "[", 
         "\"\<Codimension-two actual names of parameters.txt\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"aux", "=", 
        RowBox[{"FormattingStringsCommaSplit", "[", "aux", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newparam1", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newparam2", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newparam3", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{"aux", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "TeXForm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Close", "[", "\"\<Codimension-two actual names of parameters.txt\>\"",
         "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newparam1", "=", 
        RowBox[{"par", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newparam2", "=", 
        RowBox[{"par", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newparam3", "=", 
        RowBox[{"par", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8683718132532454`*^9, 3.868371815624136*^9}, {
   3.8684483939471674`*^9, 3.868448501757942*^9}, {3.868448555088126*^9, 
   3.868448661973407*^9}, 3.8684487960085444`*^9, {3.8684488385900555`*^9, 
   3.8684488495709395`*^9}, {3.8684489154935303`*^9, 
   3.8684489190402985`*^9}, {3.8684489538283567`*^9, 
   3.8684489792025275`*^9}, {3.868449016702369*^9, 3.8684490167825003`*^9}, 
   3.8684490530626607`*^9, {3.8684491037587876`*^9, 3.8684491497212677`*^9}, {
   3.8684492465331216`*^9, 3.868449330631242*^9}, {3.8684498542259007`*^9, 
   3.868449854957693*^9}, {3.868450390527633*^9, 3.8684503932481494`*^9}, {
   3.8684507007399025`*^9, 3.868450720553238*^9}, {3.869423319751999*^9, 
   3.8694234258183136`*^9}, {3.8694234830042224`*^9, 3.869423550910906*^9}, {
   3.869424300686781*^9, 3.869424638648012*^9}, {3.869424689927828*^9, 
   3.8694247634496937`*^9}, {3.869424952413664*^9, 3.8694249981245985`*^9}, {
   3.869427221021031*^9, 3.869427282129114*^9}, {3.869435755372794*^9, 
   3.869435764964371*^9}, {3.873910887900094*^9, 3.873910898551072*^9}, {
   3.8968821386992407`*^9, 3.8968821390452857`*^9}, {3.8968823537583504`*^9, 
   3.8968824128044257`*^9}, {3.896882462785227*^9, 3.896882463284732*^9}, {
   3.8968825065139303`*^9, 3.896882647844783*^9}, {3.896891538627714*^9, 
   3.896891545591498*^9}, {3.896892523635418*^9, 3.8968925239475355`*^9}, {
   3.8968960273822784`*^9, 3.8968960406466837`*^9}, 
   3.896905618440384*^9},ExpressionUUID->"8e231fa1-823f-4b7e-9741-\
54fb6726aef5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Codimension-two bifurcation curves", "Title",
 CellChangeTimes->{{3.867989016426511*^9, 3.8679890217444987`*^9}, {
  3.896892964797171*^9, 
  3.896892965040124*^9}},ExpressionUUID->"721b3d26-65f5-48dc-83bc-\
d60458e19cf1"],

Cell[TextData[{
 "This section does, essentially, the same as the section bifurcation curves. \
There are only two differences here; first, the initial conditions are \
already known since they are given by any of the codimension-two bifurcation \
points found before (if any); second, here we add the extra bifurcation \
condition ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "3"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6ed153e4-24bb-4860-aae1-d89b716d743d"],
 "=0 to continue codimension-two bifurcation curves."
}], "Text",
 CellChangeTimes->{{3.8741474528461266`*^9, 
  3.874147621953436*^9}},ExpressionUUID->"4e47a1b0-2e23-44ed-9899-\
bb6d3e49b736"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialt", "=", 
     RowBox[{"-", "1000"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"finalt", "=", "1000"}], ";", "\[IndentingNewLine]", 
    RowBox[{"curvespeed", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"smalldifferential", "=", "0.001"}], ";", "\[IndentingNewLine]", 
    RowBox[{"variabledependence", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "varnum", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"kineticsaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"kinetics", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"muNF", "->", 
        RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zerodetaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zerodet", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"muNF", "->", 
        RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zeroderaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zeroder", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"muNF", "->", 
        RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"auxC3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"C3", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"muNF", "->", 
        RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", "zeroderaux"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", "auxC3"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"D", "[", 
      RowBox[{"equations", ",", "time"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{"muNF", "'"}], "[", "time", "]"}], "2"], "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"varnum", "=", "1"}], "nvar"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
         "2"]}], "-", 
       SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equations", "[", 
         RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"equationnumber", ",", 
         RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"allvar", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", "muNF"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvartimedependent", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"allvar", "[", 
         RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", 
         RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"initialconditions", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "codimensiontwopoints", "]"}], "==", "1"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"initialconditions", ",", 
         RowBox[{"codimensiontwopoints", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"pointnum", "=", "1"}], ",", 
        RowBox[{"pointnum", "<=", 
         RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], ",", 
        RowBox[{"pointnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"inp", "=", 
          RowBox[{"HoldForm", "[", 
           RowBox[{"Input", "[", 
            RowBox[{
            "\"\<Would you like to continue point \>\"", " ", "<>", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"codimensiontwopoints", "[", 
                RowBox[{"[", "pointnum", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", "2"}], "]"}], "]"}], "]"}], " ", "<>", " ", 
             "\"\<[y/n]\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"inp", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"initialconditions", ",", 
              RowBox[{"codimensiontwopoints", "[", 
               RowBox[{"[", "pointnum", "]"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"solutioncurves3", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"bifnum", "=", "1"}], ",", 
      RowBox[{"bifnum", "<=", "numberofbifurcationcurves"}], ",", 
      RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"initialvalues", "=", 
        RowBox[{"initialconditions", "[", 
         RowBox[{"[", "bifnum", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialvalues", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"initialvalues", ",", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "fixedparameternumber", "]"}], "]"}], "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "fixedparameternumber", "]"}], "]"}], "/.", 
             "fixedpar"}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dereval", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"initialvalues", "[", 
              RowBox[{"[", "varnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"varnum", ",", 
            RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"initialderivatives", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"equations", "/.", 
             RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
            RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"dernumber", "=", "1"}], ",", 
         RowBox[{"dernumber", "<=", 
          RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
         RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equations", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialvalues", "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                RowBox[{
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equationsaux", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", 
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "fixedparameternumber", "]"}], "]"}], "[", 
                 "time", "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", "fixedparameternumber", "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "fixedparameternumber", "]"}], "]"}], "[", 
                 "time", "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", "fixedparameternumber", "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "anotherparameter1", "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", "anotherparameter1", "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "anotherparameter1", "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", "anotherparameter1", "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "anotherparameter2", "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", "anotherparameter2", "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "anotherparameter2", "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", "anotherparameter2", "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sol", "=", 
           RowBox[{"NDSolve", "[", 
            RowBox[{"equationsaux", ",", "allvar", ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], ",", 
             RowBox[{"Method", "->", 
              RowBox[{"{", 
               RowBox[{
               "\"\<EquationSimplification\>\"", "->", "\"\<Residual\>\""}], 
               "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sol", "]"}], ">", "0"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"solutioncurves3", ",", "sol"}], "]"}], ";"}], ","}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "solutioncurves3", "]"}], "==", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{
            "{", "\"\<This script could not find a Codimension-two \
bifurcation curve for your desired parameters. Try changing the speed of the \
curve\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.868451636567628*^9, 3.8684516479117985`*^9}, {
   3.868452461204034*^9, 3.8684524882254705`*^9}, 3.8684525223446913`*^9, {
   3.868452793595519*^9, 3.868452829015482*^9}, {3.8684529011274137`*^9, 
   3.8684529052973976`*^9}, {3.868452958381147*^9, 3.8684530358149614`*^9}, {
   3.8684542272683797`*^9, 3.868454320271531*^9}, {3.8684543642938113`*^9, 
   3.8684543667263074`*^9}, {3.8684544223627443`*^9, 3.8684544294125843`*^9}, 
   3.8684564428531404`*^9, {3.8684570884166317`*^9, 3.8684570894064302`*^9}, {
   3.8684635896446314`*^9, 3.8684636032364807`*^9}, {3.869423452417471*^9, 
   3.869423455411974*^9}, {3.8694246664867043`*^9, 3.869424667980541*^9}, {
   3.8694247737002735`*^9, 3.869424789924559*^9}, {3.869425013647561*^9, 
   3.869425043538111*^9}, {3.8695953559819555`*^9, 3.8695953803214874`*^9}, {
   3.8696673213961806`*^9, 3.8696673223545895`*^9}, {3.8696673616583786`*^9, 
   3.8696674006143208`*^9}, {3.873910911394943*^9, 3.8739109274515142`*^9}, {
   3.896882659574498*^9, 3.896882670986422*^9}, {3.89688270815401*^9, 
   3.8968827131324115`*^9}, {3.8968827559334416`*^9, 3.896882764016041*^9}, {
   3.896891855032193*^9, 3.8968918554143333`*^9}, {3.8968924543756795`*^9, 
   3.8968924833284225`*^9}, {3.8968925588303194`*^9, 3.8968925911742887`*^9}, 
   3.896892960416363*^9},ExpressionUUID->"b8150510-4aa6-4710-af7d-\
a3857f48b73d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Other Turing bifurcation curves", "Title",
 CellChangeTimes->{{3.8679890334541397`*^9, 3.8679890497493553`*^9}, {
  3.896898622428897*^9, 
  3.896898622698437*^9}},ExpressionUUID->"93eb3777-1d8e-484c-a587-\
8a12b89e2186"],

Cell["\<\
This section computes Turing bifurcation curves you would like to see plotted \
together with the codimension-two curve. These extra curves will start \
automatically from the codimension-two point, so there is no need to look for \
initial conditions.\
\>", "Text",
 CellChangeTimes->{{3.8741476383688912`*^9, 
  3.8741477380871315`*^9}},ExpressionUUID->"21bfde7a-2c5c-4a92-a9b1-\
7fda07677624"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialt", "=", 
     RowBox[{"-", "1000"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"finalt", "=", "1000"}], ";", "\[IndentingNewLine]", 
    RowBox[{"curvespeed", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tol", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "15"}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
      "FileExistsQ", "[", 
       "\"\<Extra Turing curves in codimension-two bifurcation \
diagram.txt\>\"", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"howmanyturing", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"ReadList", "[", 
          RowBox[{
          "\"\<Extra Turing curves in codimension-two bifurcation diagram.txt\
\>\"", ",", 
           RowBox[{"null", "@", "String"}], ",", 
           RowBox[{"NullRecords", "->", "True"}]}], "]"}]}]}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"howmanyturing", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"fixedparametervalues", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"initialconditions", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"turingbifurcationcurves", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"turingnumber", "=", "1"}], ",", 
      RowBox[{"turingnumber", "<=", "howmanyturing"}], ",", 
      RowBox[{"turingnumber", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{
        "ReadLine", "[", 
         "\"\<Extra Turing curves in codimension-two bifurcation \
diagram.txt\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"fixedparametervalues", ",", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "fixedparameternumber", "]"}], "]"}], "->", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"aux", ",", "TeXForm"}], "]"}]}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "Close", "[", 
     "\"\<Extra Turing curves in codimension-two bifurcation diagram.txt\>\"",
      "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"turingnumber", "=", "1"}], ",", 
      RowBox[{"turingnumber", "<=", "howmanyturing"}], ",", 
      RowBox[{"turingnumber", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"getout", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"outersolnum", "=", "1"}], ",", 
         RowBox[{"outersolnum", "<=", 
          RowBox[{"Length", "[", "solutioncurves3", "]"}]}], ",", 
         RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"getout", "==", "1"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"innersolnum", "=", "1"}], ",", 
            RowBox[{"innersolnum", "<=", 
             RowBox[{"Length", "[", 
              RowBox[{"solutioncurves3", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"solt", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"NMinimize", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "fixedparameternumber", "]"}], "]"}], "[", 
                    "time", "]"}], "-", 
                    RowBox[{
                    RowBox[{"fixedparametervalues", "[", 
                    RowBox[{"[", "turingnumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"], "/.", 
                  RowBox[{
                   RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", "time"}], 
                "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<=", 
                RowBox[{"(", 
                 RowBox[{"time", "/.", 
                  RowBox[{"solt", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "<=", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"solt", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "tol"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"initialconditions", ",", 
                    RowBox[{"Check", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "/.", 
                    RowBox[{"solt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "Null"}], "]"}]}], 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"initialconditions", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allvar", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allvar", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{"initialconditions", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}], "/.", 
                    RowBox[{"solt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"getout", "=", "1"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]",
                 "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"bifnum", "=", "1"}], ",", 
      RowBox[{"bifnum", "<=", 
       RowBox[{"Length", "[", "initialconditions", "]"}]}], ",", 
      RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fixedparametereval", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "fixedparameternumber", "]"}], "]"}], "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"par", "[", 
             RowBox[{"[", "fixedparameternumber", "]"}], "]"}], "/.", 
            RowBox[{"initialconditions", "[", 
             RowBox[{"[", "bifnum", "]"}], "]"}]}], ")"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kineticsaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"kinetics", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "anotherparameter1", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "anotherparameter1", "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par", "[", 
             RowBox[{"[", "anotherparameter2", "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "anotherparameter2", "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"muNF", "->", 
           RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zerodetaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"zerodet", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "anotherparameter1", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "anotherparameter1", "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par", "[", 
             RowBox[{"[", "anotherparameter2", "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "anotherparameter2", "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"muNF", "->", 
           RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zeroderaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"zeroder", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "anotherparameter1", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "anotherparameter1", "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par", "[", 
             RowBox[{"[", "anotherparameter2", "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "anotherparameter2", "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"muNF", "->", 
           RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", "zeroderaux"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "fixedparameternumber", "]"}], "]"}], "[", "time", 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"D", "[", 
         RowBox[{"equations", ",", "time"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "anotherparameter1", "]"}], "]"}], "'"}], "[", 
            "time", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "anotherparameter2", "]"}], "]"}], "'"}], "[", 
            "time", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"muNF", "'"}], "[", "time", "]"}], "2"], "+", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"varnum", "=", "1"}], "nvar"], 
           SuperscriptBox[
            RowBox[{
             RowBox[{
              RowBox[{"var", "[", 
               RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}],
             "2"]}], "-", 
          SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"equations", "[", 
            RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"equationnumber", ",", 
            RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"initialvalues", "=", 
        RowBox[{"initialconditions", "[", 
         RowBox[{"[", "bifnum", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dereval", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"initialvalues", "[", 
              RowBox[{"[", "varnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"varnum", ",", 
            RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"initialderivatives", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"equations", "/.", 
             RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
            RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"dernumber", "=", "1"}], ",", 
         RowBox[{"dernumber", "<=", 
          RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
         RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equations", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialvalues", "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                RowBox[{
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equationsaux", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", 
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "anotherparameter1", "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", "anotherparameter1", "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "anotherparameter1", "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", "anotherparameter1", "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "anotherparameter2", "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", "anotherparameter2", "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "anotherparameter2", "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", "anotherparameter2", "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sol", "=", 
           RowBox[{"NDSolve", "[", 
            RowBox[{"equationsaux", ",", "allvar", ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], ",", 
             RowBox[{"Method", "->", 
              RowBox[{"{", 
               RowBox[{
               "\"\<EquationSimplification\>\"", "->", "\"\<Residual\>\""}], 
               "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "sol", "]"}], ">", "0"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"sol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"turingbifurcationcurves", ",", "sol"}], "]"}], ";"}]}],
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{
  3.8685344045247555`*^9, {3.8685344367898693`*^9, 3.8685346043599553`*^9}, {
   3.868534867546937*^9, 3.8685348784329476`*^9}, {3.868534931741347*^9, 
   3.8685349501163187`*^9}, {3.8694247997141914`*^9, 
   3.8694248135997396`*^9}, {3.8694250642137456`*^9, 
   3.8694250880153723`*^9}, {3.8694358455499463`*^9, 3.86943588424797*^9}, {
   3.8739109379794726`*^9, 3.873910957133812*^9}, 3.883063083196973*^9, {
   3.8830631916679516`*^9, 3.883063207527285*^9}, {3.8968828183096647`*^9, 
   3.8968828510462017`*^9}, {3.896898538046218*^9, 
   3.8968986051269712`*^9}},ExpressionUUID->"b5767154-72ac-4193-ae3b-\
769f8643c433"]
}, Closed]],

Cell[CellGroupData[{

Cell["Codimension-two bifurcation diagram plotting", "Title",
 CellChangeTimes->{{3.8679890696301303`*^9, 3.8679890891529574`*^9}, {
  3.8686305138178005`*^9, 3.8686305265297055`*^9}, {3.8695954169288797`*^9, 
  3.869595419482086*^9}, {3.8968836332939825`*^9, 3.8968836334491835`*^9}, {
  3.8968986796193447`*^9, 
  3.8968986799905357`*^9}},ExpressionUUID->"5fc239ca-55da-4460-b950-\
7fe88eed2c81"],

Cell["\<\
This section plots each of the codimension-one and two parametric bifurcation \
curves found, where the codimension-one ones are colored as before, whilst \
the codimension-two curve is coloured black. Also, the intersections between \
these two kinds of curves will be will be plotted in this section\
\>", "Text",
 CellChangeTimes->{{3.874147753340143*^9, 3.8741477956932464`*^9}, {
  3.8741478297876368`*^9, 3.8741478560651507`*^9}, {3.8741513254375615`*^9, 
  3.8741513291938114`*^9}},ExpressionUUID->"bcdfdd1b-45dc-4092-8222-\
9834319362c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bifcurveplot", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"turingcurveplot", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"critpoints", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"par", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"par", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/.", 
            RowBox[{"initialconditions", "[", 
             RowBox[{"[", "bifnum", "]"}], "]"}]}], "]"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"bifnum", ",", 
         RowBox[{"Length", "[", "initialconditions", "]"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"outersolnum", "=", "1"}], ",", 
      RowBox[{"outersolnum", "<=", 
       RowBox[{"Length", "[", "turingbifurcationcurves", "]"}]}], ",", 
      RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"innersolnum", "=", "1"}], ",", 
        RowBox[{"innersolnum", "<=", 
         RowBox[{"Length", "[", 
          RowBox[{"turingbifurcationcurves", "[", 
           RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"auxnonzero", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
             "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar3"}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"muNF", "->", 
                RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"turingbifurcationcurves", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"auxC3", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
             "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"C3", "/.", "fixedpar3"}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"muNF", "->", 
                RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"turingbifurcationcurves", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"muNF", "[", "time", "]"}], ">", "0"}], " ", "&&", 
                  " ", 
                  RowBox[{
                   RowBox[{"auxC3", "[", "time", "]"}], "\[Element]", 
                   "Reals"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"auxC3", "[", "time", "]"}], "<", "0"}]}], " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"muNF", "[", "time", "]"}], ">", "0"}], " ", "&&", 
                  " ", 
                  RowBox[{
                   RowBox[{"auxC3", "[", "time", "]"}], "\[Element]", 
                   "Reals"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"auxC3", "[", "time", "]"}], ">", "0"}]}], " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"muNF", "[", "time", "]"}], "<", "0"}]}], " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Green", ",", "Dotted"}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"outersolnum", "=", "1"}], ",", 
      RowBox[{"outersolnum", "<=", 
       RowBox[{"Length", "[", "solutioncurves3", "]"}]}], ",", 
      RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"innersolnum", "=", "1"}], ",", 
        RowBox[{"innersolnum", "<=", 
         RowBox[{"Length", "[", 
          RowBox[{"solutioncurves3", "[", 
           RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"auxnonzero", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
             "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar3"}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"muNF", "->", 
                RowBox[{"muNF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"solutioncurves3", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"muNF", "[", "time", "]"}], ">", "0"}]}], "/.", 
                 RowBox[{
                  RowBox[{"solutioncurves3", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", " ", 
                 RowBox[{
                  RowBox[{"solutioncurves3", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "->", "Black"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"bifcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bifcurveplot", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"turingcurveplot", ",", "bifcurveplot"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"CreateDocument", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", "plot3", "]"}], ",", 
      RowBox[{"WindowSize", "->", 
       RowBox[{"{", 
        RowBox[{"500", ",", "500"}], "}"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ValueQ", "[", "critpoints", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"plot3", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"bifcurveplot", ",", "critpoints", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"newparam1", ",", "StandardForm"}], "]"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"newparam2", ",", "StandardForm"}], "]"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"newparam3", ",", "StandardForm"}], "]"}]}], "}"}]}], 
         ",", 
         RowBox[{"RotateLabel", "->", "False"}], ",", 
         RowBox[{"AxesStyle", "->", 
          RowBox[{"Directive", "[", 
           RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
         RowBox[{"BoxRatios", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}], " ", 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"plot3", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"bifcurveplot", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"newparam1", ",", "StandardForm"}], "]"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"newparam2", ",", "StandardForm"}], "]"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"newparam3", ",", "StandardForm"}], "]"}]}], "}"}]}], 
         ",", 
         RowBox[{"RotateLabel", "->", "False"}], ",", 
         RowBox[{"AxesStyle", "->", 
          RowBox[{"Directive", "[", 
           RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
         RowBox[{"BoxRatios", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.868630532679496*^9, 3.868630533609314*^9}, {
  3.8686329403319397`*^9, 3.8686329765325193`*^9}, {3.8687074842717004`*^9, 
  3.868707486692384*^9}, {3.8694248211443844`*^9, 3.8694248320244102`*^9}, {
  3.8695954292304344`*^9, 3.8695954502663226`*^9}, {3.8695954960748777`*^9, 
  3.869595546664442*^9}, {3.8726947186489573`*^9, 3.872694724987417*^9}, {
  3.8738952037667913`*^9, 3.8738952066449604`*^9}, {3.87391097292367*^9, 
  3.8739110150345964`*^9}, {3.883058720883506*^9, 3.8830588013809566`*^9}, {
  3.8830645274201555`*^9, 3.8830645562999554`*^9}, {3.8968835504267435`*^9, 
  3.896883565854916*^9}, {3.896883602685253*^9, 3.8968836247940626`*^9}, {
  3.896898645933807*^9, 
  3.896898663397427*^9}},ExpressionUUID->"12e3224d-85ea-4077-a7a5-\
67b3f4f96a04"],

Cell[BoxData["\<\"The files needed to plot the codimension-two curves were \
not found\"\>"], "Output",
 CellChangeTimes->{3.8694248991637354`*^9, 3.8694251826906347`*^9, 
  3.8694273145700254`*^9, 3.869436080283115*^9, 3.8695948779155097`*^9, 
  3.8695952087839575`*^9, 3.869595617145673*^9, 3.8695958245634813`*^9, 
  3.869666953442917*^9, 3.869667477491601*^9, 3.869668519542823*^9, 
  3.86966875744398*^9, 3.8696688451605825`*^9, 3.8696690024894037`*^9, 
  3.869670080755952*^9, 3.8696702999976053`*^9, 3.86967710887939*^9, 
  3.869677222458867*^9, 3.8696774322897205`*^9, 3.8696948256763697`*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"ecd28ce9-2417-42f6-a1e6-5f01a60374d6"]
}, Closed]]
}, Closed]]
},
WindowSize->{1428., 735.75},
WindowMargins->{{-6, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification:>1.4 Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fedd186e-0433-4b8f-bc48-17a0a3d40abe"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 163, 3, 136, "Title",ExpressionUUID->"77f8df86-6a9f-4879-bc32-9275d4face24"],
Cell[746, 27, 234, 6, 48, "Text",ExpressionUUID->"45326316-4145-432f-89a9-747b68a3aa30"],
Cell[983, 35, 158, 3, 39, "Input",ExpressionUUID->"2932a2ed-eea1-4963-8632-1e3547b3c238"]
}, Closed]],
Cell[CellGroupData[{
Cell[1178, 43, 263, 4, 98, "Title",ExpressionUUID->"656e802e-4c40-491b-94a5-e18c034cec54"],
Cell[1444, 49, 661, 20, 48, "Text",ExpressionUUID->"333e06fd-bda8-481a-a7ae-e2bc0b510fa7"],
Cell[2108, 71, 6811, 145, 761, "Input",ExpressionUUID->"165428b9-478f-4fca-b265-766d7de2d9aa"]
}, Closed]],
Cell[CellGroupData[{
Cell[8956, 221, 214, 4, 98, "Title",ExpressionUUID->"cfb7ff55-9e3e-44eb-b010-aa12f359418b"],
Cell[9173, 227, 393, 8, 79, "Text",ExpressionUUID->"603c7a43-6c76-4990-b1b0-a51d7a961bc4"],
Cell[9569, 237, 8451, 207, 1478, "Input",ExpressionUUID->"e355d9ee-cf66-4ea3-b37b-80019a7b1bbf"]
}, Closed]],
Cell[CellGroupData[{
Cell[18057, 449, 293, 4, 98, "Title",ExpressionUUID->"6b1368fc-8535-487b-a757-1df89674a1ae"],
Cell[18353, 455, 313, 7, 79, "Text",ExpressionUUID->"7f370b43-db6a-4899-9799-13d0f3292753"],
Cell[18669, 464, 12649, 289, 2118, "Input",ExpressionUUID->"47b09d0b-e895-4096-b07a-c4c7a19e5112"]
}, Closed]],
Cell[CellGroupData[{
Cell[31355, 758, 244, 4, 98, "Title",ExpressionUUID->"a4bdec2e-f6d4-4657-b8b4-76183b2ecf81"],
Cell[31602, 764, 297, 6, 48, "Text",ExpressionUUID->"b5477da1-e976-4ef3-9e69-45d9f3b72aeb"],
Cell[31902, 772, 5464, 127, 786, "Input",ExpressionUUID->"47f29af5-90a6-416b-851b-bc0d861fff99"]
}, Closed]],
Cell[CellGroupData[{
Cell[37403, 904, 413, 6, 98, "Title",ExpressionUUID->"ea7c5508-ed79-43b1-a153-1c2fd0b76f5b"],
Cell[37819, 912, 1024, 16, 172, "Text",ExpressionUUID->"5fec1db2-68c6-4b57-89c4-f85a05da35a1"],
Cell[38846, 930, 68394, 1473, 4010, "Input",ExpressionUUID->"9919ef6e-2978-4802-bd05-8061f7920bda"]
}, Closed]],
Cell[CellGroupData[{
Cell[107277, 2408, 216, 4, 98, "Title",ExpressionUUID->"4684d111-706c-433d-8a4b-d34dca57b6d5"],
Cell[107496, 2414, 323, 7, 48, "Text",ExpressionUUID->"c28fe9c7-075c-4be0-a77a-35b2a8d3cfa8"],
Cell[107822, 2423, 3651, 90, 694, "Input",ExpressionUUID->"e502312f-1ef8-470b-9311-ad61bfb6028a"]
}, Closed]],
Cell[CellGroupData[{
Cell[111510, 2518, 378, 5, 98, "Title",ExpressionUUID->"741eb1d1-ecb6-4601-bec9-e01c0e2cd7d8"],
Cell[111891, 2525, 1061, 26, 110, "Text",ExpressionUUID->"4471743e-7c28-41e1-9073-41bf3f51418a"],
Cell[112955, 2553, 39911, 774, 2421, "Input",ExpressionUUID->"fb8b154a-015f-45ba-964e-1aa654390a6e"]
}, Closed]],
Cell[CellGroupData[{
Cell[152903, 3332, 270, 4, 98, "Title",ExpressionUUID->"335983e1-ddfc-4628-a13f-400ae567ecbb"],
Cell[153176, 3338, 1234, 31, 141, "Text",ExpressionUUID->"c3a28e72-11cc-4488-b25f-12fc8d97dce5"],
Cell[154413, 3371, 29766, 596, 1452, "Input",ExpressionUUID->"7f0bdfc8-c8b7-4f06-9635-3f6fa686187c"]
}, Closed]],
Cell[CellGroupData[{
Cell[184216, 3972, 426, 7, 183, "Title",ExpressionUUID->"22396d79-1554-4bd1-b57b-3637995f26e1"],
Cell[184645, 3981, 210, 6, 48, "Text",ExpressionUUID->"1d798801-9506-4883-bd0a-503a8c94ea1e"],
Cell[184858, 3989, 8745, 203, 1425, "Input",ExpressionUUID->"8e231fa1-823f-4b7e-9741-54fb6726aef5"]
}, Closed]],
Cell[CellGroupData[{
Cell[193640, 4197, 228, 4, 98, "Title",ExpressionUUID->"721b3d26-65f5-48dc-83bc-d60458e19cf1"],
Cell[193871, 4203, 690, 15, 110, "Text",ExpressionUUID->"4e47a1b0-2e23-44ed-9899-bb6d3e49b736"],
Cell[194564, 4220, 22304, 546, 2155, "Input",ExpressionUUID->"b8150510-4aa6-4710-af7d-a3857f48b73d"]
}, Closed]],
Cell[CellGroupData[{
Cell[216905, 4771, 227, 4, 98, "Title",ExpressionUUID->"93eb3777-1d8e-484c-a587-8a12b89e2186"],
Cell[217135, 4777, 406, 8, 79, "Text",ExpressionUUID->"21bfde7a-2c5c-4a92-a9b1-7fda07677624"],
Cell[217544, 4787, 22991, 544, 2275, "Input",ExpressionUUID->"b5767154-72ac-4193-ae3b-769f8643c433"]
}, Closed]],
Cell[CellGroupData[{
Cell[240572, 5336, 398, 6, 98, "Title",ExpressionUUID->"5fc239ca-55da-4460-b950-7fe88eed2c81"],
Cell[240973, 5344, 556, 9, 110, "Text",ExpressionUUID->"bcdfdd1b-45dc-4092-8222-9834319362c1"],
Cell[CellGroupData[{
Cell[241554, 5357, 28327, 653, 1905, "Input",ExpressionUUID->"12e3224d-85ea-4077-a7a5-67b3f4f96a04"],
Cell[269884, 6012, 680, 9, 45, "Output",ExpressionUUID->"ecd28ce9-2417-42f6-a1e6-5f01a60374d6"]
}, Closed]]
}, Closed]]
}
]
*)

