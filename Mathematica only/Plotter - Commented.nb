(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    339996,       7776]
NotebookOptionsPosition[    333923,       7670]
NotebookOutlinePosition[    334396,       7688]
CellTagsIndexPosition[    334353,       7685]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Clearing Variables", "Title",
 CellChangeTimes->{{3.8954751959788213`*^9, 
  3.8954752006811113`*^9}},ExpressionUUID->"ea61d8e4-711d-4d74-b25b-\
761ac764db40"],

Cell["\<\
This section just clears all the variables that have been already defined in \
Mathematica\
\>", "Text",
 CellChangeTimes->{{3.896873793156684*^9, 
  3.896873815190978*^9}},ExpressionUUID->"fb852f10-685d-44ae-b15a-\
4cf30567a1b9"],

Cell[BoxData[
 RowBox[{"Quiet", "@", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"4dd8c56a-24c9-40ec-9db2-0034b1e9c701"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameters", "Title",
 CellChangeTimes->{{3.895427920732616*^9, 3.8954279223516064`*^9}, {
  3.8969641209462895`*^9, 3.8969641211576247`*^9}, {3.896964692999531*^9, 
  3.8969646932068233`*^9}, {3.896965314265585*^9, 
  3.8969653144867287`*^9}},ExpressionUUID->"64324ed7-52be-4b1e-98cb-\
d02a137df024"],

Cell["\<\
This section is to set all the parameters of the system, including tolerances \
and parameters that are set to indicate Mathematica what wants to be computed\
\>", "Text",
 CellChangeTimes->{{3.896873825260089*^9, 
  3.8968738898988423`*^9}},ExpressionUUID->"edf22f9a-7a61-4ca6-96ad-\
ede52a777aa8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tol", "=", 
    SuperscriptBox["10", 
     RowBox[{"-", "9"}]]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Tolerance", " ", "for", " ", "the", " ", "initial", " ", "conditions", 
    " ", "to", " ", "compute", " ", "the", " ", "bifurcation", " ", 
    "curves"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Choptol", "=", 
    SuperscriptBox["10", 
     RowBox[{"-", "9"}]]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "A", " ", "number", " ", "that", " ", "is", " ", "lower", " ", "than", " ",
     "this", " ", "tolerance", " ", "in", " ", "absolute", " ", "value", " ", 
    "will", " ", "be", " ", "considered", " ", "as", " ", "zero"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"disttol", "=", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "If", " ", "two", " ", "points", " ", "are", " ", "closer", " ", "than", 
     " ", "this", " ", "distance", " ", "to", " ", "each", " ", "other"}], 
    ",", " ", 
    RowBox[{
    "they", " ", "will", " ", "be", " ", "considered", " ", "the", " ", 
     "same", " ", "point"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nmax", "=", "5"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Order", " ", "of", " ", "the", " ", 
     RowBox[{"expansion", ".", " ", "Available"}], " ", "choices", " ", "are",
      " ", "3", " ", "and", " ", "5.", " ", "If", " ", "higher", " ", "than", 
     " ", "five"}], ",", " ", 
    RowBox[{
    "the", " ", "computation", " ", "will", " ", "take", " ", "longer", " ", 
     "and", " ", "the", " ", "other", " ", "coefficients", " ", "will", " ", 
     "not", " ", "be", " ", 
     RowBox[{"used", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialt", "=", 
   RowBox[{"-", "1000"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"finalt", "=", "1000"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "These", " ", "two", " ", "parameters", " ", "set", " ", "the", " ", 
     "interval", " ", "for", " ", "the", " ", "parameter", " ", "that", " ", 
     "defines", " ", "the", " ", "curve", " ", "such", " ", "that", " ", 
     "initialt"}], "<=", "time", "<=", "finalt"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"smalldifferential", "=", "0.001"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Threshold", " ", "to", " ", "stop", " ", "the", " ", "computation", " ", 
    "when", " ", "the", " ", "curve", " ", "goes", " ", "away", " ", "from", 
    " ", "the", " ", "rectangle", " ", "if", " ", "further", " ", "away", " ",
     "from", " ", "this", " ", "distance"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"curvespeed", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Speed", " ", "of", " ", "the", " ", "curve", " ", "in", " ", "the", " ",
       "sense", " ", "that"}], " ", "||", 
     RowBox[{
      RowBox[{"x", "'"}], 
      RowBox[{"(", "t", ")"}]}], "||"}], "=", 
    RowBox[{
    "curvespeed", " ", "for", " ", "every", " ", "value", " ", "of", " ", 
     RowBox[{"t", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numberofzerotemporalderivatives", "=", "0"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"In", " ", "some", " ", "cases"}], ",", " ", 
    RowBox[{
    "some", " ", "time", " ", "derivatives", " ", "are", " ", "equal", " ", 
     "to", " ", 
     RowBox[{"zero", ".", " ", "In"}], " ", "that", " ", "case"}], ",", " ", 
    RowBox[{
     RowBox[{
     "this", " ", "number", " ", "indicated", " ", "the", " ", "number", " ", 
      "of", " ", "those", " ", "derivatives", " ", "that", " ", "are", " ", 
      RowBox[{"zero", ".", " ", "See"}], " ", "the", " ", "Swift"}], "-", 
     RowBox[{"Hohenberg", " ", "example"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqbool", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", " ", "1"}], ",", " ", 
    RowBox[{
    "then", " ", "Mathematica", " ", "computes", " ", "the", " ", 
     "homogeneous", " ", "steady", " ", "states", " ", "of", " ", "the", " ", 
     "system", " ", "and", " ", "you", " ", "can", " ", "take", " ", "one", 
     " ", "of", " ", 
     RowBox[{"those", ".", " ", "If"}], " ", "0"}], ",", " ", 
    RowBox[{
    "then", " ", "Mathematica", " ", "will", " ", "search", " ", "for", " ", 
     "any", " ", "bifurcation", " ", "curve", " ", "for", " ", "any", " ", 
     "homogeneous", " ", "steady", " ", "state"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"simpleeq", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "1", " ", "if", " ", "the", " ", "expression", " ", "of", " ", "the", " ",
      "steady", " ", "state", " ", "is", " ", "\"\<simple\>\"", " ", "so", 
     " ", "that", " ", "it", " ", "can", " ", "be", " ", "replaced", " ", 
     "in", " ", "the", " ", "formulas", " ", "that", " ", "determine", " ", 
     "the", " ", "bifurcation"}], ",", " ", 
    RowBox[{"0", " ", "otherwise"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"criticalitychanges", "=", "\"\<y\>\""}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\"\<y\>\"", " ", "if", " ", "you", " ", "want", " ", "Mathematica", " ", 
     "to", " ", "find", " ", "changes", " ", "of", " ", "criticality"}], ",", 
    " ", 
    RowBox[{"\"\<n\>\"", " ", 
     RowBox[{"otherwise", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timedifference", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"This", " ", "is", " ", "the", " ", "time", " ", "step"}], "-", 
    RowBox[{"size", " ", "for", " ", "finding", " ", "codimension"}], "-", 
    RowBox[{"two", " ", "bifurcation", " ", "points"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cod2", "=", "\"\<n\>\""}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\"\<y\>\"", " ", "if", " ", "you", " ", "want", " ", "to", " ", 
      "continue", " ", "any", " ", "of", " ", "the", " ", "codimension"}], 
     "-", 
     RowBox[{
     "two", " ", "points", " ", "considering", " ", "a", " ", "third", " ", 
      "parameter"}]}], ",", " ", 
    RowBox[{"\"\<n\>\"", " ", 
     RowBox[{"otherwise", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"crosscoef", "=", "\"\<n\>\""}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\"\<y\>\"", " ", "if", " ", "you", " ", "want", " ", "to", " ", 
      "compute", " ", "the", " ", "cross"}], "-", 
     RowBox[{"order", " ", "coefficient"}]}], ",", " ", 
    RowBox[{"\"\<n\>\"", " ", 
     RowBox[{"otherwise", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphaval", "=", "\"\<n\>\""}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\"\<y\>\"", " ", "if", " ", "you", " ", "want", " ", "to", " ", 
     "compute", " ", "the", " ", "alpha", " ", "coefficients", " ", "in", " ",
      "the", " ", "normal", " ", "form"}], ",", " ", 
    RowBox[{"\"\<n\>\"", " ", "otherwise"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var", "=", 
    RowBox[{"{", 
     RowBox[{"u", ",", "v"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Names", " ", "of", " ", "the", " ", "variables", " ", "of", " ", "the", 
    " ", "system"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"par", "=", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", "c"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Parameters", " ", "you", " ", "want", " ", "to", " ", "plot", " ", "the",
      " ", "bifurcation", " ", "diagram", " ", "with", " ", "respect", " ", 
     "to"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", "order", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y"}], "}"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parnames", "=", 
    RowBox[{"{", "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "In", " ", "case", " ", "Mathematica", " ", "has", " ", "a", " ", 
     "problem", " ", "with", " ", "a", " ", "parameter", " ", "name", " ", 
     "you", " ", "want", " ", "to", " ", "use"}], ",", " ", 
    RowBox[{
    "you", " ", "can", " ", "change", " ", "the", " ", "parameter", " ", 
     "names", " ", "in", " ", "the", " ", "previous", " ", "variable", " ", 
     "and", " ", "set", " ", "the", " ", "\"\<right\>\"", " ", "name", " ", 
     "of", " ", "it", " ", 
     RowBox[{"here", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"crosspar", "=", 
    RowBox[{"{", "c", "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Parameter", " ", "to", " ", "compute", " ", "the", " ", "cross"}], "-", 
     RowBox[{"order", " ", "coefficient"}]}], ",", " ", 
    RowBox[{
     RowBox[{"if", " ", "crosscoef"}], "=", "\"\<y\>\""}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"parval", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "->", "2"}], ",", 
      RowBox[{"c", "->", "10"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Parameter", " ", "values", " ", "at", " ", "a", " ", "bifurcation", " ", 
     RowBox[{"point", ".", " ", "If"}], " ", "they", " ", "are", " ", "not", 
     " ", "known"}], ",", " ", 
    RowBox[{
    "Mathematica", " ", "will", " ", "compute", " ", "everything", " ", 
     "assuming", " ", "that", " ", "a", " ", "specific", " ", "submatrix", 
     " ", 
     RowBox[{"(", 
      RowBox[{"n", " ", "-", " ", "1"}], ")"}], "x", 
     RowBox[{"(", 
      RowBox[{"n", " ", "-", " ", "1"}], ")"}], " ", "of", " ", "the", " ", 
     "Jacobian", " ", "matrix", " ", "is", " ", 
     RowBox[{"invertible", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fixedpar", "=", 
    RowBox[{"{", 
     RowBox[{"\[Delta]", "->", "0.1"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Values", " ", "of", " ", "the", " ", "parameters", " ", "that", " ", 
    "will", " ", "be", " ", "fixed", " ", "throughout", " ", "the", " ", 
    "computation"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initialvalueTuring", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "2"}], "}"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Lines", " ", "to", " ", 
     RowBox[{"search", ".", " ", "Mathematica"}], " ", "will", " ", "take", 
     " ", "the", " ", "values", " ", "of", " ", "parameters", " ", "in", " ", 
     "this", " ", "variable"}], ",", " ", 
    RowBox[{
    "it", " ", "will", " ", "fix", " ", "them", " ", "and", " ", "will", " ", 
     "find", " ", "all", " ", "the", " ", "Turing", " ", "bifurcation", " ", 
     "curves", " ", "in", " ", "that", " ", "line", " ", "with", " ", 
     "respect", " ", "to", " ", "the", " ", "other", " ", "parameter"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intervalx", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "5"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Range", " ", "of", " ", "values", " ", "of", " ", "the", " ", "parameter",
     " ", "in", " ", "the", " ", "x", " ", "axis"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intervaly", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "50"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Range", " ", "of", " ", "values", " ", "of", " ", "the", " ", "parameter",
     " ", "in", " ", "the", " ", "y", " ", "axis"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"par3", "=", 
    RowBox[{"{", "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Parameters", " ", "to", " ", "use", " ", "to", " ", "continue", " ", 
      "codimension"}], "-", 
     RowBox[{"two", " ", "points"}]}], ",", " ", 
    RowBox[{"in", " ", "the", " ", "order", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}], ".", " ", "Two"}], 
     " ", "of", " ", "the", " ", "parameters", " ", "must", " ", "be", " ", 
     "the", " ", "ones", " ", "in", " ", "the", " ", "variable", " ", 
     "par"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"par3name", "=", 
    RowBox[{"{", "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "In", " ", "case", " ", "Mathematica", " ", "has", " ", "a", " ", 
     "problem", " ", "with", " ", "the", " ", "third", " ", "parameter", " ", 
     "name", " ", "you", " ", "want", " ", "to", " ", "use"}], ",", " ", 
    RowBox[{
    "you", " ", "can", " ", "change", " ", "the", " ", "parameter", " ", 
     "name", " ", "in", " ", "the", " ", "previous", " ", "variable", " ", 
     "and", " ", "set", " ", "the", " ", "\"\<right\>\"", " ", "name", " ", 
     "of", " ", "it", " ", 
     RowBox[{"here", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extrainterval", "=", 
    RowBox[{"{", "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Range", " ", "of", " ", "values", " ", "of", " ", "the", " ", "third", 
    " ", "parameter", " ", "in", " ", "the", " ", "z", " ", "axis"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"otherTuring", "=", 
    RowBox[{"{", "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Values", " ", "of", " ", "the", " ", "thirs", " ", "parameter", " ", 
    "that", " ", "get", " ", "fixed", " ", "tocompute", " ", "the", " ", 
    "Turing", " ", "bifurcation", " ", "curve", " ", "at", " ", "each", " ", 
    "of", " ", "those", " ", "fixed", " ", "values"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8954279584311247`*^9, 3.8954279793477287`*^9}, {
   3.895428046269772*^9, 3.8954280474457483`*^9}, {3.8954281115780554`*^9, 
   3.895428112169461*^9}, {3.8954282439796886`*^9, 3.8954282449905586`*^9}, {
   3.8954287450542436`*^9, 3.8954287614847617`*^9}, {3.895428932817608*^9, 
   3.895428933547702*^9}, {3.8954289690397873`*^9, 3.8954289701566887`*^9}, {
   3.8954324512423363`*^9, 3.89543248765158*^9}, {3.8954326858485527`*^9, 
   3.895432686580777*^9}, {3.8954343381346316`*^9, 3.895434352378853*^9}, {
   3.895435386093203*^9, 3.895435392422604*^9}, {3.8954749139291105`*^9, 
   3.8954749142690797`*^9}, {3.8954751909245663`*^9, 3.895475209553584*^9}, {
   3.895475530346212*^9, 3.895475567367071*^9}, {3.895475704879484*^9, 
   3.8954757403294373`*^9}, {3.895480919360569*^9, 3.8954809230323524`*^9}, {
   3.8956478730793495`*^9, 3.895647918541531*^9}, {3.895650043475133*^9, 
   3.8956500438174953`*^9}, {3.8956500811581297`*^9, 
   3.8956500813877087`*^9}, {3.8956501284524*^9, 3.8956501382474136`*^9}, {
   3.8956502465399227`*^9, 3.8956502557286887`*^9}, 3.895650725558692*^9, {
   3.895659094534528*^9, 3.89565909479698*^9}, 3.895659992655587*^9, {
   3.895669338846998*^9, 3.895669339263445*^9}, {3.8956694499036856`*^9, 
   3.895669451357782*^9}, {3.895675717487457*^9, 3.8956757179262857`*^9}, {
   3.8956894970613256`*^9, 3.8956895121797733`*^9}, {3.895692010905773*^9, 
   3.895692016169233*^9}, {3.895756291749323*^9, 3.895756366446519*^9}, {
   3.8957578974904623`*^9, 3.8957579061444445`*^9}, {3.8957581264546776`*^9, 
   3.8957581988342476`*^9}, {3.895758586247681*^9, 3.895758605771484*^9}, {
   3.8957587090164824`*^9, 3.8957587187348733`*^9}, {3.895758843238387*^9, 
   3.8957588582449007`*^9}, {3.895760448019987*^9, 3.895760450946477*^9}, {
   3.8958187869103174`*^9, 3.8958187873142247`*^9}, 3.8958188418199415`*^9, {
   3.8958191955359535`*^9, 3.895819225325616*^9}, {3.8958194132473173`*^9, 
   3.8958194135932255`*^9}, {3.895819517585163*^9, 3.895819581115199*^9}, {
   3.8958196187141714`*^9, 3.8958196650049896`*^9}, {3.895843687512045*^9, 
   3.895843704124234*^9}, {3.8958438872868023`*^9, 3.895843902486864*^9}, {
   3.896345831332492*^9, 3.896345834204544*^9}, {3.8963511793541937`*^9, 
   3.8963511799442263`*^9}, {3.8968738951216125`*^9, 
   3.8968743387422266`*^9}, {3.8968744470693717`*^9, 3.896874540147649*^9}, {
   3.8968745760210156`*^9, 3.8968747191830764`*^9}, {3.896874809509102*^9, 
   3.8968749006747904`*^9}, {3.8968750137950115`*^9, 
   3.8968752088380175`*^9}, {3.8968753932128143`*^9, 
   3.8968753994867764`*^9}, {3.896876608287466*^9, 3.8968766443380823`*^9}, {
   3.8969040989155025`*^9, 3.8969042353854446`*^9}, {3.896964113541272*^9, 
   3.896964115939376*^9}, {3.8969653112185035`*^9, 3.896965311514104*^9}, {
   3.8969678351250343`*^9, 3.8969678368211308`*^9}, {3.897057369842863*^9, 
   3.8970573777708387`*^9}, {3.8970655382471457`*^9, 
   3.897065884648185*^9}},ExpressionUUID->"cc69dd3d-cbfb-4595-8acd-\
5d98b925aded"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kinetics", "Title",
 CellChangeTimes->{{3.895235772884898*^9, 3.8952357743031654`*^9}, {
  3.8970659204332237`*^9, 
  3.897065920682079*^9}},ExpressionUUID->"4ef2af19-48fd-4c88-b205-\
32b86bb1aa82"],

Cell["\<\
Provide the kinetics and the diffusion matrix in this section on the \
variables \[OpenCurlyDoubleQuote]kinetics\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]diffmatrix\[CloseCurlyDoubleQuote], respectively. In \
this section, Mathematica will also find the homogeneous steady states if \
requested\
\>", "Text",
 CellChangeTimes->{{3.896875223393263*^9, 
  3.8968752947811546`*^9}},ExpressionUUID->"5554f862-fa6d-4737-b089-\
27d14a42d11b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nvar", "=", 
   RowBox[{"Length", "[", "var", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kinetics", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox["\[Alpha]", "\[Delta]"], "-", 
       RowBox[{"c", "*", "u"}], "+", 
       RowBox[{
        SuperscriptBox["u", "2"], "*", "v"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"c", "-", "1"}], ")"}], "*", "u"}], "-", 
       RowBox[{
        SuperscriptBox["u", "2"], "*", "v"}]}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Kinetics", " ", "of", " ", "the", " ", "system"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diffmatrix", "=", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["\[Delta]", "2"], ",", "1"}], "}"}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{"Diffusion", " ", "matrix"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"eqbool", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqs", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"kinetics", "==", "0"}], ",", "var"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "eqs", "]"}], ">", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Your system has \>\"", " ", "<>", " ", 
              RowBox[{"ToString", "[", 
               RowBox[{"Length", "[", "eqs", "]"}], "]"}], " ", "<>", " ", 
              "\"\< equilibria\>\""}], "}"}], "]"}], ",", "\"\<Output\>\""}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"eqnum", "=", "1"}], ",", 
         RowBox[{"eqnum", "<=", 
          RowBox[{"Length", "[", "eqs", "]"}]}], ",", 
         RowBox[{"eqnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SelectionMove", "[", 
           RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"NotebookWrite", "[", 
           RowBox[{"aux", ",", 
            RowBox[{"Cell", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<Equilibrium number \>\"", " ", "<>", " ", 
                  RowBox[{"ToString", "[", "eqnum", "]"}], " ", "<>", " ", 
                  "\"\< is equal to \>\""}], ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"eqs", "[", 
                    RowBox[{"[", "eqnum", "]"}], "]"}], ",", 
                   RowBox[{"FormatType", "->", "StandardForm"}]}], "]"}]}], 
                "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnumber", "=", 
        RowBox[{
        "Input", "[", 
         "\"\<Enter the number of the equilibrium point you would like to \
consider. Enter 0 if the software did not find your desired homogeneous \
steady-state or you want to consider them all\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookClose", "[", "aux", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"eqnumber", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eq", "=", 
           RowBox[{"{", "0", "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eq", "=", 
           RowBox[{
            RowBox[{"eqs", "[", 
             RowBox[{"[", "eqnumber", "]"}], "]"}], "//", "Simplify"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]",
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Mathematica found only one homogeneous steady-state in your \
system. It will proceed with that one.\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eq", "=", 
        RowBox[{
         RowBox[{"eqs", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq", "=", 
     RowBox[{"{", "0", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jacmat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"kinetics", ",", 
     RowBox[{"{", "var", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8906780445102253`*^9, 3.890678111040274*^9}, {
   3.8906781795127645`*^9, 3.8906784723669205`*^9}, {3.8906785744092817`*^9, 
   3.8906785839304657`*^9}, {3.8906787332421875`*^9, 
   3.8906787671951303`*^9}, {3.8906789819966283`*^9, 
   3.8906789824024916`*^9}, {3.8906790253463373`*^9, 3.890679035958171*^9}, {
   3.890820891985819*^9, 3.8908209526656675`*^9}, {3.8908212019136896`*^9, 
   3.890821214519494*^9}, {3.890837938573892*^9, 3.8908379389418235`*^9}, {
   3.8908382727067757`*^9, 3.8908382957217493`*^9}, {3.8908387008302355`*^9, 
   3.8908387038880215`*^9}, {3.8910083771331935`*^9, 
   3.8910083788524365`*^9}, {3.8910117811657915`*^9, 
   3.8910118162434745`*^9}, {3.891278238460943*^9, 3.891278263877515*^9}, {
   3.8912786161584015`*^9, 3.8912786250376377`*^9}, {3.89127870864843*^9, 
   3.8912787270360756`*^9}, {3.891359625495322*^9, 3.8913596282053213`*^9}, {
   3.8913671468534007`*^9, 3.8913671591708355`*^9}, {3.891411787963504*^9, 
   3.891411790255947*^9}, {3.8915052309278564`*^9, 3.8915052315753045`*^9}, {
   3.895235012316103*^9, 3.895235012854446*^9}, {3.8952350873704386`*^9, 
   3.895235125268959*^9}, {3.895235765202467*^9, 3.8952358013314924`*^9}, {
   3.895236341392643*^9, 3.895236357512231*^9}, {3.895236445138153*^9, 
   3.8952364766744957`*^9}, {3.895237058595951*^9, 3.8952370951082315`*^9}, {
   3.895388155978882*^9, 3.8953881641251416`*^9}, {3.8953936835232267`*^9, 
   3.895393697173332*^9}, {3.895397325992364*^9, 3.8953973492203894`*^9}, {
   3.895399144623319*^9, 3.8953991451181927`*^9}, {3.8953992207896357`*^9, 
   3.895399227346514*^9}, 3.895425360033792*^9, {3.8954255588244505`*^9, 
   3.895425559316889*^9}, {3.8954256889194355`*^9, 3.895425689181632*^9}, {
   3.8954258540533*^9, 3.8954258542957*^9}, {3.8954261202773647`*^9, 
   3.8954261451925635`*^9}, {3.8954263798239727`*^9, 3.895426380093327*^9}, {
   3.8954264195342565`*^9, 3.8954264198323936`*^9}, {3.8954269344055133`*^9, 
   3.895426934681567*^9}, {3.895427185972866*^9, 3.8954272404195886`*^9}, {
   3.895427467813653*^9, 3.8954274679638987`*^9}, {3.8954275154645133`*^9, 
   3.8954275271506853`*^9}, {3.895427605450692*^9, 3.8954276412437615`*^9}, {
   3.8954279351491203`*^9, 3.8954279435683675`*^9}, {3.8954281159799*^9, 
   3.8954281166961107`*^9}, 3.8954281579797754`*^9, {3.895428238357767*^9, 
   3.8954282402653947`*^9}, {3.895658672283351*^9, 3.8956586758470488`*^9}, {
   3.8956587442102966`*^9, 3.895658775516533*^9}, 3.8956588845424643`*^9, 
   3.895660012819561*^9, {3.895669176646825*^9, 3.8956691804870205`*^9}, {
   3.895669282131542*^9, 3.8956692951223326`*^9}, {3.895756390242838*^9, 
   3.895756402623145*^9}, {3.8957582128860664`*^9, 3.895758258119711*^9}, {
   3.895758570600191*^9, 3.895758574517352*^9}, 3.895819240073947*^9, {
   3.8958363884659786`*^9, 3.8958364148518105`*^9}, {3.897065908477322*^9, 
   3.897065917254547*^9}},ExpressionUUID->"5cbca695-ca74-488b-a139-\
a446b3ff92a4"],

Cell[BoxData["\<\"Mathematica found only one homogeneous steady-state in your \
system. It will proceed with that one.\"\>"], "Print",
 CellChangeTimes->{3.895819245013669*^9, 3.8958193080245304`*^9, 
  3.8958194413189664`*^9, 3.895843461859709*^9, 3.8958435521442432`*^9, 
  3.8958444425892787`*^9},
 CellLabel->
  "During evaluation of \
In[30]:=",ExpressionUUID->"5a2cd777-d78f-4650-abc4-23a31b797518"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Kernel of the Jacobian matrix", "Title",
 CellChangeTimes->{{3.8952358174342804`*^9, 3.895235823044009*^9}, {
  3.8954272089623084`*^9, 
  3.8954272093927565`*^9}},ExpressionUUID->"b4b8a194-920c-498a-838c-\
7ef029e5294d"],

Cell["\<\
Mathematica finds the kernel of the Jacobian matrix, after finding an \
invertible (n - 1)x(n - 1) submatrix on it, if the parameters for a \
bifurcation were provided.\
\>", "Text",
 CellChangeTimes->{{3.8968753077334957`*^9, 
  3.8968753761997833`*^9}},ExpressionUUID->"b4d74d42-b282-4d76-a057-\
3e600b12bab6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dummymat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dmat", 
      RowBox[{"row", ",", "col"}]], ",", 
     RowBox[{"{", 
      RowBox[{"row", ",", "nvar"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dummyvec", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dvec", "varnum"], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jacobianmat", "=", 
   RowBox[{"jacmat", "-", 
    RowBox[{"\[Mu]NF", "*", "diffmatrix"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerodet", "=", 
   RowBox[{"Det", "[", "dummymat", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerodet", "=", 
   RowBox[{"zerodet", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dummymat", "[", 
         RowBox[{"[", 
          RowBox[{"row", ",", "col"}], "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"jacobianmat", "[", 
          RowBox[{"[", 
           RowBox[{"row", ",", "col"}], "]"}], "]"}], "-", 
         RowBox[{"\[Lambda]NF", "*", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "nvar", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"row", ",", "col"}], "]"}], "]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"row", ",", "nvar"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonzero", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"zerodet", ",", "\[Lambda]NF"}], "]"}], "/.", 
    RowBox[{"\[Lambda]NF", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerodet", "=", 
   RowBox[{"zerodet", "/.", 
    RowBox[{"\[Lambda]NF", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeroder", "=", 
   RowBox[{"D", "[", 
    RowBox[{"zerodet", ",", "\[Mu]NF"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "eq", "]"}], ">", "1"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Mu]val", "=", 
      RowBox[{"Quiet", "@", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"zeroder", "==", "0"}], "/.", "eq"}], "/.", "fixedpar"}], 
          "/.", "parval"}], ",", "\[Mu]NF"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"solnum", "=", "1"}], ",", 
       RowBox[{"solnum", "<=", 
        RowBox[{"Length", "[", "\[Mu]val", "]"}]}], ",", 
       RowBox[{"solnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", 
                 RowBox[{
                  RowBox[{"\[Mu]NF", "/.", 
                   RowBox[{"\[Mu]val", "[", 
                    RowBox[{"[", "solnum", "]"}], "]"}]}], ",", "Choptol"}], 
                 "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Abs", "[", "zerodet", "]"}], "<", "tol"}]}], "/.", 
              RowBox[{"\[Mu]val", "[", 
               RowBox[{"[", "solnum", "]"}], "]"}]}], "/.", "eq"}], "/.", 
            "fixedpar"}], "/.", "parval"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Mu]val", "=", 
            RowBox[{"\[Mu]val", "[", 
             RowBox[{"[", "solnum", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "==", 
           RowBox[{"Length", "[", "\[Mu]val", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", 
           "\"\<You are not actually at a Turing bifurcation\>\"", "]"}]}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["v", "varnum"], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ValueQ", "[", "\[Mu]val", "]"}], " ", "&&", " ", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"\[Mu]val", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "0"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getout", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"row", "=", "1"}], ",", 
       RowBox[{"row", "<=", "nvar"}], ",", 
       RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"getout", "==", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Break", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"col", "=", "1"}], ",", 
          RowBox[{"col", "<=", "nvar"}], ",", 
          RowBox[{"col", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"submatrixrows", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Range", "[", "nvar", "]"}], ",", 
              RowBox[{"{", "row", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"submatrixcols", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Range", "[", "nvar", "]"}], ",", 
              RowBox[{"{", "col", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"jacobianmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], 
                    "]"}], "/.", "\[Mu]val"}], "/.", "eq"}], "/.", 
                 "fixedpar"}], "/.", "parval"}], "]"}], "!=", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"criticalrow", "=", "row"}], ";", "\[IndentingNewLine]", 
              RowBox[{"criticalcol", "=", "col"}], ";", "\[IndentingNewLine]", 
              RowBox[{"getout", "=", "1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"criticalrow", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"criticalcol", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"submatrixrows", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "nvar", "]"}], ",", 
        RowBox[{"{", "criticalrow", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submatrixcols", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "nvar", "]"}], ",", 
        RowBox[{"{", "criticalcol", "}"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{"[", "criticalcol", "]"}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]sol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"jacobianmat", "[", 
          RowBox[{"[", 
           RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], "]"}], ",", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"[", "submatrixcols", "]"}], "]"}]}], "]"}], "==", 
       RowBox[{"-", 
        RowBox[{"jacobianmat", "[", 
         RowBox[{"[", 
          RowBox[{"submatrixrows", ",", 
           RowBox[{"{", "criticalcol", "}"}]}], "]"}], "]"}]}]}], ",", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"[", "submatrixcols", "]"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"\[Phi]", "/.", "\[Phi]sol"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"varnum", "=", "1"}], ",", 
   RowBox[{"varnum", "<=", "nvar"}], ",", 
   RowBox[{"varnum", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"varnum", "<=", 
      RowBox[{"nvar", "-", "numberofzerotemporalderivatives"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], "=", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], "=", "0"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["sol", 
    RowBox[{"1", ",", "1"}]], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["W", 
        RowBox[{"1", ",", "1", ",", "varnum"}]], "[", "X", "]"}], "->", 
      RowBox[{
       RowBox[{
        SubscriptBox["A", "1"], "[", "X", "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dersol", 
    RowBox[{"1", ",", "1"}]], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["sol", 
      RowBox[{"1", ",", "1"}]], ",", "X"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["der2sol", 
    RowBox[{"1", ",", "1"}]], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["dersol", 
      RowBox[{"1", ",", "1"}]], ",", "X"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8908379421660953`*^9, 3.890837946760846*^9}, {
   3.8908380222019863`*^9, 3.8908382649902353`*^9}, {3.890838365633258*^9, 
   3.890838426499406*^9}, {3.890838479992857*^9, 3.890838482586275*^9}, {
   3.890838607433332*^9, 3.8908386239350843`*^9}, {3.890838673494182*^9, 
   3.8908386737417946`*^9}, {3.891008642610325*^9, 3.891008644034711*^9}, {
   3.8910087260908203`*^9, 3.8910087975807967`*^9}, {3.8910118244593515`*^9, 
   3.8910118523420944`*^9}, {3.8910119824088306`*^9, 
   3.8910119826545744`*^9}, {3.891278350096554*^9, 3.8912783923494434`*^9}, {
   3.891278458954806*^9, 3.8912784660273476`*^9}, {3.891278501955251*^9, 
   3.89127850611102*^9}, 3.8912786009765697`*^9, {3.8912786331950736`*^9, 
   3.8912786879474154`*^9}, 3.8912804114370003`*^9, {3.8913612177548866`*^9, 
   3.891361227008133*^9}, {3.891364034104721*^9, 3.8913640610554056`*^9}, {
   3.891364107204362*^9, 3.8913641086450863`*^9}, {3.8913641469071274`*^9, 
   3.891364174366186*^9}, {3.891364208732103*^9, 3.891364220034178*^9}, {
   3.8913642564583707`*^9, 3.8913642807167935`*^9}, {3.8913643270564504`*^9, 
   3.8913643358626833`*^9}, {3.89136439009624*^9, 3.891364491301955*^9}, {
   3.8913663064801884`*^9, 3.8913663662993965`*^9}, {3.891366522555418*^9, 
   3.891366609210707*^9}, {3.891367171183612*^9, 3.8913671822246265`*^9}, {
   3.8913675577347636`*^9, 3.891367558153657*^9}, {3.8914134941734686`*^9, 
   3.8914135077422967`*^9}, {3.891413715633811*^9, 3.8914137160588055`*^9}, {
   3.8914138770782223`*^9, 3.891413895491497*^9}, {3.8914139449896317`*^9, 
   3.891413971203255*^9}, {3.891414030453076*^9, 3.89141405585074*^9}, {
   3.8914337082728815`*^9, 3.8914337114239798`*^9}, {3.891436168612285*^9, 
   3.8914361888684034`*^9}, {3.89143870885564*^9, 3.891438715505005*^9}, {
   3.891439447339345*^9, 3.891439463429737*^9}, {3.8952351757753725`*^9, 
   3.895235487469984*^9}, {3.8952355477364445`*^9, 3.8952355595561967`*^9}, {
   3.895235855996832*^9, 3.895235914451939*^9}, {3.895236246289893*^9, 
   3.895236251791911*^9}, 3.895236520005498*^9, {3.8952366208132496`*^9, 
   3.8952366599519987`*^9}, {3.8952367421895084`*^9, 
   3.8952367462766495`*^9}, {3.8952368169516697`*^9, 3.895236845765771*^9}, {
   3.8952368778025265`*^9, 3.895236915236767*^9}, {3.8952371216206827`*^9, 
   3.8952371260016947`*^9}, {3.895237192767122*^9, 3.895237199850296*^9}, {
   3.895237408805979*^9, 3.8952374112973557`*^9}, {3.8952375588551593`*^9, 
   3.8952375590845704`*^9}, {3.8952411886409626`*^9, 3.895241220504713*^9}, {
   3.8952417060403585`*^9, 3.8952417293689284`*^9}, {3.8952417597882147`*^9, 
   3.8952417783894787`*^9}, {3.895393730860072*^9, 3.8953937791531734`*^9}, {
   3.8953938101744404`*^9, 3.8953938138031025`*^9}, {3.8953938576330137`*^9, 
   3.895393910978653*^9}, {3.8953940010407352`*^9, 3.8953940081864667`*^9}, {
   3.8953940410956645`*^9, 3.8953940428038034`*^9}, 3.8953955571175847`*^9, {
   3.895399236559389*^9, 3.895399246451634*^9}, {3.8954261788249826`*^9, 
   3.8954261798863125`*^9}, {3.895426216467985*^9, 3.895426263961667*^9}, {
   3.8954269583481116`*^9, 3.895426974379551*^9}, {3.895427020312051*^9, 
   3.8954270742402925`*^9}, {3.895428175911461*^9, 3.895428184280898*^9}, 
   3.895428223199233*^9, {3.8954318954029365`*^9, 3.8954319810627813`*^9}, 
   3.895432148649288*^9, {3.8954322564973297`*^9, 3.895432284718607*^9}, {
   3.8956432237181787`*^9, 3.89564325345604*^9}, {3.8956442858563457`*^9, 
   3.895644304309688*^9}, {3.8956664101122203`*^9, 3.8956664115739717`*^9}, {
   3.8957579460792184`*^9, 3.8957580462823725`*^9}, {3.8957595945827866`*^9, 
   3.8957596121874332`*^9}, {3.8957597573003397`*^9, 
   3.8957597779536095`*^9}, {3.8957599582635236`*^9, 3.895759987428463*^9}, {
   3.8957609203735356`*^9, 3.895760923095827*^9}, {3.8957610656304965`*^9, 
   3.895761068347578*^9}, {3.8958364676425543`*^9, 3.8958364683926353`*^9}, {
   3.8958428950809965`*^9, 3.895842954520792*^9}, {3.8958429870253105`*^9, 
   3.8958430538461485`*^9}, 3.8958434352304773`*^9, {3.8958435394691396`*^9, 
   3.8958435434784813`*^9}, {3.896344725950115*^9, 
   3.896344734872848*^9}},ExpressionUUID->"ba1473d1-5aed-4060-aac2-\
2c3cb7a6c1f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kernel of the adjoint", "Title",
 CellChangeTimes->{{3.895235922290038*^9, 3.895235925682999*^9}, {
  3.896367021269752*^9, 
  3.896367021574452*^9}},ExpressionUUID->"5cafe80f-fe2b-43f2-bc97-\
220a654ba175"],

Cell["\<\
Mathematica finds the kernel of the transpose of the Jacobian matrix, using \
the same submatrix used before.\
\>", "Text",
 CellChangeTimes->{{3.89687543375546*^9, 
  3.896875474093751*^9}},ExpressionUUID->"ae428f0a-a208-480c-87b1-\
50551fc4c33b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["v", "varnum"], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "[", 
    RowBox[{"[", "criticalrow", "]"}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]sol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"jacobianmat", "[", 
           RowBox[{"[", 
            RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], "]"}], 
          "]"}], ",", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"[", "submatrixrows", "]"}], "]"}]}], "]"}], "==", 
       RowBox[{"-", 
        RowBox[{"Transpose", "[", 
         RowBox[{"jacobianmat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"{", "criticalrow", "}"}], ",", "submatrixcols"}], "]"}], 
          "]"}], "]"}]}]}], ",", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"[", "submatrixrows", "]"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"\[Psi]", "/.", "\[Psi]sol"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8910064420472236`*^9, 3.891006549455819*^9}, {
   3.891006637611881*^9, 3.8910066458966446`*^9}, {3.891278394256345*^9, 
   3.8912784204155545`*^9}, 3.8913675607521257`*^9, {3.8914356032726283`*^9, 
   3.891435603484974*^9}, 3.8952359347473354`*^9, 3.895237241468288*^9, {
   3.895758057977438*^9, 3.8957580912663546`*^9}, {3.895759315833376*^9, 
   3.8957593268934336`*^9}, {3.895759575754737*^9, 3.8957595759442425`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"a3894b42-9b16-446b-99f4-b500710381cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bifurcation curves", "Title",
 CellChangeTimes->{{3.8954278300192676`*^9, 3.89542783307276*^9}, {
  3.8963597852607503`*^9, 
  3.896359785550768*^9}},ExpressionUUID->"4488db71-1104-4303-b187-\
bae35678313d"],

Cell["\<\
Mathematica finds the bifurcation curves satisfying all the constraints \
imposed by the kinetics and the Turing conditions. To do that, it solves an \
initial value problem starting at a bifurcation point found using the lines \
to search defined above.\
\>", "Text",
 CellChangeTimes->{{3.8968754831658187`*^9, 
  3.896875630069837*^9}},ExpressionUUID->"87af798e-5705-4784-8e1b-\
1bc1ecdc431f"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "par", "]"}], "==", "2"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"variabledependence", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "varnum", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"kineticsaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"kinetics", "/.", "fixedpar"}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zerodetaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"zerodet", "/.", "fixedpar"}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zeroderaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"zeroder", "/.", "fixedpar"}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", "zeroderaux"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"D", "[", 
      RowBox[{"equations", ",", "time"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{"\[Mu]NF", "'"}], "[", "time", "]"}], "2"], "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"varnum", "=", "1"}], "nvar"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
         "2"]}], "-", 
       SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equations", "[", 
         RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"equationnumber", ",", 
         RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equationsGlobalLP", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"kineticsaux", ",", 
       RowBox[{"zerodetaux", "/.", 
        RowBox[{
         RowBox[{"\[Mu]NF", "[", "time", "]"}], "->", "0"}]}]}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"equationsGlobalLP", "=", 
     RowBox[{"D", "[", 
      RowBox[{"equationsGlobalLP", ",", "time"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equationsGlobalLP", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"varnum", "=", "1"}], "nvar"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
         "2"]}], "-", 
       SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equationsGlobalLP", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equationsGlobalLP", "[", 
         RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"equationnumber", ",", 
         RowBox[{"Length", "[", "equationsGlobalLP", "]"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvar", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", "\[Mu]NF"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvartimedependent", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"allvar", "[", 
         RowBox[{"[", "nvar", "]"}], "]"}], "[", "time", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"nvar", ",", 
         RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"allvarGlobalLP", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvarGlobalLP", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvarGlobalLP", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvarGlobalLPtimedependent", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"allvarGlobalLP", "[", 
         RowBox[{"[", "nvar", "]"}], "]"}], "[", "time", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"nvar", ",", 
         RowBox[{"Length", "[", "allvarGlobalLP", "]"}]}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"numberofbifurcationcurves", "=", 
     RowBox[{"Length", "[", "initialvalueTuring", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"solutioncurves", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"solutioncurvesGlobalLP", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"bifnum", "=", "1"}], ",", 
      RowBox[{"bifnum", "<=", "numberofbifurcationcurves"}], ",", 
      RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fixedparameter", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"par", ",", 
            RowBox[{
             RowBox[{"initialvalueTuring", "[", 
              RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fixedparameter", "==", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"anotherparameter", "=", "2"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"anotherparameter", "=", "1"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "eq", "]"}], "==", "1"}], " ", "||", " ", 
          RowBox[{"simpleeq", "==", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"initialvalues", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"zerodet", ",", "zeroder"}], "}"}], ",", 
                   "kinetics"}], "]"}], "==", "0"}], "/.", "fixedpar"}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "anotherparameter", "]"}], "]"}], ",", 
                   "\[Mu]NF"}], "}"}], ",", "var"}], "]"}], "//", 
               "Evaluate"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"initialvaluesGlobalLP", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", "zerodet", "}"}], ",", "kinetics"}], "]"}], "==",
                   "0"}], "/.", "fixedpar"}], "/.", 
                RowBox[{"\[Mu]NF", "->", "0"}]}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "anotherparameter", "]"}], "]"}], "}"}], ",", 
                 "var"}], "]"}], "//", "Evaluate"}]}], "]"}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"initialvalues", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"zerodet", ",", "zeroder"}], "}"}], "==", "0"}], "/.",
                  "eq"}], "/.", "fixedpar"}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "anotherparameter", "]"}], "]"}], ",", 
                 "\[Mu]NF"}], "}"}], "//", "Evaluate"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"initialvaluesGlobalLP", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"zerodet", "==", "0"}], "/.", 
                  RowBox[{"\[Mu]NF", "->", "0"}]}], "/.", "eq"}], "/.", 
                "fixedpar"}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"par", "[", 
                RowBox[{"[", "anotherparameter", "]"}], "]"}], "//", 
               "Evaluate"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialvalues", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"initialvalues", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "varnum", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "->", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"initialvalues", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "varnum", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"varnum", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"initialvalues", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"initialsolnum", ",", 
            RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"initialvalues", "=", 
        RowBox[{"DeleteDuplicates", "[", "initialvalues", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"initialsolnum", "=", "1"}], ",", 
         RowBox[{"initialsolnum", "<=", 
          RowBox[{"Length", "[", "initialvalues", "]"}]}], ",", 
         RowBox[{"initialsolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"initialvalueTuring", "[", 
               RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"simpleeq", "==", "1"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Length", "[", "eq", "]"}], ">", "1"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Quiet", " ", "@", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{"var", "\[Element]", "Reals"}], ")"}]}], "/.", 
                   "eq"}], "/.", "fixedpar"}], "/.", 
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ",", 
                RowBox[{"Continue", "[", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"initialvalues", "[", 
               RowBox[{"[", "initialsolnum", "]"}], "]"}], "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"initialvalues", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "/.", "eq"}], "/.", 
                    "fixedpar"}], "/.", 
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ")"}]}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Activate", "[", 
             RowBox[{"Inactivate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"\[Mu]NF", ",", "Choptol"}], "]"}], "!=", "0"}], 
                 " ", "&&", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"Abs", "[", 
                    RowBox[{"{", 
                    RowBox[{"zerodet", ",", "zeroder"}], "}"}], "]"}], "]"}], 
                  "<", "tol"}], " ", "&&", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "eq", "]"}], ">", "1"}], ",", 
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"var", "/.", "eq"}], ")"}], "-", "var"}], "]"}], 
                    "<", "tol"}], ",", "True"}], "]"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<=", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "anotherparameter", "]"}], "]"}], "<=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"nonzero", ",", "Choptol"}], "]"}], "!=", "0"}]}], 
                "/.", "fixedpar"}], "/.", 
               RowBox[{"initialvalues", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}]}], "]"}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dereval", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"varnum", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"initialderivatives", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"equations", "/.", 
                   RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
                  RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"dernumber", "=", "1"}], ",", 
               RowBox[{"dernumber", "<=", 
                RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
               RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equations", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equationsaux", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tempsol", "=", 
                 RowBox[{"Quiet", "@", 
                  RowBox[{"NDSolve", "[", 
                   RowBox[{"equationsaux", ",", "allvar", ",", 
                    RowBox[{"{", 
                    RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], 
                    ",", 
                    RowBox[{"Method", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<EquationSimplification\>\"", "->", 
                    "\"\<Residual\>\""}], "}"}]}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], "&&",
                    " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"solutioncurves", ",", "tempsol"}], "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initialvaluesGlobalLP", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"initialvaluesGlobalLP", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "varnum", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "->", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"initialvaluesGlobalLP", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "varnum", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"varnum", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"initialvaluesGlobalLP", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"initialsolnum", ",", 
            RowBox[{"Length", "[", "initialvaluesGlobalLP", "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialvaluesGlobalLP", "=", 
        RowBox[{"DeleteDuplicates", "[", "initialvaluesGlobalLP", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"initialsolnum", "=", "1"}], ",", 
         RowBox[{"initialsolnum", "<=", 
          RowBox[{"Length", "[", "initialvaluesGlobalLP", "]"}]}], ",", 
         RowBox[{"initialsolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{
            RowBox[{"initialvaluesGlobalLP", "[", 
             RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"initialvalueTuring", "[", 
               RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"simpleeq", "==", "1"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Length", "[", "eq", "]"}], ">", "1"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Quiet", "@", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{"var", "\[Element]", "Reals"}], ")"}]}], "/.", 
                   "eq"}], "/.", "fixedpar"}], "/.", 
                 RowBox[{"initialvaluesGlobalLP", "[", 
                  RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ",", 
                RowBox[{"Continue", "[", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"initialvaluesGlobalLP", "[", 
               RowBox[{"[", "initialsolnum", "]"}], "]"}], "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"initialvaluesGlobalLP", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "/.", "eq"}], "/.", 
                    "fixedpar"}], "/.", 
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ")"}]}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Activate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"zerodet", "/.", 
                    RowBox[{"\[Mu]NF", "->", "0"}]}], "]"}], "<", "tol"}], 
                 " ", "&&", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "eq", "]"}], ">", "1"}], ",", 
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"var", "/.", "eq"}], ")"}], "-", "var"}], "]"}], 
                    "<", "tol"}], ",", "True"}], "]"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<=", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "anotherparameter", "]"}], "]"}], "<=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "]"}], "/.", 
               "fixedpar"}], "/.", 
              RowBox[{"initialvaluesGlobalLP", "[", 
               RowBox[{"[", "initialsolnum", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dereval", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"varnum", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"initialderivatives", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"equationsGlobalLP", "/.", 
                   RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"allvarGlobalLPtimedependent", ",", "time"}], 
                   "]"}], "/.", 
                  RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"dernumber", "=", "1"}], ",", 
               RowBox[{"dernumber", "<=", 
                RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
               RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equationsGlobalLP", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equationsaux", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tempsol", "=", 
                 RowBox[{"Quiet", "@", 
                  RowBox[{"NDSolve", "[", 
                   RowBox[{"equationsaux", ",", "allvarGlobalLP", ",", 
                    RowBox[{"{", 
                    RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], 
                    ",", 
                    RowBox[{"Method", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<EquationSimplification\>\"", "->", 
                    "\"\<Residual\>\""}], "}"}]}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], " ", 
                   "&&", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"solutioncurvesGlobalLP", ",", "tempsol"}], "]"}],
                    ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&",
        " ", 
       RowBox[{
        RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{
            "{", "\"\<This script could not find a Turing bifurcation curve \
or a BD-line for your desired parameters. Try changing tolerances or initial \
values\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}]}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBmIQXfFXofwD61vH2fMO1oBom+meU0F03M7+RSDa9VT0
MjB/McN6EC2y3WgXiD6z6dhREB0QMuMCiO7U8bwEouumz/4Boo228/0G0QvM
Cv+D6BMsRswfgTSX2zJhEL33535REH3V5agsiBaxElYD0T+em5uD6LQNBWDa
5skV1U9Amrf9oAGInnGltBxEH1j+C0zPu1ns8xlIP7rk5g+imW7LRYDoQ0Wq
YPoVl2ACiGbPDMkCi1/pP8LO9tbRwXo5mD5039GVC0jvOcXlDqKvygT7gGiO
5RFgWtchamIkkE4Ucp8Joi1+cO2JBtJi67zA9I8pRkdAdFnL+pMg+pvpJOZE
ID17miQbiF4T9slpPZBWYV7pDqL1Tkj0bWB/6ygfOaEfRDec7jLdDKR/3zGx
ANFhhy+kbQfSTFnZOSD6znzdz7uA9P7LkV9ANAB5CdC7
  "],ExpressionUUID->"fdb328a8-4025-4938-acf3-217bd8eb2181"]
}, Closed]],

Cell[CellGroupData[{

Cell["Auxiliary variables", "Title",
 CellChangeTimes->{{3.895390247342123*^9, 
  3.8953902504363685`*^9}},ExpressionUUID->"59e5598c-b1a4-495f-b255-\
391127440ca6"],

Cell["\<\
If the third and/or fifth-order coefficients were already found and saved, \
this section only loads the corresponding files. Otherwise, this section \
defines the variables to make the Taylor expansion of the system\
\>", "Text",
 CellChangeTimes->{{3.89687573324382*^9, 
  3.896875807479829*^9}},ExpressionUUID->"14a70aa0-2798-4b9a-8ecd-\
60aaee713a2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coefs", "=", "\"\<y\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"nmax", ">=", "5"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
       "FileExistsQ", "[", "\"\<Third-order coefficient.mx\>\"", "]"}], " ", "&&",
        " ", 
       RowBox[{
       "FileExistsQ", "[", "\"\<Fifth-order coefficient.mx\>\"", "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"C3", "=", 
        RowBox[{"Import", "[", "\"\<Third-order coefficient.mx\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"C5", "=", 
        RowBox[{"Import", "[", "\"\<Fifth-order coefficient.mx\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"coefs", "=", "\"\<n\>\""}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FileExistsQ", "[", "\"\<Third-order coefficient.mx\>\"", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C3", "=", 
       RowBox[{"Import", "[", "\"\<Third-order coefficient.mx\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"coefs", "=", "\"\<n\>\""}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"conjpar", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
           RowBox[{"parval", "[", 
            RowBox[{"[", "parnum", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"parval", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"parnum", ",", 
          RowBox[{"Length", "[", "parval", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conjpar", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"conjpar", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"fixedpar", "[", 
              RowBox[{"[", "parnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"fixedpar", "[", 
             RowBox[{"[", "parnum", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"parnum", ",", 
            RowBox[{"Length", "[", "fixedpar", "]"}]}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"conjpar", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"conjpar", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", "\[Mu]NF", "]"}], "->", "\[Mu]NF"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "[", "kNF", "]"}], "->", "kNF"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"conjpar", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"conjpar", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"var", "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "]"}], "->", 
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["sol", 
       RowBox[{"0", ",", "0"}]], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["W", 
           RowBox[{"0", ",", "0", ",", "varnum"}]], "[", "X", "]"}], "->", 
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["dersol", 
      RowBox[{"0", ",", "0"}]], "=", 
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["sol", 
        RowBox[{"0", ",", "0"}]], ",", "X"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["der2sol", 
      RowBox[{"0", ",", "0"}]], "=", 
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["dersol", 
        RowBox[{"0", ",", "0"}]], ",", "X"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "1"}], ",", 
      RowBox[{"order", "<=", "5"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"sub", "=", "0"}], ",", 
        RowBox[{"sub", "<=", "5"}], ",", 
        RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"EvenQ", "[", "order", "]"}], "&&", " ", 
             RowBox[{"\[Not]", 
              RowBox[{"EvenQ", "[", "sub", "]"}]}]}], ")"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Not]", 
              RowBox[{"EvenQ", "[", "order", "]"}]}], " ", "&&", " ", 
             RowBox[{"EvenQ", "[", "sub", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SubscriptBox["sol", 
             RowBox[{"order", ",", "sub"}]], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["W", 
                 RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                "]"}], "->", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["dersol", 
             RowBox[{"order", ",", "sub"}]], "=", 
            RowBox[{"D", "[", 
             RowBox[{
              SubscriptBox["sol", 
               RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["der2sol", 
             RowBox[{"order", ",", "sub"}]], "=", 
            RowBox[{"D", "[", 
             RowBox[{
              SubscriptBox["dersol", 
               RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"jacobianmat", "=", 
     RowBox[{"jacobianmat", "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"jacobianmatr", "=", 
     RowBox[{
      RowBox[{"jacmat", "-", 
       RowBox[{
        SuperscriptBox["mul", "2"], "*", "\[Mu]NF", "*", "diffmatrix"}]}], "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Psi]", "=", 
     RowBox[{"\[Psi]", "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["sol", 
      RowBox[{"1", ",", "1"}]], "=", 
     RowBox[{
      SubscriptBox["sol", 
       RowBox[{"1", ",", "1"}]], "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["dersol", 
      RowBox[{"1", ",", "1"}]], "=", 
     RowBox[{
      SubscriptBox["dersol", 
       RowBox[{"1", ",", "1"}]], "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["der2sol", 
      RowBox[{"1", ",", "1"}]], "=", 
     RowBox[{
      SubscriptBox["der2sol", 
       RowBox[{"1", ",", "1"}]], "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"conjprime", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "'"}], "[", "y_", "]"}], "->", 
       RowBox[{"HoldForm", "[", 
        FractionBox[
         RowBox[{"Conjugate", "[", 
          RowBox[{"D", "[", 
           RowBox[{"y", ",", "X"}], "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{"y", ",", "X"}], "]"}]], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"absprime", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "'"}], "[", "y_", "]"}], "->", 
       RowBox[{"HoldForm", "[", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"y", ",", "X"}], "]"}], "*", 
           RowBox[{"Conjugate", "[", "y", "]"}]}], "+", 
          RowBox[{"y", "*", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"D", "[", 
             RowBox[{"y", ",", "X"}], "]"}], "]"}]}]}], 
         RowBox[{"2", "*", 
          RowBox[{"D", "[", 
           RowBox[{"y", ",", "X"}], "]"}], "*", 
          RowBox[{"Abs", "[", "y", "]"}]}]], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"toexpand", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox[
                  RowBox[{
                  "var", "\[LeftDoubleBracket]", "varnum", 
                   "\[RightDoubleBracket]"}], "order"], "[", 
                 RowBox[{"x", ",", "X"}], "]"}], "\[Rule]", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"sub", "=", 
                   RowBox[{"-", "order"}]}], "order"], 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                   "]"}], " ", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                   "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", "x"}]]}]}]}],
                "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "index"}], ",", "varnum"}]], "[", "X", "]"}],
                   "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "index", ",", "varnum"}]], "[", "X",
                     "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"index", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["sol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["sol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["sol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["sol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["sol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["sol", 
       RowBox[{"4", ",", "3"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"toexpandderxx", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox[
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "varnum", 
                    "\[RightDoubleBracket]"}], "order"], "[", 
                   RowBox[{"x", ",", "X"}], "]"}], ",", "x", ",", "x"}], 
                 "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"-", 
                  SuperscriptBox["kNF", "2"]}], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"sub", "=", 
                    RowBox[{"-", "order"}]}], "order"], 
                  RowBox[{
                   SuperscriptBox["sub", "2"], "*", 
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                    "]"}], " ", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", 
                    "x"}]]}]}]}]}], "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "index"}], ",", "varnum"}]], "[", "X", "]"}],
                   "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "index", ",", "varnum"}]], "[", "X",
                     "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"index", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["sol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["sol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["sol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["sol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["sol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["sol", 
       RowBox[{"4", ",", "3"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"toexpandderXx", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox[
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "varnum", 
                    "\[RightDoubleBracket]"}], "order"], "[", 
                   RowBox[{"x", ",", "X"}], "]"}], ",", "X", ",", "x"}], 
                 "]"}], "\[Rule]", 
                RowBox[{"\[ImaginaryI]", "*", "kNF", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"sub", "=", 
                    RowBox[{"-", "order"}]}], "order"], 
                  RowBox[{"sub", "*", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "'"}], "[",
                     "X", "]"}], " ", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", 
                    "x"}]]}]}]}]}], "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "index"}], ",", "varnum"}]], "'"}], "[", "X",
                    "]"}], "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "index", ",", "varnum"}]], "'"}], 
                    "[", "X", "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"index", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["dersol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["dersol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["dersol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["dersol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["dersol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["dersol", 
       RowBox[{"4", ",", "3"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"toexpandderXX", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox[
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "varnum", 
                    "\[RightDoubleBracket]"}], "order"], "[", 
                   RowBox[{"x", ",", "X"}], "]"}], ",", "X", ",", "X"}], 
                 "]"}], "\[Rule]", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"sub", "=", 
                   RowBox[{"-", "order"}]}], "order"], 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "''"}], 
                   "[", "X", "]"}], " ", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                   "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", "x"}]]}]}]}],
                "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "index"}], ",", "varnum"}]], "''"}], "[", 
                   "X", "]"}], "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "index", ",", "varnum"}]], "''"}], 
                    "[", "X", "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"index", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["der2sol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["der2sol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["der2sol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["der2sol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["der2sol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["der2sol", 
       RowBox[{"4", ",", "3"}]]}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8910075082946806`*^9, 3.8910075228152714`*^9}, {
   3.8910075706375017`*^9, 3.891007689903224*^9}, {3.8910077460377865`*^9, 
   3.89100774930982*^9}, {3.891007781849799*^9, 3.891007853468502*^9}, {
   3.891008017415059*^9, 3.891008151150443*^9}, {3.891008309202035*^9, 
   3.8910083581326866`*^9}, {3.891008492978525*^9, 3.8910085112878*^9}, {
   3.8910114915883617`*^9, 3.8910114920076375`*^9}, {3.89101165773881*^9, 
   3.891011664017143*^9}, {3.891012046920682*^9, 3.891012074440398*^9}, {
   3.891012184596204*^9, 3.8910122163935204`*^9}, {3.8912780055534644`*^9, 
   3.8912780076960373`*^9}, {3.8912781218703036`*^9, 
   3.8912781221263046`*^9}, {3.891278194962117*^9, 3.8912782303170443`*^9}, {
   3.891278773046852*^9, 3.8912788436643534`*^9}, {3.8912791446026573`*^9, 
   3.891279188314161*^9}, {3.8912793497010527`*^9, 3.8912793594701085`*^9}, {
   3.8912794172856817`*^9, 3.891279423112281*^9}, {3.891281897496488*^9, 
   3.891281897817503*^9}, {3.89136248810867*^9, 3.891362502184837*^9}, {
   3.8913645114700565`*^9, 3.8913645152918234`*^9}, {3.891367278640957*^9, 
   3.891367311495427*^9}, {3.8914130421374617`*^9, 3.8914130425740347`*^9}, {
   3.8914135362760963`*^9, 3.8914135365610948`*^9}, {3.8914137076765785`*^9, 
   3.891413741796623*^9}, {3.891416307164044*^9, 3.8914163075049815`*^9}, {
   3.891431515366051*^9, 3.8914315265106297`*^9}, {3.8914337264079776`*^9, 
   3.8914337268015714`*^9}, {3.8914376763669553`*^9, 
   3.8914376981032567`*^9}, {3.8914411070760384`*^9, 3.891441136546509*^9}, {
   3.8914413822835703`*^9, 3.8914413825704365`*^9}, {3.8915051980182953`*^9, 
   3.8915052271374483`*^9}, {3.891520166658786*^9, 3.8915201671307216`*^9}, {
   3.8915324782089343`*^9, 3.891532527759901*^9}, {3.895235584088151*^9, 
   3.895235630890587*^9}, {3.8952360909410243`*^9, 3.895236171829955*^9}, {
   3.895237288409603*^9, 3.8952372889664936`*^9}, {3.895241359118166*^9, 
   3.895241409028061*^9}, {3.8952417993318014`*^9, 3.89524183646583*^9}, {
   3.895387170081184*^9, 3.895387182519307*^9}, {3.8953898661484537`*^9, 
   3.8953898856723824`*^9}, {3.8953899194144177`*^9, 
   3.8953899197517204`*^9}, {3.8953905885563765`*^9, 3.895390607315241*^9}, {
   3.895391450865588*^9, 3.8953919242326593`*^9}, 3.895391985075384*^9, {
   3.8953920211990776`*^9, 3.8953920213375607`*^9}, {3.8953933668274937`*^9, 
   3.8953933801894655`*^9}, {3.8953955006391563`*^9, 3.895395563968426*^9}, {
   3.8953968363902445`*^9, 3.8953968801065164`*^9}, {3.8954257449541216`*^9, 
   3.8954257480811863`*^9}, {3.8956433566674643`*^9, 
   3.8956433943818407`*^9}, {3.8956437465872154`*^9, 3.895643807006666*^9}, {
   3.895644396848751*^9, 3.8956445458389225`*^9}, {3.895645045137765*^9, 
   3.8956450784398155`*^9}, {3.8956451094188623`*^9, 3.895645279526049*^9}, {
   3.8956457387859163`*^9, 3.895645821088733*^9}, {3.8956459070171146`*^9, 
   3.895646290172578*^9}, {3.8956471644067316`*^9, 3.895647165409175*^9}, {
   3.895647215957505*^9, 3.8956472201018324`*^9}, 3.8956586185623446`*^9, 
   3.895659105957363*^9, {3.895818642104947*^9, 3.895818642857977*^9}, {
   3.8958364306277103`*^9, 3.8958364312688327`*^9}, {3.896978202783913*^9, 
   3.89697820375253*^9}, {3.896981413824418*^9, 3.8969814142464595`*^9}, {
   3.8969822643910036`*^9, 3.896982280329732*^9}, {3.8969866438788176`*^9, 
   3.8969866540083656`*^9}, {3.8969871294289417`*^9, 
   3.896987170791191*^9}},ExpressionUUID->"badd11d8-df7e-46a4-8c64-\
95e5572ef76a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Taylor expansion", "Title",
 CellChangeTimes->{{3.8910073887548065`*^9, 3.891007390926674*^9}, {
  3.8910074344942245`*^9, 3.8910074359215517`*^9}, {3.891007515161849*^9, 
  3.891007516479077*^9}, {3.891008916433653*^9, 3.891008955749086*^9}, {
  3.891280453469096*^9, 3.8912804539701233`*^9}, {3.8915177889106903`*^9, 
  3.891517795162298*^9}, {3.8952372661344137`*^9, 3.89523726799854*^9}, {
  3.8952373039945*^9, 3.895237320623995*^9}, {3.8952385424550734`*^9, 
  3.895238543013917*^9}, {3.8953902584084578`*^9, 
  3.8953902709160185`*^9}},ExpressionUUID->"975f7379-5e89-4c9d-9c35-\
2517707099ec"],

Cell["\<\
Mathematica computes the Taylor expansion of the system up to order nmax\
\>", "Text",
 CellChangeTimes->{{3.896875836206487*^9, 
  3.8968758511092*^9}},ExpressionUUID->"a0fefe8f-2f26-4637-bafc-edd7bea0a157"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expr", "=", 
     RowBox[{"kinetics", "/.", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}], "->", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"order", "=", "0"}], "nmax"], 
          RowBox[{
           SuperscriptBox["\[Epsilon]NF", "order"], "*", 
           RowBox[{
            SubscriptBox[
             RowBox[{"var", "[", 
              RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
            RowBox[{"x", ",", "X"}], "]"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"expansion", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "1"}], ",", 
      RowBox[{"order", "<=", "nmax"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"expansion", ",", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"order", "!"}]], 
           RowBox[{"D", "[", 
            RowBox[{"expr", ",", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]NF", ",", "order"}], "}"}]}], "]"}]}], "/.", 
          RowBox[{"\[Epsilon]NF", "->", "0"}]}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8906785957145324`*^9, 3.890678609403802*^9}, {
  3.8906787105192423`*^9, 3.890678711054577*^9}, {3.890678776838481*^9, 
  3.8906789625892935`*^9}, {3.89067904003786*^9, 3.89067906663437*^9}, {
  3.891011486353433*^9, 3.891011487715682*^9}, {3.8953902601780715`*^9, 
  3.895390261127928*^9}, {3.8956445610139427`*^9, 3.8956445900903425`*^9}, {
  3.89564629823055*^9, 3.8956463281548204`*^9}, {3.8958430822551403`*^9, 
  3.8958430910459814`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"2e32b0e0-a41c-4002-a99b-e9daae978379"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ansatz expansion", "Title",
 CellChangeTimes->{{3.895390281334725*^9, 
  3.8953902927520714`*^9}},ExpressionUUID->"31009231-e5e1-4bd5-b49d-\
53ebf474df13"],

Cell["\<\
Addition of the linear operator to the expansion of the reaction\
\>", "Text",
 CellChangeTimes->{{3.89687604221647*^9, 
  3.896876070671256*^9}},ExpressionUUID->"9ef0a0d4-5957-4304-b51d-\
4fa62a57d438"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"equations", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "1"}], ",", 
      RowBox[{"order", "<=", "nmax"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"order", "<=", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"equations", ",", 
           RowBox[{
            RowBox[{"expansion", "[", 
             RowBox[{"[", "order", "]"}], "]"}], "+", 
            RowBox[{"Dot", "[", 
             RowBox[{"diffmatrix", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{"x", ",", "x"}]], 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
                  RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}]}]}],
           "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"3", "<=", "order", "<=", "4"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"equations", ",", 
             RowBox[{
              RowBox[{"expansion", "[", 
               RowBox[{"[", "order", "]"}], "]"}], "+", 
              RowBox[{"Dot", "[", 
               RowBox[{"diffmatrix", ",", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "x"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "+", 
                 RowBox[{"2", "*", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "X"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], 
                    RowBox[{"order", "-", "2"}]], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}]}], 
               "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"equations", ",", 
             RowBox[{
              RowBox[{"expansion", "[", 
               RowBox[{"[", "order", "]"}], "]"}], "+", 
              RowBox[{"Dot", "[", 
               RowBox[{"diffmatrix", ",", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "x"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "+", 
                 RowBox[{"2", "*", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "X"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], 
                    RowBox[{"order", "-", "2"}]], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "+", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"X", ",", "X"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], 
                    RowBox[{"order", "-", "4"}]], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], 
               "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8906791447797537`*^9, 3.890679343841946*^9}, {
   3.890679378735796*^9, 3.890679438306658*^9}, {3.8906794761291485`*^9, 
   3.8906796054668407`*^9}, {3.8906800011264915`*^9, 
   3.8906801277077518`*^9}, {3.8906802622761917`*^9, 3.890680278573492*^9}, {
   3.8906805125437913`*^9, 3.8906805224712844`*^9}, {3.8906807449302835`*^9, 
   3.8906808237528253`*^9}, {3.890680891412051*^9, 3.8906810999806385`*^9}, {
   3.891007076654664*^9, 3.8910070774451733`*^9}, {3.8910114394876986`*^9, 
   3.8910114495627565`*^9}, {3.891412511472025*^9, 3.89141251316732*^9}, {
   3.891435688412567*^9, 3.891435688740713*^9}, {3.8953902012661343`*^9, 
   3.895390202476407*^9}, 3.8953923005432415`*^9, {3.8956446055515337`*^9, 
   3.895644667269793*^9}, {3.8956463128668165`*^9, 3.895646322060215*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"751cb34e-5132-4079-9042-ce30049ea319"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving equations at each order", "Title",
 CellChangeTimes->{{3.8953903043084345`*^9, 
  3.8953903089576807`*^9}},ExpressionUUID->"5a3a3e1d-f27d-43c0-b2b2-\
1e5928aa479d"],

Cell["\<\
Mathematica solves the equation at each order to find the symbolic \
coefficients\
\>", "Text",
 CellChangeTimes->{{3.8968760866469383`*^9, 3.8968760903322105`*^9}, {
  3.896876163011267*^9, 
  3.896876197654064*^9}},ExpressionUUID->"1415cb93-4b04-4cb2-959b-\
6a17fceb7fdb"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solvcond", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"solvcond", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "2"}], ",", 
      RowBox[{"order", "<=", "nmax"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "order", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"solvcond", ",", "0"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"equation", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"equations", "[", 
             RowBox[{"[", "order", "]"}], "]"}], "/.", "toexpand"}], "/.", 
           "toexpandderxx"}], "/.", "toexpandderXx"}], "/.", 
         "toexpandderXX"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"sub", "=", "0"}], ",", 
         RowBox[{"sub", "<=", "order"}], ",", 
         RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"EvenQ", "[", "order", "]"}], "&&", " ", 
               RowBox[{"\[Not]", " ", 
                RowBox[{"EvenQ", "[", "sub", "]"}]}]}], ")"}], " ", "||", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Not]", " ", 
                RowBox[{"EvenQ", "[", "order", "]"}]}], " ", "&&", " ", 
               RowBox[{"EvenQ", "[", "sub", "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"order", "==", "nmax"}], " ", "&&", " ", 
             RowBox[{"sub", "!=", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"order", "==", "4"}], " ", "&&", " ", 
             RowBox[{"sub", ">", "2"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"auxeq", "=", 
           RowBox[{
            RowBox[{
             FractionBox["kNF", 
              RowBox[{"2", "\[Pi]"}]], 
             RowBox[{
              SubsuperscriptBox["\[Integral]", "0", 
               FractionBox[
                RowBox[{"2", "\[Pi]"}], "kNF"]], 
              RowBox[{"equation", "*", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "\[ImaginaryI]"}], "*", "sub", "*", "kNF", "*", 
                 "x"}]], 
               RowBox[{"\[DifferentialD]", "x"}]}]}]}], "//", "Simplify"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"auxeq", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "auxeq"}], "/.", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["W", 
                  RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                 "]"}], "->", "0"}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "//", 
            "Simplify"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"order", "!=", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"sub", "!=", "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"auxsol", "=", 
                 RowBox[{"LinearSolve", "[", 
                  RowBox[{"dummymat", ",", "dummyvec"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"auxsol", "=", 
                 RowBox[{
                  RowBox[{"auxsol", "/.", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"dummymat", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}], "->", 
                    RowBox[{"jacobianmatr", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}]}], "/.", 
                    RowBox[{"mul", "->", "sub"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"row", ",", "nvar"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}], "]"}]}], "/.", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dummyvec", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"auxeq", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["sol", 
                  RowBox[{"order", ",", "sub"}]], "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                    "]"}], "->", 
                    RowBox[{"auxsol", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"solvcond", ",", 
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"Dot", "[", 
                    RowBox[{"auxeq", ",", "\[Psi]"}], "]"}], 
                    RowBox[{"Dot", "[", 
                    RowBox[{"\[Phi]", ",", "\[Psi]"}], "]"}]]}]}], "]"}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"order", "!=", "nmax"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"usefulvec", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["auxvec", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"auxsol", "=", 
                    RowBox[{"LinearSolve", "[", 
                    RowBox[{
                    RowBox[{"dummymat", "[", 
                    RowBox[{"[", 
                    RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"dummyvec", "[", 
                    RowBox[{"[", "submatrixcols", "]"}], "]"}]}], "]"}]}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"auxsol", "=", 
                    RowBox[{
                    RowBox[{"auxsol", "/.", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dummymat", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}], "->", 
                    RowBox[{"jacobianmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"row", ",", "nvar"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}], "]"}]}], "/.", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dummyvec", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"auxeq", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"usefulvec", "[", 
                    RowBox[{"[", "submatrixcols", "]"}], "]"}], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", 
                    RowBox[{"submatrixcols", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}]], "[", "X", "]"}], "->", 
                    RowBox[{"auxsol", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"nvar", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"usefulvec", "[", 
                    RowBox[{"[", "criticalcol", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "criticalcol"}]], "[", 
                    "X", "]"}], "->", "0"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["sol", 
                    RowBox[{"order", ",", "sub"}]], "=", "usefulvec"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["dersol", 
               RowBox[{"order", ",", "sub"}]], "=", 
              RowBox[{"ReleaseHold", "[", 
               RowBox[{
                RowBox[{"ReleaseHold", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    SubscriptBox["sol", 
                    RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}], "/.", 
                  "conjprime"}], "]"}], "/.", "absprime"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["der2sol", 
               RowBox[{"order", ",", "sub"}]], "=", 
              RowBox[{"ReleaseHold", "[", 
               RowBox[{
                RowBox[{"ReleaseHold", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    SubscriptBox["dersol", 
                    RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}], "/.", 
                  "conjprime"}], "]"}], "/.", "absprime"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8912782820412655`*^9, 3.8912783111581135`*^9}, {
   3.8912784377134094`*^9, 3.891278443135502*^9}, {3.891278547331915*^9, 
   3.8912785888709354`*^9}, {3.8912787467529783`*^9, 3.891278749711026*^9}, {
   3.891278884536026*^9, 3.8912789916188087`*^9}, {3.8912790229653907`*^9, 
   3.89127906433963*^9}, {3.8912792188225007`*^9, 3.8912792198615007`*^9}, {
   3.8912794585216045`*^9, 3.8912794593986015`*^9}, {3.8912805880085635`*^9, 
   3.891280684080511*^9}, {3.8912807150591526`*^9, 3.8912807153991485`*^9}, {
   3.891280936699304*^9, 3.8912811108317165`*^9}, {3.8912812803294473`*^9, 
   3.8912813268544416`*^9}, {3.891281426236225*^9, 3.891281427969783*^9}, {
   3.8912815336214547`*^9, 3.891281639249179*^9}, {3.8912818701198297`*^9, 
   3.8912818713888297`*^9}, {3.8912819208155813`*^9, 
   3.8912819218095827`*^9}, {3.8912822076171083`*^9, 3.891282318313404*^9}, {
   3.8912825751115723`*^9, 3.8912826212847123`*^9}, {3.8912826546672583`*^9, 
   3.8912827145909233`*^9}, {3.8912828335963106`*^9, 
   3.8912828475783844`*^9}, {3.8913597954389353`*^9, 
   3.8913597978244534`*^9}, {3.891360330784241*^9, 3.8913603596211195`*^9}, {
   3.891360394197403*^9, 3.891360585624901*^9}, 3.8913606412383013`*^9, {
   3.89136104632998*^9, 3.8913610734971437`*^9}, {3.891361381676696*^9, 
   3.8913613906487255`*^9}, {3.8913621324210224`*^9, 3.891362229178543*^9}, {
   3.8913623344309015`*^9, 3.8913623436758027`*^9}, {3.8913625553554554`*^9, 
   3.8913625559284544`*^9}, {3.8913626078647614`*^9, 3.891362654793866*^9}, {
   3.891362715307205*^9, 3.8913627557212315`*^9}, {3.891362811221194*^9, 
   3.8913628542578225`*^9}, {3.891362940667872*^9, 3.891362999093012*^9}, {
   3.8913630898132877`*^9, 3.8913630901710696`*^9}, {3.8913632512516766`*^9, 
   3.8913632663831987`*^9}, {3.891363317248144*^9, 3.891363333514456*^9}, {
   3.8913633991670904`*^9, 3.8913634050460224`*^9}, {3.8913636663207836`*^9, 
   3.891363680134602*^9}, {3.8913637145884824`*^9, 3.8913637379783926`*^9}, 
   3.8913638270912437`*^9, {3.8913649928255935`*^9, 3.8913649931821613`*^9}, {
   3.8913654030721235`*^9, 3.8913654040671744`*^9}, {3.891367716953764*^9, 
   3.8913677221237383`*^9}, {3.89136782317605*^9, 3.8913678236042204`*^9}, {
   3.891367885566408*^9, 3.891367888664566*^9}, {3.8913679499782033`*^9, 
   3.891367971310688*^9}, {3.8914120375132008`*^9, 3.891412094986128*^9}, {
   3.891413268910467*^9, 3.8914132726870594`*^9}, {3.891414023563636*^9, 
   3.8914140262890253`*^9}, {3.8914140893393936`*^9, 
   3.8914142612164865`*^9}, {3.891414297934016*^9, 3.8914143301329975`*^9}, {
   3.891414389180242*^9, 3.8914145836630306`*^9}, {3.8914146560237517`*^9, 
   3.8914146614727545`*^9}, {3.891414770984223*^9, 3.8914147763257947`*^9}, {
   3.8914148073470697`*^9, 3.8914148208622484`*^9}, {3.891414860723753*^9, 
   3.891414860999753*^9}, {3.891414952547634*^9, 3.8914150775504436`*^9}, {
   3.891415125237281*^9, 3.891415216515827*^9}, {3.8914153285519023`*^9, 
   3.8914153681869173`*^9}, {3.8914154624744463`*^9, 3.891415527370666*^9}, {
   3.891415661139343*^9, 3.8914157039301195`*^9}, {3.8914159487332935`*^9, 
   3.891415950212698*^9}, {3.891415984105797*^9, 3.8914160079108534`*^9}, {
   3.8914161656298094`*^9, 3.891416213046152*^9}, {3.891416625295349*^9, 
   3.891416635596052*^9}, {3.8914229218997636`*^9, 3.8914229499401245`*^9}, {
   3.89142341798869*^9, 3.8914234228096504`*^9}, {3.8914237507109375`*^9, 
   3.8914237798933787`*^9}, {3.8914238113235064`*^9, 3.891423851109641*^9}, {
   3.891431260440771*^9, 3.8914313209382906`*^9}, {3.8914316657846155`*^9, 
   3.8914316696687536`*^9}, {3.891431960817112*^9, 3.891431962101017*^9}, {
   3.8914331017937126`*^9, 3.8914331398788943`*^9}, {3.8914358792440586`*^9, 
   3.891435885571937*^9}, {3.8914373217754726`*^9, 3.89143737285233*^9}, {
   3.8914378120762835`*^9, 3.891437841168311*^9}, {3.8914384295278845`*^9, 
   3.891438485090257*^9}, {3.891439668887679*^9, 3.891439694809305*^9}, {
   3.8915254782568507`*^9, 3.8915254800623455`*^9}, {3.891861080858152*^9, 
   3.8918610850888844`*^9}, {3.891880980796477*^9, 3.891880981846337*^9}, 
   3.8952389171276217`*^9, {3.895386693938452*^9, 3.895386709906249*^9}, 
   3.895387135780505*^9, {3.89538733045947*^9, 3.8953873313278723`*^9}, {
   3.8953874439392195`*^9, 3.895387472823164*^9}, {3.8953886634166393`*^9, 
   3.895388672060294*^9}, {3.895388965816328*^9, 3.895388991205279*^9}, {
   3.8953892095953755`*^9, 3.8953893127219553`*^9}, {3.8953893975602894`*^9, 
   3.8953894049376087`*^9}, {3.895390869137729*^9, 3.895390877633423*^9}, {
   3.8953912939928827`*^9, 3.8953912941087017`*^9}, {3.89539240555837*^9, 
   3.8953924060524006`*^9}, {3.8953925959865284`*^9, 3.895392602446885*^9}, {
   3.895392719176372*^9, 3.895392794091338*^9}, {3.895395301884531*^9, 
   3.8953953824839306`*^9}, {3.895396729801237*^9, 3.8953967501278334`*^9}, {
   3.8953970110206327`*^9, 3.895397019191662*^9}, {3.8953973833150415`*^9, 
   3.8953973834903526`*^9}, {3.895427323722612*^9, 3.895427337797324*^9}, {
   3.895481074434719*^9, 3.895481074714653*^9}, {3.895643822710439*^9, 
   3.895643831466565*^9}, {3.8956446825851464`*^9, 3.8956448012286882`*^9}, {
   3.8956453241579204`*^9, 3.895645417297291*^9}, {3.8956463340940247`*^9, 
   3.8956463462501907`*^9}, 3.8956980341804876`*^9, {3.895759629460738*^9, 
   3.895759629992372*^9}, {3.895760009026192*^9, 3.895760009460331*^9}, {
   3.895818656147724*^9, 3.895818656857855*^9}, {3.8969818518012753`*^9, 
   3.8969819146601405`*^9}, {3.8969823003510447`*^9, 
   3.8969823570997996`*^9}},ExpressionUUID->"5a683087-6769-48aa-a98b-\
e2a85730a676"]
}, Closed]],

Cell[CellGroupData[{

Cell["Getting coefficients", "Title",
 CellChangeTimes->{{3.895390348620699*^9, 3.895390351819915*^9}, {
  3.8969647630835314`*^9, 3.896964763411282*^9}, {3.896978745939216*^9, 
  3.8969787539730344`*^9}, {3.896991348668049*^9, 3.896991348986017*^9}, {
  3.8969920861948833`*^9, 
  3.896992086478943*^9}},ExpressionUUID->"b720bbc5-22a5-423a-bc30-\
2c9c18f99b35"],

Cell[TextData[{
 "Mathematica extracts the third and fifth-order coefficients from the \
previous expansion.Also, Mathematica finds the coefficients ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Alpha]", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1c5345f7-0a35-4c7d-ae45-1213626b5d6e"],
 " that determine the equation the amplitude solves at a codimension-two point"
}], "Text",
 CellChangeTimes->{{3.8968762104715314`*^9, 3.8968762359741545`*^9}, {
  3.8968762702631063`*^9, 3.896876270463159*^9}, {3.8968763144780784`*^9, 
  3.896876362736129*^9}},ExpressionUUID->"246e49dc-2627-4f96-b123-\
14166c8ea7ee"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C3", "=", 
     RowBox[{"solvcond", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "2"}], ",", 
      RowBox[{"order", ">=", "0"}], ",", 
      RowBox[{"order", "--"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"sub", "=", "0"}], ",", 
        RowBox[{"sub", "<=", "order"}], ",", 
        RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"C3", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"C3", "/.", 
             SubscriptBox["sol", 
              RowBox[{"order", ",", "sub"}]]}], "/.", 
            SubscriptBox["dersol", 
             RowBox[{"order", ",", "sub"}]]}], "/.", 
           SubscriptBox["der2sol", 
            RowBox[{"order", ",", "sub"}]]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"C3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"C3", "/.", "conjpar"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "->", "0"}]}], "/.", 
      RowBox[{
       RowBox[{
        SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<Third-order coefficient.mx\>\"", ",", "C3"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"nmax", ">=", "5"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"C5", "=", 
        RowBox[{"solvcond", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"order", "=", "4"}], ",", 
         RowBox[{"order", ">=", "0"}], ",", 
         RowBox[{"order", "--"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"sub", "=", "0"}], ",", 
           RowBox[{"sub", "<=", "order"}], ",", 
           RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"order", "==", "4"}], " ", "&&", " ", 
               RowBox[{"sub", ">", "2"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"C5", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"C5", "/.", 
                SubscriptBox["sol", 
                 RowBox[{"order", ",", "sub"}]]}], "/.", 
               SubscriptBox["dersol", 
                RowBox[{"order", ",", "sub"}]]}], "/.", 
              SubscriptBox["der2sol", 
               RowBox[{"order", ",", "sub"}]]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"alphaval", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"C5", "=", 
           RowBox[{
            RowBox[{"FunctionExpand", "[", "C5", "]"}], "/.", "conjpar"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Alpha]NF", "1"], "=", 
           RowBox[{
            RowBox[{"C5", "/.", 
             RowBox[{
              RowBox[{
               SubscriptBox["A", "1"], "[", "X", "]"}], "->", "0"}]}], "/.", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["A", "1"], "''"}], "[", "X", "]"}], "->", 
             "1"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"C5", "=", 
           RowBox[{"C5", "/.", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["A", "1"], "''"}], "[", "X", "]"}], "->", 
             "0"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Alpha]NF", "2"], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Coefficient", "[", 
                RowBox[{
                 RowBox[{"C5", "/.", 
                  RowBox[{
                   RowBox[{"Conjugate", "[", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "]"}], "->",
                    "0"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["A", "1"], "'"}], "[", "X", "]"}]}], "]"}], "/.", 
               RowBox[{
                RowBox[{
                 SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}], 
              ")"}]}], "/.", "conjpar"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Alpha]NF", "3"], "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], "*", 
              RowBox[{"Coefficient", "[", 
               RowBox[{"C5", ",", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "]"}]}], 
               "]"}]}], "/.", 
             RowBox[{
              RowBox[{
               SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}], "/.", 
            "conjpar"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"C5", "=", 
           RowBox[{
            RowBox[{"C5", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "->", "0"}]}],
             "/.", 
            RowBox[{
             RowBox[{
              SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"\"\<alpha1.mx\>\"", ",", 
            SubscriptBox["\[Alpha]NF", "1"]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"\"\<alpha2.mx\>\"", ",", 
            SubscriptBox["\[Alpha]NF", "2"]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"\"\<alpha3.mx\>\"", ",", 
            SubscriptBox["\[Alpha]NF", "3"]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"C5", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"C5", "/.", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["A", "1"], "''"}], "[", "X", "]"}], "->", 
               "0"}]}], "/.", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "->", "0"}]}],
             "/.", 
            RowBox[{
             RowBox[{
              SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<Fifth-order coefficient.mx\>\"", ",", "C5"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8914376241605654`*^9, 3.891437625671474*^9}, 
   3.8914382911451178`*^9, {3.8914388897827864`*^9, 3.891439065182951*^9}, {
   3.891439119608291*^9, 3.891439168326683*^9}, {3.8914392353822303`*^9, 
   3.891439238500129*^9}, {3.891439560881304*^9, 3.891439565447703*^9}, {
   3.8914400015391097`*^9, 3.891440019625805*^9}, {3.8914403390958195`*^9, 
   3.8914403516674366`*^9}, {3.8914503903976126`*^9, 
   3.8914504018431015`*^9}, {3.8915013270022745`*^9, 3.891501330139021*^9}, {
   3.8915022961652966`*^9, 3.891502359730925*^9}, {3.891502469505395*^9, 
   3.8915024719227877`*^9}, {3.8915026141559153`*^9, 
   3.8915026503921366`*^9}, {3.891502714836328*^9, 3.8915027182923822`*^9}, {
   3.891502760885398*^9, 3.8915027844538755`*^9}, {3.8915028902000794`*^9, 
   3.8915028969473505`*^9}, {3.8915029384217854`*^9, 
   3.8915029648688636`*^9}, {3.891503052754713*^9, 3.8915030588663254`*^9}, {
   3.891505260377139*^9, 3.891505293340233*^9}, {3.8915064733065796`*^9, 
   3.8915065087743053`*^9}, {3.891508234492185*^9, 3.8915082502339034`*^9}, {
   3.891508472614611*^9, 3.8915084755185566`*^9}, {3.8915325670930986`*^9, 
   3.8915325770378704`*^9}, {3.89188095188918*^9, 3.891880952091041*^9}, {
   3.891884474856989*^9, 3.8918844757016673`*^9}, {3.8952373955893164`*^9, 
   3.895237396042495*^9}, {3.895237865421593*^9, 3.8952378690960236`*^9}, 
   3.8952382192690163`*^9, {3.895241558859524*^9, 3.8952415837353716`*^9}, {
   3.8952418549496403`*^9, 3.895241859580656*^9}, {3.89538783589052*^9, 
   3.8953878858010006`*^9}, {3.8953882186605673`*^9, 
   3.8953882296697774`*^9}, {3.8953976961694365`*^9, 
   3.8953977172602215`*^9}, {3.895397761957958*^9, 3.895397762277561*^9}, {
   3.8953978074834905`*^9, 3.895397933607459*^9}, {3.8953980014624505`*^9, 
   3.8953984672575445`*^9}, {3.895398504039594*^9, 3.895398527169013*^9}, {
   3.8953986402722783`*^9, 3.895398675379572*^9}, {3.8953987079759316`*^9, 
   3.895398728270647*^9}, 3.895398884226127*^9, {3.8953994783501787`*^9, 
   3.895399481227302*^9}, {3.8953995321779966`*^9, 3.8953995382616615`*^9}, {
   3.8953998690952263`*^9, 3.895399896780435*^9}, {3.8954254166535406`*^9, 
   3.8954254181848574`*^9}, {3.895425454771001*^9, 3.895425507004882*^9}, {
   3.895425773777924*^9, 3.8954258414560623`*^9}, {3.8954336902439423`*^9, 
   3.895433701819147*^9}, {3.895434167089511*^9, 3.895434171103548*^9}, {
   3.8956454298322716`*^9, 3.8956454658611383`*^9}, {3.895646352585684*^9, 
   3.895646363160283*^9}, 3.8956464994453096`*^9, {3.895698040743148*^9, 
   3.8956980442315083`*^9}, {3.8969646650379877`*^9, 3.896964673279891*^9}, {
   3.896964754579067*^9, 3.8969647548365417`*^9}, {3.8969787045808268`*^9, 
   3.89697873816442*^9}, {3.896991323794711*^9, 3.896991329217147*^9}, {
   3.8969919460924926`*^9, 3.8969920822575912`*^9}, {3.896992353091651*^9, 
   3.8969924445599003`*^9}, {3.896992570074011*^9, 3.896992590843325*^9}, {
   3.8970573919606304`*^9, 
   3.8970574701667337`*^9}},ExpressionUUID->"92b76d96-921d-4849-a40c-\
d06b5af83e61"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross-order coefficient", "Title",
 CellChangeTimes->{{3.8958441162737217`*^9, 3.8958441751882124`*^9}, {
  3.896978624828581*^9, 
  3.8969786250025845`*^9}},ExpressionUUID->"22ed8e9a-ac08-49b1-a105-\
ccaa93207ba4"],

Cell["Mathematica finds the cross-order coefficient, if requested", "Text",
 CellChangeTimes->{{3.8968762944456177`*^9, 
  3.896876307054241*^9}},ExpressionUUID->"33f00c93-f20f-42d8-bde1-\
743c401a23cc"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"crosscoef", "==", "\"\<y\>\""}], " ", "&&", " ", 
    RowBox[{
     RowBox[{"Length", "[", "eq", "]"}], ">", "1"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "crosspar", "]"}], "==", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"crosspar", "=", 
        RowBox[{"crosspar", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"C11", "=", 
     FractionBox[
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"jacobianmat", "/.", "eq"}], ",", "crosspar"}], "]"}], 
          ",", "\[Phi]"}], "]"}], ",", "\[Psi]"}], "]"}], 
      RowBox[{"Dot", "[", 
       RowBox[{"\[Phi]", ",", "\[Psi]"}], "]"}]]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8958441601729593`*^9, 3.8958442156110077`*^9}, {
   3.89584428961308*^9, 3.8958443871887455`*^9}, {3.895844422323782*^9, 
   3.8958444232395816`*^9}, 3.89584446009347*^9, {3.895844536249735*^9, 
   3.8958445441398525`*^9}, {3.8968762769944887`*^9, 
   3.896876277839266*^9}},ExpressionUUID->"c55ec3d7-8d3f-4fab-8804-\
a4ea848a2cb1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Changes of criticality", "Title",
 CellChangeTimes->{{3.8954324193678913`*^9, 3.895432430516776*^9}, {
  3.8968763837307997`*^9, 
  3.896876386803398*^9}},ExpressionUUID->"8258dbe0-d1fc-429e-b0fe-\
ea1230796fe6"],

Cell["Mathematica finds the changes of criticality if requested", "Text",
 CellChangeTimes->{{3.8968763943004045`*^9, 
  3.8968764032385044`*^9}},ExpressionUUID->"be60d8d7-f0cb-4095-b82c-\
19e8939f49b4"],

Cell[BoxData[
 RowBox[{"Catch", "[", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&", 
     " ", 
     RowBox[{
      RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Throw", "[", 
      "\"\<This script could not find a bifurcation curve for this \
system\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nmax", ">=", "5"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fifthcoeff", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"criticalitychanges", "!=", "\"\<y\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Throw", "[", 
         "\"\<You do not want to find changes of criticality\>\"", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"codimensiontwopoints", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"outersolnum", "=", "1"}], ",", 
       RowBox[{"outersolnum", "<=", 
        RowBox[{"Length", "[", "solutioncurves", "]"}]}], ",", 
       RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"innersolnum", "=", "1"}], ",", 
         RowBox[{"innersolnum", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"solutioncurves", "[", 
            RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aux", "=", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
             "]"}], "/.", "variabledependence"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Variables", "[", 
              RowBox[{
               RowBox[{"aux", "/.", 
                RowBox[{
                 RowBox[{"solutioncurves", "[", 
                  RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
               RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"auxC3", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", "time", "}"}], ",", "#", ",", 
               RowBox[{"RuntimeOptions", "->", 
                RowBox[{"{", 
                 RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}], 
                 "}"}]}]}], "]"}], "&"}], "@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"C3", "/.", "fixedpar"}], "/.", 
                   RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{"\[Mu]NF", "->", 
                 RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
               "variabledependence"}], "/.", 
              RowBox[{
               RowBox[{"solutioncurves", "[", 
                RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"allvals", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{"auxC3", "[", "time", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "timedifference"}], 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vals", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"valnum", "=", "1"}], ",", 
            RowBox[{"valnum", "<=", 
             RowBox[{
              RowBox[{"Length", "[", "allvals", "]"}], "-", "1"}]}], ",", 
            RowBox[{"valnum", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"allvals", "[", 
                   RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "*", 
                 RowBox[{
                  RowBox[{"allvals", "[", 
                   RowBox[{"[", 
                    RowBox[{"valnum", "+", "1"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "<", "0"}], " ", "&&", 
               " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"allvals", "[", 
                  RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ">", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Chop", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", 
                    RowBox[{
                    RowBox[{"allvals", "[", 
                    RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  "Choptol"}], "]"}], "!=", "0"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"vals", ",", 
                RowBox[{
                 RowBox[{"allvals", "[", 
                  RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"tnum", "=", "1"}], ",", 
            RowBox[{"tnum", "<=", 
             RowBox[{"Length", "[", "vals", "]"}]}], ",", 
            RowBox[{"tnum", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"initialvalueoft", "=", 
              RowBox[{"vals", "[", 
               RowBox[{"[", "tnum", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"critchangetemp", "=", 
              RowBox[{"time", "/.", 
               RowBox[{"Quiet", "@", 
                RowBox[{"FindRoot", "[", 
                 RowBox[{
                  RowBox[{"auxC3", "[", "time", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"time", ",", "initialvalueoft"}], "}"}]}], 
                 "]"}]}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<=", "critchangetemp", "<=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], " ", "&&", " ", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"auxC3", "[", "critchangetemp", "]"}], "]"}], "<", 
                 "tol"}], " ", "&&", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "critchangetemp", "]"}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}], ">", 
                 "0"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"auxiliaryarray", "=", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\[Mu]NF", "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}], 
                  "/.", 
                  RowBox[{"time", "->", "critchangetemp"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"codimensiontwopoints", ",", "auxiliaryarray"}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"ValueQ", "[", "fifthcoeff", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"fifthcoeff", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
                    RowBox[{"time", "->", "critchangetemp"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"C5", "/.", "fixedpar"}], "/.", 
                    RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                    RowBox[{"\[Mu]NF", "->", 
                    RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
                    "variabledependence"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
                    RowBox[{"time", "->", "critchangetemp"}]}], "}"}]}], 
                    "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "codimensiontwopoints", "]"}], ">", "0"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"codimensiontwopoints", "=", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"par", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "\[Mu]NF"}], "}"}], ",", 
            "var"}], "]"}], "/.", "codimensiontwopoints"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"codimensiontwopoints", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"codimensiontwopoints", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"EuclideanDistance", "[", "##", "]"}], "<", "disttol"}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"critchange", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "->", 
              RowBox[{
               RowBox[{"codimensiontwopoints", "[", 
                RowBox[{"[", "critnum", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "->", 
              RowBox[{
               RowBox[{"codimensiontwopoints", "[", 
                RowBox[{"[", "critnum", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"critnum", ",", 
             RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"codimensiontwopoints", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"3", "+", "varnum"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"critnum", ",", 
             RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ValueQ", "[", "fifthcoeff", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"auxarr", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"critnum", "=", "1"}], ",", 
             RowBox[{"critnum", "<=", 
              RowBox[{"Length", "[", "critchange", "]"}]}], ",", 
             RowBox[{"critnum", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"getout", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"fifthnum", "=", "1"}], ",", 
                RowBox[{"fifthnum", "<=", 
                 RowBox[{"Length", "[", "fifthcoeff", "]"}]}], ",", 
                RowBox[{"fifthnum", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"getout", "==", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"fifthcoeff", "[", 
                    RowBox[{"[", "fifthnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "/.", 
                   RowBox[{"critchange", "[", 
                    RowBox[{"[", "critnum", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"auxarr", ",", 
                    RowBox[{"fifthcoeff", "[", 
                    RowBox[{"[", "fifthnum", "]"}], "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"getout", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fifthcoeff", "=", "auxarr"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ValueQ", "[", "fifthcoeff", "]"}], " ", "&&", " ", 
           RowBox[{
            RowBox[{"Length", "[", "fifthcoeff", "]"}], ">", "0"}]}], ",", 
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{
            "\"\<Fifth-order coefficient at codimension-two bifurcation \
points.txt\>\"", ",", "fifthcoeff"}], "]"}], ";"}], "\[IndentingNewLine]", 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ValueQ", "[", "critchange", "]"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Length", "[", "critchange", "]"}], ">", "0"}]}], ",", 
             RowBox[{"Export", "[", 
              RowBox[{
              "\"\<Codimension-two bifurcation points.txt\>\"", ",", 
               "critchange"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]",
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.895432439016435*^9, 3.89543244673415*^9}, {
   3.8954324990803785`*^9, 3.895432586711835*^9}, {3.8954326762482696`*^9, 
   3.8954326770459056`*^9}, {3.895432715266409*^9, 3.8954327174397974`*^9}, {
   3.8954327690198593`*^9, 3.8954328375704412`*^9}, {3.8954329061120834`*^9, 
   3.8954329190150194`*^9}, {3.8954329516860323`*^9, 3.895433003076493*^9}, {
   3.8954332756657686`*^9, 3.8954332813660984`*^9}, {3.8954341875323477`*^9, 
   3.895434191486082*^9}, {3.8954342660500345`*^9, 3.895434311458144*^9}, {
   3.8954343612755375`*^9, 3.8954344420803947`*^9}, {3.895434646750369*^9, 
   3.8954346543234153`*^9}, {3.895434697269803*^9, 3.895434699002818*^9}, {
   3.895434768338003*^9, 3.895434806713364*^9}, {3.8956434054218225`*^9, 
   3.895643468187522*^9}, {3.89564383977068*^9, 3.8956438451513195`*^9}, {
   3.895650088308819*^9, 3.89565009062534*^9}, {3.895650267321447*^9, 
   3.8956502706981363`*^9}, {3.8956591154363317`*^9, 
   3.8956591175214195`*^9}, {3.8956593009952574`*^9, 
   3.8956593011714635`*^9}, {3.895659333807905*^9, 3.8956594333466425`*^9}, {
   3.895661053455301*^9, 3.8956610563638334`*^9}, 3.8956622091287374`*^9, {
   3.895664293872265*^9, 3.8956643251240177`*^9}, {3.8956663634840117`*^9, 
   3.8956663636448126`*^9}, {3.8956680905655947`*^9, 3.8956681955856557`*^9}, 
   3.8969786155944386`*^9},
 CellLabel->"In[67]:=",ExpressionUUID->"1563a7cb-eece-4d24-ae39-9fc8fff20e3b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bifurcation diagram plotting", "Title",
 CellChangeTimes->{{3.895435198809738*^9, 
  3.8954352032012653`*^9}},ExpressionUUID->"d50f385e-4539-490d-b5a5-\
aafb6b65b078"],

Cell[TextData[{
 "Mathematica plots the bifurcation curves found colored according to the \
sign of the third order coefficient and the sign of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["k", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "20efb386-542a-4ae2-82e3-506004c3f2d9"]
}], "Text",
 CellChangeTimes->{{3.896876499310449*^9, 
  3.8968765237501154`*^9}},ExpressionUUID->"bd19fffe-c90d-4430-8d32-\
8e9cca6e1e30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Catch", "[", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&", 
     " ", 
     RowBox[{
      RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Throw", "[", 
      "\"\<This script could not find a bifurcation curve for this \
system\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "parnames", "]"}], "<", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"parnames", "=", "par"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ValueQ", "[", "critchange", "]"}], " ", "&&", " ", 
        RowBox[{
         RowBox[{"Length", "[", "critchange", "]"}], ">=", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"critpoints", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/.", 
                RowBox[{"critchange", "[", 
                 RowBox[{"[", "critnum", "]"}], "]"}]}], "]"}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"critnum", ",", 
             RowBox[{"Length", "[", "critchange", "]"}]}], "}"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"bifcurveplot", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GlobalLPplot", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"outersolnum", "=", "1"}], ",", 
       RowBox[{"outersolnum", "<=", 
        RowBox[{"Length", "[", "solutioncurves", "]"}]}], ",", 
       RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"innersolnum", "=", "1"}], ",", 
         RowBox[{"innersolnum", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"solutioncurves", "[", 
            RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aux", "=", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
             "]"}], "/.", "variabledependence"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Variables", "[", 
              RowBox[{
               RowBox[{"aux", "/.", 
                RowBox[{
                 RowBox[{"solutioncurves", "[", 
                  RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
               RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"auxnonzero", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", "time", "}"}], ",", "#", ",", 
               RowBox[{"RuntimeOptions", "->", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
              "]"}], "&"}], "@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar"}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{"\[Mu]NF", "->", 
                 RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
               "variabledependence"}], "/.", 
              RowBox[{
               RowBox[{"solutioncurves", "[", 
                RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"auxC3", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", "time", "}"}], ",", "#", ",", 
               RowBox[{"RuntimeOptions", "->", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
              "]"}], "&"}], "@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"C3", "/.", "fixedpar"}], "/.", 
                   RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{"\[Mu]NF", "->", 
                 RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
               "variabledependence"}], "/.", 
              RowBox[{
               RowBox[{"solutioncurves", "[", 
                RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempplot", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"ParametricPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                     " ", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], "<", "0"}]}], 
                   "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                     " ", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], ">", "0"}]}], 
                   "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], "<", "0"}]}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], "==", "0"}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], " ", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"time", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Red", ",", "Blue", ",", 
                 RowBox[{"{", 
                  RowBox[{"Green", ",", "Dotted"}], "}"}], ",", "Gray"}], 
                "}"}]}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"bifcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"outersolnum", "=", "1"}], ",", 
       RowBox[{"outersolnum", "<=", 
        RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}]}], ",", 
       RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"innersolnum", "=", "1"}], ",", 
         RowBox[{"innersolnum", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"solutioncurvesGlobalLP", "[", 
            RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tempplot", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"ParametricPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                "}"}], "/.", " ", 
               RowBox[{
                RowBox[{"solutioncurvesGlobalLP", "[", 
                 RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"time", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurvesGlobalLP", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurvesGlobalLP", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", "Gray", "}"}]}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"GlobalLPplot", ",", "tempplot"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bifcurveplot", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"bifcurveplot", ",", "GlobalLPplot"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CreateDocument", "[", 
      RowBox[{
       RowBox[{"Dynamic", "[", "plot2", "]"}], ",", 
       RowBox[{"WindowSize", "->", 
        RowBox[{"{", 
         RowBox[{"500", ",", "500"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", "critpoints", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plot2", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"bifcurveplot", ",", "critpoints", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
             ",", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"RotateLabel", "->", "False"}], ",", 
          RowBox[{"FrameStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
          RowBox[{"AspectRatio", "->", "1"}]}], "]"}]}], " ", 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"plot2", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"bifcurveplot", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
             ",", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"RotateLabel", "->", "False"}], ",", 
          RowBox[{"FrameStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
          RowBox[{"AspectRatio", "->", "1"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8954352407655687`*^9, 3.895435351307047*^9}, {
  3.895435406752877*^9, 3.8954354378472877`*^9}, {3.8954355841780214`*^9, 
  3.8954356080053015`*^9}, {3.895475873745516*^9, 3.8954758751751575`*^9}, {
  3.8956434806516714`*^9, 3.89564351456166*^9}, {3.8956438539857783`*^9, 
  3.895643854171158*^9}, {3.8956678403166037`*^9, 3.895667883594569*^9}, {
  3.8956699925482097`*^9, 3.8956699934140873`*^9}, {3.8956702605384316`*^9, 
  3.895670260998264*^9}, {3.8956708198734627`*^9, 3.895670823120852*^9}, {
  3.8956708941952596`*^9, 3.8956709050484095`*^9}, {3.8956710648408823`*^9, 
  3.8956711092212105`*^9}, {3.8956711766630573`*^9, 3.8956711773613887`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"9b433723-f3b4-4c41-a9c6-27561d0be08d"],

Cell[BoxData[
 GraphicsBox[{{{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], AbsoluteThickness[1.6], Opacity[1.], FaceForm[
       Opacity[0.3]], LineBox[CompressedData["
1:eJwBIQPe/CFib1JlAgAAADEAAAACAAAAcp3OwilYA0AhHeVfuV0pQK8NjFSm
VANAcd5/nLhXKUAmbpe+3UsDQIhsJxC6SClA3lBJJRVDA0B+uIVQwDkpQO8/
WuiDMQNAXaQYN9sbKUA1J9JEuygDQKt7et3vDClAX2EbnvIfA0BR1uRQCf4o
QAq+TkdhDgNA0Q8sn0rgKED8gFJ0PusCQKAbU9oGpShA6ZeFIgvjAkBiPHT9
PJcoQBRMoc3X2gJA38JpT3eJKEAo0YcaccoCQI0E03/4bShAbclIkKOpAkDN
XOQULTcoQGm7PvgHaAJAhhe6Jl/KJ0AFyMquzuQBQNThGffm8yZAeLpH9FPe
AECx/sKbhlMlQFhv1PYnt/0/DkAeLs5TIkC+5epN0Fn5Pykw2u6Qtx5AFKls
LvVG9T9GAHEsWrYZQI482Y9D3PA/5WTxojnfFEBxLlJn/wvpP2Sk/lFYthBA
vD4g6br04D/zfbQfYLkKQFwEfyug0eA/fyOqdY+eCkB/Rtlnha7gP7qPSQjS
gwpAxJ1uz09o4D8hMdvkkE4KQJtczrTIt98/iDpee/XkCUCde2AkGYbdP9JD
J0haFQlAORSnf7Ii2T/zQ3ZwkoQHQAXJqc973Ng/6M0uiilsB0BQcqUaRZbY
P6DKDOTTUwdAgjUDptcJ2D9AnMVZYiMHQBjdrnD88NY/AAPiQ2bDBkBzMjWd
Rb/UPz7qG1YKBwZAwXqVbg551D9S1IJm1e8FQMVmO3PXMtQ/af9hybPYBUAC
g++RaabTP04QTVyqqgVAVIjbAY6N0j/UBYyrfk8FQBAK5N/YW9A/BGtkTcSc
BEArvnMOUBrQP7tUUGw6iARAlClArY6xzz99nBJawXMEQGD8B3xsq84/t1+2
pAFLBECNE4e8WyjOP5tiwwG7NgRA5VT3REulzT+KLWUwhSIEQIGNG0krn8w/
GQQsBkz6A0AoS/vXGxzMP/mkC7BI5gNAIrnr8AyZyz9PPDo1VtIDQLpaOHn+
Fcs/3vdXkXS+A0C6JQR98JLKP82y+8WjqgNAaFJNkbp4yj/iDCA9r6YDQJl7
WTM=
        "]]},
      Annotation[#, "Charting`Private`Tag$6045#1"]& ], 
     TagBox[
      {RGBColor[0, 0, 1], AbsoluteThickness[1.6], Opacity[1.], FaceForm[
       Opacity[0.3]], LineBox[CompressedData["
1:eJwBQQO+/CFib1JlAgAAADMAAAACAAAAGi/dJAYBFEA23ZBFiYFCQLaXMEH7
/BNA2viQMHl7QkArIBFb8PgTQDxDXx1qdUJA7H97h9rwE0CYs3D8TmlCQJwi
AMOu4BNAVW+t0CRRQkBdLxzFVsATQLUVp9MAIUJALdJt+KR/E0AWXWJUesFB
QI5WszE6/hJAxBHAx3MFQUDo8o8If+URQAEE8j5J9z5AhGF/NzjfEEAS2Ye8
Njo8QLfyHKbouw9Acth8QyurOUCj/ZLLe40NQJf/BOzPCDdAexWDSBKEC0Ch
BLeNhLU0QJlQho++TglA6d6zaZVVMkAczBqDeiMHQBNREltyJjBAMFa3RmIb
B0Doeyjtkh4wQKzkDwdKEwdA0FBDiLUWMEA6oft9GQMHQMgHl9kABzBAaJnr
RLjiBkC+JU7SX88vQFfr3Tj1oQZAe5Fzf99SL0BDzhnDbCAGQHmU9MrsXC5A
VaM9IVQYBkCMYIw/sE0uQAkSSnw7EAZAOkQbx3c+LkAPDSEpCgAGQCsIOQ8T
IC5AoJzeXaffBUDDZS2EeuMtQADy7zPhngVAxsn2BQ1rLUCWGn6YUh0FQIca
cZRAfSxAmpB6tIoUBUB33VqYSG0sQBaF8szCCwVA7g+FZ1VdLEAAVFbzMvoE
QL4Ztmd9PSxAUXP3FRPXBEAZHUrwBv4rQB76EbPSkARAyetVKACAK0CPqweX
CogEQD6XkONUcCtAgMOEd0J/BEBFHX9qrmArQKW0Fy6ybQRAJlCU229BK0BF
fLJxkUoEQPZyZ0ssAytAgvSmU08EBEBnlEpoi4cqQKAFfwCH+wNAE9054ix4
KkBVOe6pvvIDQLn+VCjTaCpAvyCc8i3hA0DtcTUZLkoqQBWPVVsMvgNAqVRs
jh0NKkBjERPtQ7UDQA8km2rl/SlA3rd5e3usA0DiTj0Tsu4pQPU5VI7qmgNA
tTMNylnQKUBNeMASIpIDQB/IPNg0wSlAovjSk1mJA0CD0POyFLIpQFUe7ovI
dwNAHa0SzuKTKUA6c/gCAG8DQEe5hw7RhClAH26wdjdmA0DSnKQbxHUpQCAW
OeduXQNAdvai9btmKUAAjI0wmlgDQK3AJIZ5XilAMBBF+w==
        "]], LineBox[CompressedData["
1:eJwV0ns0lHkcBvB3ZkTWuKSls1vOumwXxLKZjVTf3/u+O0YZdLCKbKrDSZxm
DEXUhJlFIkUaRTZdppGmtiZMF2cHJ+RStk7FkKihjUaFIpXZ/fXHc57z+ev5
53HYLgyJZRIEsQHna0/M0SxwS2oH+/r3HJWchSweb1mqs2wH6VaZVidjIbuL
2eInBW3Q7FbV6SVlIY9Phw63m7ZByd7pSpmQhcA/eo8m5y7MorpI0ygWsm8y
C6xl3YXsXK/ZAn8WSuJEuCszW+GLdCjfgcNC51pGblWkt8CTkeRssQULlXaf
dCoR3IGBEddURhMTXVGFCWw3NsDM6KUpajkTNYb222ZWaeDPsefs3u+YiO1m
rx86+zc4erraSk2Y6PQpvdFEaT18G5ny0UzHQK6c6fpL0hsQXFiewSxnoHBH
Xpev4Cos+HC/OtSSgSgb8J9XWAxCF43z8HoCKdcdCD+JiiClwtb4BJdAzNgX
ndMLj8Kgdrl4AhGoOkFgVbezAMaXvQz28SHQJfOi++/f5MCDB2S/vTuBpn0u
zxdIMyE/qrnCxYFAwRZ8QdviPZCaVRX6iw2BHGvtXwaUxsEZqiI3jI33xpP7
zAyREH0s7V6LMYFCO8RJBkMI8NsXD98xItDnmiAqsJEPERGijOMsAilsYuf6
K/hwuuGDVTH2sGrkpugwHyY7nygKseNmFfrgSD50t90ZysUW7VZbuUwFALo/
cDId2ynGs+sNJwA0l71fbsW+9vvNM9qH6yCe51nhgf3plV2im5AHzVReiZZJ
oJqtie9WbuGBeEJl1Y2d+tF5KDKQByHyvwofYd+OmgwZceWBWjV0pAt7+1u1
0nHUD443jcmbsSWSMpun8X4Q1Ku0VWEXUy3XXPZz4d3uPHU+9k8xBcp/d3Gh
PLMkPO/r3iN+ljqaC5JO3Ycc7JznbKcjNBcaD1pzJNgV5m5+37O5wOdPXt+L
HX4vzDer8ldAQTEX8JHR5h7OU+VjGlIl87rXYr8wsezYd5cGhunVxauxvS1W
OkfdpqFvNF/kg11d5nlxwxka4jYiwgtbdMNjxkhAw0FF2vtl2I0RP8g3b6Nh
uKVh6RJs4bM1qqYwGgxrroQ7YTcYEoSNvjT88bjwgh02yW6aFX9Dg93DlSbW
2AN92avCDBQw1ydaWWJL4+r7fSYo6JhizGdj/0ibDfzcS4GHyWWmMbbvA7Mj
PdUUnFpvkjnDINDTjhjNktMU/HPe3H8KWx5tlCA9RgH1W9mcSezk43ZNO/ZT
kBUo26LHdjd1jNAGUaC2vid6ht3adj3gBE3BzI7xrl7sQXefnhhvCvKM+Yu6
sesVg0FLHCnojXqb1oWdnVJELFxAQdrSsdwObL9x575FbApSdHvFrdgHaxml
vCkSyhL0Nhrsj9O61YmvSVjVy71+CztkXXmJfJCEF5Yjy+uw4+PlPZwOEpw/
z55TYu9MN8882kDCpqJcmQI7zfV20HQtCWMG7+Cz2OeEhPpVJQn1pEIvw66y
XqFPkpGQ0f+m7ih2RmVp2twCEtaelVgewnZ5vYl9MYuE5NHzWgl2jf2JFWGp
JJy/tW80HTspxMvPdBcJNVe1X0TYD3UHHFq3k0BfeVa8A9t4PmjXbCPh5n/y
R7HY/wNYKBLY
        "]]},
      Annotation[#, "Charting`Private`Tag$6045#1"]& ], 
     TagBox[
      {RGBColor[0, 1, 0], AbsoluteThickness[1.6], Opacity[1.], 
       Dashing[{0, Small}], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1: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
        "]]},
      Annotation[#, "Charting`Private`Tag$6045#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], AbsoluteThickness[1.6], Opacity[1.], FaceForm[
       Opacity[0.3]], LineBox[CompressedData["
1:eJwBUQOu/CFib1JlAgAAADQAAAACAAAAABqLNzt4yj9H3iQHnKYDQB3IElfX
/co/poUWacy6A0ArMohCfIrLPxeyFbwf0ANABiWtrCEXzD9ShZNzhuUDQERO
yS9uMM0/u2kDGY4QBEAKGD8FFb3NP5or0vwuJgRAFjwzObxJzj/AwvBA4zsE
QHSkVoILY88/Ubu14YVnBEAWy4Ny1srQP1ZdqmyzvwRAVG+hR30M0T+osdH+
c9QEQMznUyskTtE/d+Cva0XpBEAiXggfctHRP0gbK9YaEwVA4PWBgw7Y0j+Z
uUTej2cFQAW0Pn9I5dQ/18iwgKITBkClcwnduf/YP5rqGKZneAdA6eLdykSa
4D82kfmMbXQKQEPt7RB7peg/4FS21NCIEEBgffUPw6/wP7GmecOlsRRAQZz5
P73B9D80pFJqPxwZQLmASaEHK/k/aN/1tT57HkD58jcoP0n9P4sUGlOqBSJA
0/qphkCpAEAEFL77XwElQKgGjbsBsgBAUKJFzOAOJUBdrXntwroAQAftimJm
HCVAfn0vSEXMAECOidfffzclQEcFVNlJ7wBALaFjHextJUBGBOdqUjUBQOCk
cqCp2yVAoeL2QGHBAUAtZ1OTuLomQDcYTRQiygFAtqWnDdLIJkB3qJLk4tIB
QGa98Ezw1iZAYPite2TkAUCwF+kZO/MmQAn4Q4RnBwJAJp4U7QksJ0AodJb/
bE0CQKoN2nSMnidAfeHAoC1WAkBGfD068qwnQAacrD7uXgJAtXL5w1y7J0Bb
tsBwb3ACQBAZWiRA2CdANtkRrnGTAkDdnnoYQBIoQKqpAZJ12QJAali+0CSH
KEArqbyToOECQBa8rczblChAOxRmksvpAkCmNffulqIoQHPHjoYh+gJAAmqX
phm+KEBXSjF8TAIDQCyKGDzhyyhA+8U4b3cKA0AGC434rNkoQNTxYU3NGgNA
rcge5lD1KEC+kXE4+CIDQPtAGBcpAylAcS3HICMrA0Dy8cRuBREpQL+zWQZO
MwNAuuwS7eUeKUD/k//oeDsDQN8jw5HKLClA2SijyKNDA0BSIrNcszopQJ7W
UqXOSwNAS+nyTaBIKUCgAR1/+VMDQAR6kmWRVilAsfGudXdYA0Dr558qPl4p
QPUFZ+g=
        "]]},
      Annotation[#, "Charting`Private`Tag$6133#1"]& ], 
     TagBox[
      {RGBColor[0, 0, 1], AbsoluteThickness[1.6], Opacity[1.], FaceForm[
       Opacity[0.3]], LineBox[CompressedData["
1:eJwV03tUjHkcBvB33ncqG5LUtBUyUtGOs9tlVbZ8f+871XShCzqkZtHWjFIK
Z5I2UtnJJZNuiC4rRhqli0urCUO6jLSsSpdpiRKpWLujZOPsb/94znM+/z7n
PNzwuLWRJEEQATj/t9UXIcPeSsO1L3o5kSwCnQ5sYieE09B4bqaLGLs16ara
PIaGbFXEgp3YjJrv1CKhQaKxkO/FzrooESSn0HCJGodUbC+l+MzKwzSceaTk
HcJu9F53gsylodfRNFeGXSZ/ldZZSEO4VemxPOz48+8MT1bT8Dk+UVqCfXTp
65mH6mnY0FFRdB571JxTk36PhhAHyb5y7M9c6+QzPTSIWS3VtdhdbIlrIIuB
Px+Fihqx7RXy2wUzGcg2yFjdgs2tjG1/a8JAnyvLog2bTdU8U9oxoFr4feJj
7ILiC7uG1jNg6bsrbAD72/N9bZmbGcgpvlk1iH1FkrONjmZgc1nvh2HssIZm
9cMUBuaO1AjHsaNyB5Xplxh4klB3eQrbgJPtJdThg1lsbqshSaD6KeF0pyEf
rKW/yeZh/730QOKm+Xzw6dsVwMHm+ojtshz58Phy/R0LbKO0p/6l4Xwo1WyI
t8He1/ecl9HIB70nHO4P2MULC0XlD/lgo5tf5I692t41tU/DB96rP0wRdkJm
gDpKyweniLc6ntgRNc4NYOMB1kUn2vyxJ9tfD7/I9IB0z1vzwrF3B/YXDYo8
YUaMdtkh7Pdl8ycHggVw2D62owv7eaiwd+U2AXzeMp3Zg5037F9WkyQAVW2d
twZ7m66t2WSJAKQC25YB7HydPIORUQFs3WgzMIrd310wV3HYG/a7m8lIikAm
zV9Emqc+IC1M9XDADpM3zH6pswYqJ1wyirF53ZYsYetaKPGmTOrYBAqdU27s
lRcKV6vui8Z0CfR1jKnKQBoFn/5Nsnkwi0Dvwk9eN+uJArM97swH7ButCbdW
8qLhboFztOVsAk1FVRcYaaLh5TeDM/ZgT2tDvjoXHAPFQUSrkwGBltitWuTd
HQeFN4VDE3MIlDPkwozbSmCQY5TkYkKgi8eMx2QFEphM77ygwN6bs+MnA8ME
sI52UnI5BJot4lZoZ+2Bd77BY5amBKrRC8r3CdoL60rSksRm+A/PeAPL0lPA
w/n0+3OWBLp8Y9XZLoUM+h90Ln7gjv/W3f+iPOw4mL9OCZuiCVSoF+TPycgG
/d1S1XUvAn3ib1/D25IH3yUUfwhcS6CACIl9PrsI1tv+2lknIZB4NHm5n0cl
bOK9rOj4i0DXjFIv1W+tAudupuo2yUIHqtSZ5N1qsFD2fBw2ZiG7j2wXGKkF
3/ax5XdcWchSEdckZepgtbjuluEvLOTqF9nwI6kCODu0I3gRiRShDqP3ZSoI
jJWdWuhEIocmPIbFHZivXOA4LSARtXF3opvTXdAdSJ6ljSMRt93HeYfoHryJ
N7fqUJHID/L0qX/uwXIfUahbF4k2LqZXnU5pgol5Ia43Rki0fdht7PdTzaA/
dUQ9bkShKPl0+3brFsiNjhHLbSn06GjOCv3aFpjQWSKLd6NQ6Rttm29bKzS7
1YfQIgr19h+sGtugBmXhFa3XzxSyN+2XZA2pQfPQmNxynEJHFFwdx533oXFF
5P5MOYX+AwEsBFc=
        "]], LineBox[CompressedData["
1:eJwVjH1Qy3EAh8dvk2RpfdvcudVEw9aiohB2n99POSl0LukwWrK89SapRvRy
07W8bnKckhpCEqXTRRdHXnJMKheVXjAhtJuXXlTyx3PPP889zuExa7aOZbFY
HqP895UTO1kdoRTKc4XNvZskmGNrF+KykUJFU4HhUIQEuWE+0tURFE4PuY9P
3S2BwK1oMHkXhWx5gD4lVYIK49cc434KiiSNUJMrgWPk/SJ1HoUu/oSB2kYJ
Xoiu4+U7Cga+os12mRSLVMWmARMF5+VWF1cES5HicCdL/IOCvumaThsuRavW
+rF6hELhj7p2wUEpXrsscBJPZcPntBbKSilafOfLk5VsNHp3CapdXaEJLZKL
PrAxmKnsOc6XoSTzl6qvh42YbO6RI2IZ8lnl2fW/2GB97rU55iVD30Z1XYYV
B4oq+sL5tTI8fCtz7JZy8JazTD6cI4N03UrBjTgOnMvTeIbJbogn0UFLRjgY
fKUZ0jnNRk59aEHgFCvoTHYTNY7uGC5V5PX4WSMirn3HtkBP9FdaXMYG2sBc
kHR+f+I8mIOVZekpXJz6yfPl//ZGlU9sVVLWJBg3eMWU7VoIiF5eiK21Q02W
aZzTn0UYrH8a9ryFh2hzSOmjVjlmdYRsj2y3x+InL7r83gDV/Vzm+3t7HBVv
Ede0A2f8mycndNsjQJRfvNAEWIy5Velme7QMczI8LYCD7lVrHkWwN3G+Yi6X
hoSn0TfMJJjqG3g3jqbR53Hp0eJYAtEJgW3nVRqcv/F4sIdgn0ldk36TRnQU
fds/meBgguiWuJLGjYbmsyHpBKnBwsiYWhrq7G7EniQwFGotvA4aepFgoLCS
YJabq0HPZ3DM5uxSSTWBh3LokL+QQdgzgbb0PoFu/ZsS1nQGaWm93Lt1BCXy
goe73Rk0fBCaG1sJcryIQBXAIOPw8mkbOkf/Q028GWsY2B5QBXV+JCh7nhn0
KZSBsX+v4dt3AvHM4lNRKgaZ+duexFtG+xH+Oc8oBsWXV3zp/0OQtyq8uy+e
QUWk0Dr1L8HmxMMJ99QMpsxpcxk3xgHebcf9stIY/APgbVDk
        "]]},
      Annotation[#, "Charting`Private`Tag$6133#1"]& ], 
     TagBox[
      {RGBColor[0, 1, 0], AbsoluteThickness[1.6], Opacity[1.], 
       Dashing[{0, Small}], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1: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
        "]]},
      Annotation[#, "Charting`Private`Tag$6133#1"]& ]}, {}}, {{{}, {}, {}, {}, 
     TagBox[
      {RGBColor[0, 1, 0], AbsoluteThickness[1.6], Opacity[1.], 
       Dashing[{0, Small}], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1: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

        "]]},
      Annotation[#, "Charting`Private`Tag$6176#1"]& ]}, {}}, {{{}, {}, {}, {}, 
     TagBox[
      {RGBColor[0, 1, 0], AbsoluteThickness[1.6], Opacity[1.], 
       Dashing[{0, Small}], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1: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
BQqS1uhW5GYTQ7PFPQf42TXR/wAXmOEO
        "]]},
      Annotation[#, "Charting`Private`Tag$6217#1"]& ]}, {}}, 
   {PointSize[0.02], PointBox[{2.418237773341652, 12.684349512787763`}]}, 
   {PointSize[0.02], PointBox[{0.2067631234371566, 2.4562773578845833`}]}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{
    FormBox["\"\\!\\(\\*RowBox[{\\\"\[Alpha]\\\"}]\\)\"", TraditionalForm], 
    FormBox["\"\\!\\(\\*RowBox[{\\\"c\\\"}]\\)\"", TraditionalForm]},
  FrameStyle->Directive[FontSize -> 15],
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "ScalingFunctions" -> 
    None},
  PlotRange->{{0, 5}, {0, 50}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  RotateLabel->False,
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.8956700947369757`*^9, 3.8956704419192724`*^9, 
  3.895671025046344*^9, 3.895671254475441*^9, 3.8956731260791807`*^9, 
  3.8956764888689327`*^9, 3.8956790576497917`*^9, 3.8957485733674126`*^9, 
  3.8957532853548174`*^9, 3.895756524712311*^9, 3.8957587518790207`*^9, 
  3.895758977726225*^9, 3.8957593422901907`*^9, 3.895759403106267*^9, 
  3.8957596390214477`*^9, 3.895759691609788*^9, 3.895759827472419*^9, 
  3.895760059676918*^9, 3.8957609334321327`*^9, 3.8957609943004365`*^9, 
  3.8957611641402364`*^9, 3.895818725760618*^9, 3.895818826517378*^9, 
  3.8958188862515516`*^9, 3.895819259166627*^9, 3.8958193730309353`*^9, 
  3.89581951139474*^9, 3.89584361864001*^9, 3.89584445451706*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"b4d506ec-364d-4188-8954-99ac627b1b25"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3D bifurcation curves", "Title",
 CellChangeTimes->{{3.895475618755782*^9, 3.895475622324048*^9}, {
  3.8956477345179358`*^9, 
  3.895647736795082*^9}},ExpressionUUID->"1b7279de-0e9a-4073-b020-\
f91d9b567541"],

Cell["Mathematica continues codimension-two curves, if requested", "Text",
 CellChangeTimes->{{3.8968765379964027`*^9, 
  3.89687654933407*^9}},ExpressionUUID->"6e5294df-fd8c-47fb-85ca-\
cd85145d1851"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"checker", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Not]", 
     RowBox[{"ValueQ", "[", "critchange", "]"}]}], " ", "||", " ", 
    RowBox[{
     RowBox[{"Length", "[", "critchange", "]"}], "==", "0"}], " ", "||", " ", 
    RowBox[{"cod2", "!=", "\"\<y\>\""}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"checker", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lowerbound", "=", 
     RowBox[{"Range", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"upperbound", "=", 
     RowBox[{"Range", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"otherpar", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", "3"}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"par", ",", 
          RowBox[{"par3", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"index", "=", "1"}], ",", 
          RowBox[{"index", "<=", "2"}], ",", 
          RowBox[{"index", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", "parnum", "]"}], "]"}], "==", 
             RowBox[{"par", "[", 
              RowBox[{"[", "index", "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"index", "==", "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervalx", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervalx", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervaly", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervaly", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"otherpar", ",", "parnum"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"lowerbound", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "=", 
          RowBox[{"extrainterval", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"upperbound", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "=", 
          RowBox[{"extrainterval", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fixedparameter3", "=", "parnum"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"parval3", "=", "parval"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", 
       RowBox[{"Length", "[", "fixedpar", "]"}]}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "fixedparameter3", "]"}], "]"}], "==", 
         RowBox[{
          RowBox[{"fixedpar", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"parval3", ",", 
           RowBox[{"fixedpar", "[", 
            RowBox[{"[", "parnum", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"incond", "=", 
          RowBox[{"fixedpar", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"fixedpar3", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{"fixedpar", ",", 
       RowBox[{"{", 
        RowBox[{"parval3", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"conjprime3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "'"}], "[", "y_", "]"}], "->", 
       RowBox[{"HoldForm", "[", 
        FractionBox[
         RowBox[{"Conjugate", "[", 
          RowBox[{"D", "[", 
           RowBox[{"y", ",", "time"}], "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{"y", ",", "time"}], "]"}]], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"absprime3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "'"}], "[", "y_", "]"}], "->", 
       RowBox[{"HoldForm", "[", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"y", ",", "time"}], "]"}], "*", 
           RowBox[{"Conjugate", "[", "y", "]"}]}], "+", 
          RowBox[{"y", "*", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"D", "[", 
             RowBox[{"y", ",", "time"}], "]"}], "]"}]}]}], 
         RowBox[{"2", "*", 
          RowBox[{"D", "[", 
           RowBox[{"y", ",", "time"}], "]"}], "*", 
          RowBox[{"Abs", "[", "y", "]"}]}]], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"kineticsaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"kinetics", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zerodetaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zerodet", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zeroderaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zeroder", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"auxC3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"C3", "/.", "fixedpar3"}], "/.", 
           RowBox[{"kNF", "->", 
            SqrtBox["\[Mu]NF"]}]}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", "zeroderaux"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", "auxC3"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"ReleaseHold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"equations", ",", "time"}], "]"}], "/.", "conjprime3"}], "/.",
        "absprime3"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{"\[Mu]NF", "'"}], "[", "time", "]"}], "2"], "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"varnum", "=", "1"}], "nvar"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
         "2"]}], "-", 
       SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equations", "[", 
         RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"equationnumber", ",", 
         RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"allvar", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par3", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par3", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par3", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", "\[Mu]NF"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvartimedependent", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"allvar", "[", 
         RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", 
         RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"initialconditions", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "codimensiontwopoints", "]"}], "==", "1"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"initialconditions", ",", 
         RowBox[{"codimensiontwopoints", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"pointnum", "=", "1"}], ",", 
        RowBox[{"pointnum", "<=", 
         RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], ",", 
        RowBox[{"pointnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"inp", "=", 
          RowBox[{"HoldForm", "[", 
           RowBox[{"Input", "[", 
            RowBox[{
            "\"\<Would you like to continue point \>\"", " ", "<>", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"codimensiontwopoints", "[", 
                RowBox[{"[", "pointnum", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", "2"}], "]"}], "]"}], "]"}], " ", "<>", " ", 
             "\"\<[y/n]\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"inp", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"initialconditions", ",", 
              RowBox[{"codimensiontwopoints", "[", 
               RowBox[{"[", "pointnum", "]"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"solutioncurves3", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"bifnum", "=", "1"}], ",", 
      RowBox[{"bifnum", "<=", "numberofbifurcationcurves"}], ",", 
      RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"initialvalues", "=", 
        RowBox[{"initialconditions", "[", 
         RowBox[{"[", "bifnum", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"initialvalues", ",", "incond"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dereval", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"initialvalues", "[", 
              RowBox[{"[", "varnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"varnum", ",", 
            RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"initialderivatives", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"equations", "/.", 
             RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
            RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"dernumber", "=", "1"}], ",", 
         RowBox[{"dernumber", "<=", 
          RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
         RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equations", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialvalues", "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                RowBox[{
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equationsaux", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", 
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time", 
                 "]"}], "==", 
                RowBox[{
                 RowBox[{"extrainterval", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time", 
                 "]"}], "==", 
                RowBox[{
                 RowBox[{"extrainterval", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempsol", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NDSolve", "[", 
             RowBox[{"equationsaux", ",", "allvar", ",", 
              RowBox[{"{", 
               RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], ",", 
              RowBox[{"Method", "->", 
               RowBox[{"{", 
                RowBox[{
                "\"\<EquationSimplification\>\"", "->", "\"\<Residual\>\""}], 
                "}"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], " ", "&&", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"solutioncurves3", ",", "tempsol"}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "solutioncurves3", "]"}], "==", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{
            "{", "\"\<This script could not find a Codimension-two \
bifurcation curve for your desired parameters. Try changing tolerances or \
initial values\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8954756273405137`*^9, 3.895475680722141*^9}, {
   3.8954757199021873`*^9, 3.8954758654317746`*^9}, 3.8954810434786043`*^9, {
   3.89564353007386*^9, 3.8956435618080664`*^9}, {3.895647645975181*^9, 
   3.8956476865588245`*^9}, {3.8956479328569984`*^9, 3.895648092395144*^9}, 
   3.895649018040077*^9, {3.8956490500832844`*^9, 3.895649257820964*^9}, {
   3.8956493077475405`*^9, 3.8956494188913093`*^9}, {3.8956494644125137`*^9, 
   3.895649605964903*^9}, {3.8956500643300824`*^9, 3.895650070246585*^9}, 
   3.8956592913265467`*^9, {3.8956594469643993`*^9, 3.895659453193489*^9}, {
   3.895676570492354*^9, 3.89567657344588*^9}, {3.89568350308055*^9, 
   3.895683648539012*^9}, {3.8956836910193853`*^9, 3.89568370386314*^9}, {
   3.8956838209975967`*^9, 3.895683821660875*^9}, {3.895683863637514*^9, 
   3.8956838645487967`*^9}, {3.89568419948907*^9, 3.895684221602098*^9}, {
   3.8956846921169868`*^9, 3.895684698108713*^9}, {3.8956847421099863`*^9, 
   3.895684746342307*^9}, {3.8956849028087263`*^9, 3.8956849624188795`*^9}, {
   3.8956856734041705`*^9, 3.895685693929438*^9}, {3.8956857512385283`*^9, 
   3.895685751506445*^9}, {3.895686549929406*^9, 3.8956865528353987`*^9}, {
   3.8956866047754164`*^9, 3.8956867482981462`*^9}, {3.8956869361394515`*^9, 
   3.8956869599486666`*^9}, {3.895686991707305*^9, 3.8956870677566414`*^9}, {
   3.895687116649618*^9, 3.8956871189746037`*^9}, {3.8956871879575033`*^9, 
   3.8956872009934635`*^9}, {3.8956876620715685`*^9, 
   3.8956876940470743`*^9}, {3.895687746184574*^9, 3.895687759124637*^9}, {
   3.8956880062896843`*^9, 3.895688031844426*^9}, {3.8956881548866568`*^9, 
   3.895688155786559*^9}, {3.895688257910473*^9, 3.8956882936422844`*^9}, {
   3.8956883257030473`*^9, 3.895688403244361*^9}, {3.8956887751194715`*^9, 
   3.8956887801966853`*^9}, {3.8956888209053383`*^9, 3.895688824966505*^9}, {
   3.8956889656555414`*^9, 3.895688973744858*^9}, {3.895748654960019*^9, 
   3.8957486551683736`*^9}, {3.8957523722513633`*^9, 3.895752373768447*^9}, {
   3.8968770243344393`*^9, 3.89687703636053*^9}, {3.8968770668907347`*^9, 
   3.896877075466335*^9}},ExpressionUUID->"482e93db-e6df-423f-ba70-\
4d0a435202b3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Other Turing bifurcation curves", "Title",
 CellChangeTimes->{{3.89547591085975*^9, 
  3.895475915530171*^9}},ExpressionUUID->"8aeea5b5-47a5-4bfc-91b2-\
e38b668c0d13"],

Cell["\<\
As for the continuation of codimension two curves, an extra parameter is \
needed, this section computes more Turing bifurcation curves when that \
parameter is fixed at the parameter values provided above. The initial \
conditions considered are the codimension-two points found for that fixed \
parameter value in the previous cell\
\>", "Text",
 CellChangeTimes->{{3.896876563234068*^9, 3.89687660243521*^9}, {
  3.8968766546217346`*^9, 3.8968766615603895`*^9}, {3.8968771223123074`*^9, 
  3.896877169142969*^9}},ExpressionUUID->"54680546-436d-411a-b1b4-\
4c7c938a4711"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fixedparametervalues", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"initialconditions", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"turingbifurcationcurves", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"turingnumber", "=", "1"}], ",", 
      RowBox[{"turingnumber", "<=", 
       RowBox[{"Length", "[", "otherTuring", "]"}]}], ",", 
      RowBox[{"turingnumber", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"fixedparametervalues", ",", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "fixedparameter3", "]"}], "]"}], "->", 
          RowBox[{"otherTuring", "[", 
           RowBox[{"[", "turingnumber", "]"}], "]"}]}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"turingnumber", "=", "1"}], ",", 
      RowBox[{"turingnumber", "<=", 
       RowBox[{"Length", "[", "otherTuring", "]"}]}], ",", 
      RowBox[{"turingnumber", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"getout", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"outersolnum", "=", "1"}], ",", 
         RowBox[{"outersolnum", "<=", 
          RowBox[{"Length", "[", "solutioncurves3", "]"}]}], ",", 
         RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"getout", "==", "1"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"innersolnum", "=", "1"}], ",", 
            RowBox[{"innersolnum", "<=", 
             RowBox[{"Length", "[", 
              RowBox[{"solutioncurves3", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"solt", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"NMinimize", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time",
                     "]"}], "-", 
                    RowBox[{
                    RowBox[{"fixedparametervalues", "[", 
                    RowBox[{"[", "turingnumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"], "/.", 
                  RowBox[{
                   RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", "time"}], 
                "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<=", 
                RowBox[{"(", 
                 RowBox[{"time", "/.", 
                  RowBox[{"solt", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "<=", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"solt", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "tol"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"initialconditions", ",", 
                    RowBox[{"Check", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "/.", 
                    RowBox[{"solt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "Null"}], "]"}]}], 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"initialconditions", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allvar", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allvar", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{"initialconditions", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}], "/.", 
                    RowBox[{"solt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"getout", "=", "1"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]",
                 "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"bifnum", "=", "1"}], ",", 
      RowBox[{"bifnum", "<=", 
       RowBox[{"Length", "[", "initialconditions", "]"}]}], ",", 
      RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fixedparametereval", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "fixedparameter3", "]"}], "]"}], "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "fixedparameter3", "]"}], "]"}], "/.", 
            RowBox[{"initialconditions", "[", 
             RowBox[{"[", "bifnum", "]"}], "]"}]}], ")"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kineticsaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"kinetics", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", 
                RowBox[{"otherpar", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", 
              RowBox[{"otherpar", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"\[Mu]NF", "->", 
           RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zerodetaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"zerodet", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", 
                RowBox[{"otherpar", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", 
              RowBox[{"otherpar", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"\[Mu]NF", "->", 
           RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zeroderaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"zeroder", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", 
                RowBox[{"otherpar", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", 
              RowBox[{"otherpar", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"\[Mu]NF", "->", 
           RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", "zeroderaux"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time", "]"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"D", "[", 
         RowBox[{"equations", ",", "time"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "'"}], "[", 
            "time", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "'"}], "[", 
            "time", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[Mu]NF", "'"}], "[", "time", "]"}], "2"], "+", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"varnum", "=", "1"}], "nvar"], 
           SuperscriptBox[
            RowBox[{
             RowBox[{
              RowBox[{"var", "[", 
               RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}],
             "2"]}], "-", 
          SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"equations", "[", 
            RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"equationnumber", ",", 
            RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"initialvalues", "=", 
        RowBox[{"initialconditions", "[", 
         RowBox[{"[", "bifnum", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dereval", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"initialvalues", "[", 
              RowBox[{"[", "varnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"varnum", ",", 
            RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"initialderivatives", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"equations", "/.", 
             RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
            RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"dernumber", "=", "1"}], ",", 
         RowBox[{"dernumber", "<=", 
          RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
         RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equations", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialvalues", "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                RowBox[{
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equationsaux", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", 
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempsol", "=", 
           RowBox[{"NDSolve", "[", 
            RowBox[{"equationsaux", ",", "allvar", ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], ",", 
             RowBox[{"Method", "->", 
              RowBox[{"{", 
               RowBox[{
               "\"\<EquationSimplification\>\"", "->", "\"\<Residual\>\""}], 
               "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], " ", "&&", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"turingbifurcationcurves", ",", "tempsol"}], "]"}], 
             ";"}], ","}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8954759238653526`*^9, 3.8954759865585675`*^9}, {
  3.895643572304961*^9, 3.8956436047670174`*^9}, {3.8956481296260095`*^9, 
  3.89564820575352*^9}, {3.895649650965356*^9, 3.8956497256967926`*^9}, {
  3.895689469106891*^9, 3.895689484387652*^9}, {3.895689532343933*^9, 
  3.895689617869485*^9}, {3.895689674770615*^9, 3.8956896828142223`*^9}, {
  3.8956897253476787`*^9, 3.895689735228913*^9}, {3.8956898088363514`*^9, 
  3.895689912624589*^9}, {3.8956899615465884`*^9, 3.895689967384285*^9}, {
  3.895690037784216*^9, 3.8956900603790655`*^9}, {3.8956901129443216`*^9, 
  3.8956902457114444`*^9}, {3.89569030592418*^9, 3.8956903156685514`*^9}, {
  3.896877206445666*^9, 
  3.896877212330518*^9}},ExpressionUUID->"d1a38189-a75f-495a-8e90-\
0c9d80700ad3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Codimension-two bifurcation diagram plotting", "Title",
 CellChangeTimes->{
  3.8954760027248507`*^9},ExpressionUUID->"d8e321cb-8dd8-47b4-8dd2-\
a1cdcb039ab4"],

Cell["\<\
Mathematica plots the codimension-two curve with all the other Turing \
bifurcation curves found in the previous cell. The intersections between the \
Turing curves and the codimension-two curve will also be marked.\
\>", "Text",
 CellChangeTimes->{{3.8968766738681097`*^9, 
  3.8968767413823028`*^9}},ExpressionUUID->"abc3d507-0518-4b9a-a98d-\
7d6f72638fbd"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"parnames3", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"counter", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", "3"}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"par", ",", 
          RowBox[{"par3", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"parnames3", ",", 
           RowBox[{"parnames", "[", 
            RowBox[{"[", "counter", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"counter", "=", 
          RowBox[{"counter", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "par3name", "]"}], "==", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"parnames3", ",", "par3name"}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"parnames3", ",", 
            RowBox[{"par3", "[", 
             RowBox[{"[", "fixedparameter3", "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"bifcurveplot", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"turingcurveplot", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"critpoints", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"par3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"par3", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/.", 
            RowBox[{"initialconditions", "[", 
             RowBox[{"[", "bifnum", "]"}], "]"}]}], "]"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"bifnum", ",", 
         RowBox[{"Length", "[", "initialconditions", "]"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"outersolnum", "=", "1"}], ",", 
      RowBox[{"outersolnum", "<=", 
       RowBox[{"Length", "[", "turingbifurcationcurves", "]"}]}], ",", 
      RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"innersolnum", "=", "1"}], ",", 
        RowBox[{"innersolnum", "<=", 
         RowBox[{"Length", "[", 
          RowBox[{"turingbifurcationcurves", "[", 
           RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"aux", "=", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
            "]"}], "/.", "variabledependence"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Variables", "[", 
             RowBox[{
              RowBox[{"aux", "/.", 
               RowBox[{
                RowBox[{"turingbifurcationcurves", "[", 
                 RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
              RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"auxnonzero", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}], 
                "}"}]}]}], "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar3"}], "/.", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"turingbifurcationcurves", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"auxC3", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}], 
                "}"}]}]}], "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"C3", "/.", "fixedpar3"}], "/.", 
                   RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"turingbifurcationcurves", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                   " ", 
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], "<", "0"}]}], 
                 " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                   " ", 
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], ">", "0"}]}], 
                 " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], "<", "0"}]}], " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Green", ",", "Dotted"}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"outersolnum", "=", "1"}], ",", 
      RowBox[{"outersolnum", "<=", 
       RowBox[{"Length", "[", "solutioncurves3", "]"}]}], ",", 
      RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"innersolnum", "=", "1"}], ",", 
        RowBox[{"innersolnum", "<=", 
         RowBox[{"Length", "[", 
          RowBox[{"solutioncurves3", "[", 
           RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"aux", "=", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
            "]"}], "/.", "variabledependence"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Variables", "[", 
             RowBox[{
              RowBox[{"aux", "/.", 
               RowBox[{
                RowBox[{"solutioncurves3", "[", 
                 RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
              RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"auxnonzero", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
             "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar3"}], "/.", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"solutioncurves3", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}]}], "/.", 
                 RowBox[{
                  RowBox[{"solutioncurves3", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", " ", 
                 RowBox[{
                  RowBox[{"solutioncurves3", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "->", "Black"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"bifcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bifcurveplot", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"turingcurveplot", ",", "bifcurveplot"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"CreateDocument", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", "plot3", "]"}], ",", 
      RowBox[{"WindowSize", "->", 
       RowBox[{"{", 
        RowBox[{"500", ",", "500"}], "}"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ValueQ", "[", "critpoints", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"plot3", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"bifcurveplot", ",", "critpoints", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "StandardForm"}], "]"}]}],
            "}"}]}], ",", 
         RowBox[{"RotateLabel", "->", "False"}], ",", 
         RowBox[{"AxesStyle", "->", 
          RowBox[{"Directive", "[", 
           RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
         RowBox[{"BoxRatios", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}], " ", 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"plot3", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"bifcurveplot", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "StandardForm"}], "]"}]}],
            "}"}]}], ",", 
         RowBox[{"RotateLabel", "->", "False"}], ",", 
         RowBox[{"AxesStyle", "->", 
          RowBox[{"Directive", "[", 
           RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
         RowBox[{"BoxRatios", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.895476046596933*^9, 3.89547608140477*^9}, {
   3.8956436164038916`*^9, 3.89564364598274*^9}, {3.8956482322981625`*^9, 
   3.8956482508370934`*^9}, {3.8956499003847294`*^9, 
   3.8956499217983027`*^9}, {3.895690376580452*^9, 3.895690472517498*^9}, {
   3.8956914996468005`*^9, 3.8956915003492856`*^9}, {3.895691549426552*^9, 
   3.895691587904831*^9}, {3.895691918821433*^9, 3.8956919555170517`*^9}, {
   3.8956920251025147`*^9, 3.89569206214524*^9}, {3.895692094525321*^9, 
   3.895692109882864*^9}, {3.895692978415348*^9, 3.8956930242312098`*^9}, {
   3.895693206646363*^9, 3.8956932422293415`*^9}, {3.895693997116338*^9, 
   3.895694001905223*^9}, {3.895697246384327*^9, 3.8956972559521537`*^9}, 
   3.8956974256394386`*^9, {3.89569763833916*^9, 3.8956976811608944`*^9}, {
   3.895751951268671*^9, 3.8957520009447107`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"7d6aac12-cf9b-4179-a52e-ac2b6dc47746"]
}, Closed]]
},
WindowSize->{1428., 735.75},
WindowMargins->{{-6, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.3 Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"533841ac-82d1-44a9-bf7e-86a6e75e106d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 165, 3, 126, "Title",ExpressionUUID->"ea61d8e4-711d-4d74-b25b-761ac764db40"],
Cell[748, 27, 240, 6, 45, "Text",ExpressionUUID->"fb852f10-685d-44ae-b15a-4cf30567a1b9"],
Cell[991, 35, 179, 3, 36, "Input",ExpressionUUID->"4dd8c56a-24c9-40ec-9db2-0034b1e9c701"]
}, Closed]],
Cell[CellGroupData[{
Cell[1207, 43, 307, 5, 91, "Title",ExpressionUUID->"64324ed7-52be-4b1e-98cb-d02a137df024"],
Cell[1517, 50, 309, 6, 45, "Text",ExpressionUUID->"edf22f9a-7a61-4ca6-96ad-ede52a777aa8"],
Cell[1829, 58, 16909, 410, 1002, "Input",ExpressionUUID->"cc69dd3d-cbfb-4595-8acd-5d98b925aded"]
}, Closed]],
Cell[CellGroupData[{
Cell[18775, 473, 204, 4, 91, "Title",ExpressionUUID->"4ef2af19-48fd-4c88-b205-32b86bb1aa82"],
Cell[18982, 479, 458, 9, 75, "Text",ExpressionUUID->"5554f862-fa6d-4737-b089-27d14a42d11b"],
Cell[CellGroupData[{
Cell[19465, 492, 8125, 178, 852, "Input",ExpressionUUID->"5cbca695-ca74-488b-a139-a446b3ff92a4"],
Cell[27593, 672, 405, 7, 28, "Print",ExpressionUUID->"5a2cd777-d78f-4650-abc4-23a31b797518"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[28047, 685, 227, 4, 91, "Title",ExpressionUUID->"b4b8a194-920c-498a-838c-7ef029e5294d"],
Cell[28277, 691, 322, 7, 45, "Text",ExpressionUUID->"b4d74d42-b282-4d76-a057-3e600b12bab6"],
Cell[28602, 700, 14749, 355, 1451, "Input",ExpressionUUID->"ba1473d1-5aed-4060-aac2-2c3cb7a6c1f1"]
}, Closed]],
Cell[CellGroupData[{
Cell[43388, 1060, 213, 4, 91, "Title",ExpressionUUID->"5cafe80f-fe2b-43f2-bc97-220a654ba175"],
Cell[43604, 1066, 258, 6, 45, "Text",ExpressionUUID->"ae428f0a-a208-480c-87b1-50551fc4c33b"],
Cell[43865, 1074, 1872, 48, 161, "Input",ExpressionUUID->"a3894b42-9b16-446b-99f4-b500710381cf"]
}, Closed]],
Cell[CellGroupData[{
Cell[45774, 1127, 213, 4, 91, "Title",ExpressionUUID->"4488db71-1104-4303-b187-bae35678313d"],
Cell[45990, 1133, 406, 8, 75, "Text",ExpressionUUID->"87af798e-5705-4784-8e1b-1bc1ecdc431f"],
Cell[46399, 1143, 47353, 1112, 3175, "Input",ExpressionUUID->"fdb328a8-4025-4938-acf3-217bd8eb2181"]
}, Closed]],
Cell[CellGroupData[{
Cell[93789, 2260, 164, 3, 91, "Title",ExpressionUUID->"59e5598c-b1a4-495f-b255-391127440ca6"],
Cell[93956, 2265, 365, 7, 75, "Text",ExpressionUUID->"14a70aa0-2798-4b9a-8ecd-60aaee713a2f"],
Cell[94324, 2274, 23498, 578, 1698, "Input",ExpressionUUID->"badd11d8-df7e-46a4-8c64-95e5572ef76a"]
}, Closed]],
Cell[CellGroupData[{
Cell[117859, 2857, 606, 9, 91, "Title",ExpressionUUID->"975f7379-5e89-4c9d-9c35-2517707099ec"],
Cell[118468, 2868, 218, 4, 45, "Text",ExpressionUUID->"a0fefe8f-2f26-4637-bafc-edd7bea0a157"],
Cell[118689, 2874, 2159, 52, 291, "Input",ExpressionUUID->"2e32b0e0-a41c-4002-a99b-e9daae978379"]
}, Closed]],
Cell[CellGroupData[{
Cell[120885, 2931, 161, 3, 91, "Title",ExpressionUUID->"31009231-e5e1-4bd5-b49d-53ebf474df13"],
Cell[121049, 2936, 213, 5, 45, "Text",ExpressionUUID->"9ef0a0d4-5957-4304-b51d-4fa62a57d438"],
Cell[121265, 2943, 6204, 138, 463, "Input",ExpressionUUID->"751cb34e-5132-4079-9042-ce30049ea319"]
}, Closed]],
Cell[CellGroupData[{
Cell[127506, 3086, 178, 3, 91, "Title",ExpressionUUID->"5a3a3e1d-f27d-43c0-b2b2-1e5928aa479d"],
Cell[127687, 3091, 284, 7, 45, "Text",ExpressionUUID->"1415cb93-4b04-4cb2-959b-6a17fceb7fdb"],
Cell[127974, 3100, 17419, 344, 1277, "Input",ExpressionUUID->"5a683087-6769-48aa-a98b-e2a85730a676"]
}, Closed]],
Cell[CellGroupData[{
Cell[145430, 3449, 362, 6, 91, "Title",ExpressionUUID->"b720bbc5-22a5-423a-bc30-2c9c18f99b35"],
Cell[145795, 3457, 641, 13, 75, "Text",ExpressionUUID->"246e49dc-2627-4f96-b123-14166c8ea7ee"],
Cell[146439, 3472, 10521, 239, 880, "Input",ExpressionUUID->"92b76d96-921d-4849-a40c-d06b5af83e61"]
}, Closed]],
Cell[CellGroupData[{
Cell[156997, 3716, 221, 4, 91, "Title",ExpressionUUID->"22ed8e9a-ac08-49b1-a105-ccaa93207ba4"],
Cell[157221, 3722, 203, 3, 45, "Text",ExpressionUUID->"33f00c93-f20f-42d8-bde1-743c401a23cc"],
Cell[157427, 3727, 1386, 37, 211, "Input",ExpressionUUID->"c55ec3d7-8d3f-4fab-8804-a4ea848a2cb1"]
}, Closed]],
Cell[CellGroupData[{
Cell[158850, 3769, 218, 4, 91, "Title",ExpressionUUID->"8258dbe0-d1fc-429e-b0fe-ea1230796fe6"],
Cell[159071, 3775, 203, 3, 45, "Text",ExpressionUUID->"be60d8d7-f0cb-4095-b82c-19e8939f49b4"],
Cell[159277, 3780, 26463, 596, 2164, "Input",ExpressionUUID->"1563a7cb-eece-4d24-ae39-9fc8fff20e3b"]
}, Closed]],
Cell[CellGroupData[{
Cell[185777, 4381, 173, 3, 91, "Title",ExpressionUUID->"d50f385e-4539-490d-b5a5-aafb6b65b078"],
Cell[185953, 4386, 449, 11, 45, "Text",ExpressionUUID->"bd19fffe-c90d-4430-8d32-8e9cca6e1e30"],
Cell[CellGroupData[{
Cell[186427, 4401, 22902, 527, 1545, "Input",ExpressionUUID->"9b433723-f3b4-4c41-a9c6-27561d0be08d"],
Cell[209332, 4930, 36030, 617, 70, "Output",ExpressionUUID->"b4d506ec-364d-4188-8954-99ac627b1b25"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[245411, 5553, 215, 4, 91, "Title",ExpressionUUID->"1b7279de-0e9a-4073-b020-f91d9b567541"],
Cell[245629, 5559, 201, 3, 45, "Text",ExpressionUUID->"6e5294df-fd8c-47fb-85ca-cd85145d1851"],
Cell[245833, 5564, 29534, 721, 2656, "Input",ExpressionUUID->"482e93db-e6df-423f-ba70-4d0a435202b3"]
}, Closed]],
Cell[CellGroupData[{
Cell[275404, 6290, 173, 3, 91, "Title",ExpressionUUID->"8aeea5b5-47a5-4bfc-91b2-e38b668c0d13"],
Cell[275580, 6295, 583, 10, 105, "Text",ExpressionUUID->"54680546-436d-411a-b1b4-4c7c938a4711"],
Cell[276166, 6307, 23413, 557, 1654, "Input",ExpressionUUID->"d1a38189-a75f-495a-8e90-0c9d80700ad3"]
}, Closed]],
Cell[CellGroupData[{
Cell[299616, 6869, 165, 3, 91, "Title",ExpressionUUID->"d8e321cb-8dd8-47b4-8dd2-a1cdcb039ab4"],
Cell[299784, 6874, 369, 7, 75, "Text",ExpressionUUID->"abc3d507-0518-4b9a-a98d-7d6f72638fbd"],
Cell[300156, 6883, 33751, 784, 2227, "Input",ExpressionUUID->"7d6aac12-cf9b-4179-a52e-ac2b6dc47746"]
}, Closed]]
}
]
*)

