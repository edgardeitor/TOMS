(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    344825,       7836]
NotebookOptionsPosition[    338749,       7730]
NotebookOutlinePosition[    339227,       7748]
CellTagsIndexPosition[    339184,       7745]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Clearing Variables", "Title",
 CellChangeTimes->{{3.8954751959788213`*^9, 
  3.8954752006811113`*^9}},ExpressionUUID->"ea61d8e4-711d-4d74-b25b-\
761ac764db40"],

Cell["\<\
This section just clears all the variables that have been already defined in \
Mathematica\
\>", "Text",
 CellChangeTimes->{{3.896873793156684*^9, 
  3.896873815190978*^9}},ExpressionUUID->"fb852f10-685d-44ae-b15a-\
4cf30567a1b9"],

Cell[BoxData[
 RowBox[{"Quiet", "@", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"4dd8c56a-24c9-40ec-9db2-0034b1e9c701"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameters", "Title",
 CellChangeTimes->{{3.895427920732616*^9, 3.8954279223516064`*^9}, {
  3.896907248589121*^9, 3.896907248777932*^9}, {3.8969641981821823`*^9, 
  3.8969641992041736`*^9}},ExpressionUUID->"64324ed7-52be-4b1e-98cb-\
d02a137df024"],

Cell["\<\
This section is to set all the parameters of the system, including tolerances \
and parameters that are set to indicate Mathematica what wants to be computed\
\>", "Text",
 CellChangeTimes->{{3.896873825260089*^9, 
  3.8968738898988423`*^9}},ExpressionUUID->"edf22f9a-7a61-4ca6-96ad-\
ede52a777aa8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "9"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Choptol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "9"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"disttol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "6"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmax", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialt", "=", 
   RowBox[{"-", "1000"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalt", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"smalldifferential", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curvespeed", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberofzerotemporalderivatives", "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqbool", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpleeq", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timedifference", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"criticalitychanges", "=", "\"\<y\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cod2", "=", "\"\<y\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"crosscoef", "=", "\"\<n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"{", 
    RowBox[{"u", ",", "v", ",", "w", ",", "z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"par", "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", "a"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parnames", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"crosspar", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parval", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "->", "1.00311"}], ",", 
     RowBox[{"a", "->", "0.0310302"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fixedpar", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c", "->", "0.01"}], ",", 
     RowBox[{"\[Eta]", "->", "0.05"}], ",", 
     RowBox[{"\[Epsilon]", "->", "0.025"}], ",", 
     RowBox[{
      SubscriptBox["\[Lambda]", "0"], "->", "0"}], ",", 
     RowBox[{
      SubscriptBox["\[Delta]", "1"], "->", "0.2"}], ",", 
     RowBox[{
      SubscriptBox["\[Delta]", "2"], "->", "0.05"}], ",", 
     RowBox[{
      SubscriptBox["\[Mu]", "1"], "->", "0.19"}], ",", 
     RowBox[{
      SubscriptBox["\[Mu]", "2"], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialvalueTuring", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"b", ",", "1.00311"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intervalx", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intervaly", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "8"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"par3", "=", 
   RowBox[{"{", 
    RowBox[{"b", ",", 
     SubscriptBox["\[Lambda]", "0"], ",", "a"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"par3name", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extrainterval", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"otherTuring", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.5", ",", "1"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8954279584311247`*^9, 3.8954279793477287`*^9}, {
   3.895428046269772*^9, 3.8954280474457483`*^9}, {3.8954281115780554`*^9, 
   3.895428112169461*^9}, {3.8954282439796886`*^9, 3.8954282449905586`*^9}, {
   3.8954287450542436`*^9, 3.8954287614847617`*^9}, {3.895428932817608*^9, 
   3.895428933547702*^9}, {3.8954289690397873`*^9, 3.8954289701566887`*^9}, {
   3.8954324512423363`*^9, 3.89543248765158*^9}, {3.8954326858485527`*^9, 
   3.895432686580777*^9}, {3.8954343381346316`*^9, 3.895434352378853*^9}, {
   3.895435386093203*^9, 3.895435392422604*^9}, {3.8954749139291105`*^9, 
   3.8954749142690797`*^9}, {3.8954751909245663`*^9, 3.895475209553584*^9}, {
   3.895475530346212*^9, 3.895475567367071*^9}, {3.895475704879484*^9, 
   3.8954757403294373`*^9}, {3.895480919360569*^9, 3.8954809230323524`*^9}, {
   3.8956478730793495`*^9, 3.895647918541531*^9}, {3.895650043475133*^9, 
   3.8956500438174953`*^9}, {3.8956500811581297`*^9, 
   3.8956500813877087`*^9}, {3.8956501284524*^9, 3.8956501382474136`*^9}, {
   3.8956502465399227`*^9, 3.8956502557286887`*^9}, 3.895650725558692*^9, {
   3.895659094534528*^9, 3.89565909479698*^9}, 3.895659992655587*^9, {
   3.895669338846998*^9, 3.895669339263445*^9}, {3.8956694499036856`*^9, 
   3.895669451357782*^9}, {3.895675717487457*^9, 3.8956757179262857`*^9}, {
   3.8956894970613256`*^9, 3.8956895121797733`*^9}, {3.895692010905773*^9, 
   3.895692016169233*^9}, {3.895756291749323*^9, 3.895756366446519*^9}, {
   3.8957578974904623`*^9, 3.8957579061444445`*^9}, {3.8957581264546776`*^9, 
   3.8957581988342476`*^9}, {3.895758586247681*^9, 3.895758605771484*^9}, {
   3.8957587090164824`*^9, 3.8957587187348733`*^9}, {3.895758843238387*^9, 
   3.8957588582449007`*^9}, {3.895760448019987*^9, 3.895760450946477*^9}, {
   3.8958187869103174`*^9, 3.8958187873142247`*^9}, 3.8958188418199415`*^9, {
   3.8958191955359535`*^9, 3.895819225325616*^9}, {3.8958194132473173`*^9, 
   3.8958194135932255`*^9}, {3.895819517585163*^9, 3.895819581115199*^9}, {
   3.8958196187141714`*^9, 3.8958196650049896`*^9}, {3.895843687512045*^9, 
   3.895843704124234*^9}, {3.8958438872868023`*^9, 3.895843902486864*^9}, {
   3.896345831332492*^9, 3.896345834204544*^9}, {3.8963511793541937`*^9, 
   3.8963511799442263`*^9}, {3.8968738951216125`*^9, 
   3.8968743387422266`*^9}, {3.8968744470693717`*^9, 3.896874540147649*^9}, {
   3.8968745760210156`*^9, 3.8968747191830764`*^9}, {3.896874809509102*^9, 
   3.8968749006747904`*^9}, {3.8968750137950115`*^9, 
   3.8968752088380175`*^9}, {3.8968753932128143`*^9, 
   3.8968753994867764`*^9}, {3.896876608287466*^9, 3.8968766443380823`*^9}, {
   3.8969040989155025`*^9, 3.8969042353854446`*^9}, {3.896904507973996*^9, 
   3.896904607853557*^9}, 3.896907238618849*^9, {3.8969641886030173`*^9, 
   3.8969641920031433`*^9}},ExpressionUUID->"cc69dd3d-cbfb-4595-8acd-\
5d98b925aded"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kinetics", "Title",
 CellChangeTimes->{{3.895235772884898*^9, 
  3.8952357743031654`*^9}},ExpressionUUID->"4ef2af19-48fd-4c88-b205-\
32b86bb1aa82"],

Cell["\<\
Provide the kinetics and the diffusion matrix in this section on the \
variables \[OpenCurlyDoubleQuote]kinetics\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]diffmatrix\[CloseCurlyDoubleQuote], respectively. In \
this section, Mathematica will also find the homogeneous steady states if \
requested\
\>", "Text",
 CellChangeTimes->{{3.896875223393263*^9, 
  3.8968752947811546`*^9}},ExpressionUUID->"5554f862-fa6d-4737-b089-\
27d14a42d11b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nvar", "=", 
   RowBox[{"Length", "[", "var", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kinetics", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Lambda]", "0"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "u"}], " ", "+", " ", "w"}], ")"}]}], "+", 
         RowBox[{"\[Eta]", "*", 
          RowBox[{"(", 
           RowBox[{"a", "+", 
            RowBox[{
             SuperscriptBox["u", "2"], "*", "v"}], "-", 
            RowBox[{"u", "*", 
             RowBox[{"(", 
              RowBox[{"b", "+", "1"}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Lambda]", "0"]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "u"}], "+", "w"}], ")"}]}], "+", 
         RowBox[{"\[Eta]", "*", 
          RowBox[{"(", 
           RowBox[{"a", "+", 
            RowBox[{
             SuperscriptBox["u", "2"], "*", "v"}], "-", 
            RowBox[{"u", "*", 
             RowBox[{"(", 
              RowBox[{"b", "+", "1"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Lambda]", "0"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "v"}], "+", "z"}], ")"}]}], "+", 
         RowBox[{"\[Eta]", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", "*", "u"}], "-", 
            RowBox[{
             SuperscriptBox["u", "2"], "*", "v"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Lambda]", "0"]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "v"}], "+", "z"}], ")"}]}], "+", 
         RowBox[{"\[Eta]", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", "*", "u"}], "-", 
            RowBox[{
             SuperscriptBox["u", "2"], "*", "v"}]}], ")"}]}]}], ")"}]}]}], 
     ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Lambda]", "0"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]", "*", 
          RowBox[{"(", 
           RowBox[{"u", "-", "w"}], ")"}]}], "+", 
         RowBox[{"\[Eta]", "*", 
          RowBox[{"(", 
           RowBox[{"a", "+", 
            RowBox[{
             SuperscriptBox["w", "2"], "*", "z"}], "-", 
            RowBox[{"w", "*", 
             RowBox[{"(", 
              RowBox[{"b", "+", "1"}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Lambda]", "0"]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", "*", 
          RowBox[{"(", 
           RowBox[{"u", "-", "w"}], ")"}]}], "+", 
         RowBox[{"\[Eta]", "*", 
          RowBox[{"(", 
           RowBox[{"a", "+", 
            RowBox[{
             SuperscriptBox["w", "2"], "*", "z"}], "-", 
            RowBox[{"w", "*", 
             RowBox[{"(", 
              RowBox[{"b", "+", "1"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Lambda]", "0"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]", "*", 
          RowBox[{"(", 
           RowBox[{"v", "-", "z"}], ")"}]}], "+", 
         RowBox[{"\[Eta]", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", "*", "w"}], "-", 
            RowBox[{
             SuperscriptBox["w", "2"], "*", "z"}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Lambda]", "0"]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", "*", 
          RowBox[{"(", 
           RowBox[{"v", "-", "z"}], ")"}]}], "+", 
         RowBox[{"\[Eta]", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", "*", "w"}], "-", 
            RowBox[{
             SuperscriptBox["w", "2"], "*", "z"}]}], ")"}]}]}], ")"}]}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diffmatrix", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Delta]", "1"], "*", 
        SubscriptBox["\[Lambda]", "0"]}], "+", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Delta]", "2"], "2"], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SubscriptBox["\[Lambda]", "0"]}], ")"}]}]}], ",", "1", ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Delta]", "1"], "*", 
        SubscriptBox["\[Mu]", "1"], "*", 
        SubscriptBox["\[Lambda]", "0"]}], "+", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[Delta]", "2"], "2"], "*", 
        SubscriptBox["\[Mu]", "2"], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SubscriptBox["\[Lambda]", "0"]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "*", 
        SubscriptBox["\[Lambda]", "0"]}], "+", 
       RowBox[{
        SubscriptBox["\[Mu]", "2"], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SubscriptBox["\[Lambda]", "0"]}], ")"}]}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"eqbool", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqs", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"kinetics", "==", "0"}], ",", "var"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "eqs", "]"}], ">", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Your system has \>\"", " ", "<>", " ", 
              RowBox[{"ToString", "[", 
               RowBox[{"Length", "[", "eqs", "]"}], "]"}], " ", "<>", " ", 
              "\"\< equilibria\>\""}], "}"}], "]"}], ",", "\"\<Output\>\""}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"eqnum", "=", "1"}], ",", 
         RowBox[{"eqnum", "<=", 
          RowBox[{"Length", "[", "eqs", "]"}]}], ",", 
         RowBox[{"eqnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SelectionMove", "[", 
           RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"NotebookWrite", "[", 
           RowBox[{"aux", ",", 
            RowBox[{"Cell", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<Equilibrium number \>\"", " ", "<>", " ", 
                  RowBox[{"ToString", "[", "eqnum", "]"}], " ", "<>", " ", 
                  "\"\< is equal to \>\""}], ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"eqs", "[", 
                    RowBox[{"[", "eqnum", "]"}], "]"}], ",", 
                   RowBox[{"FormatType", "->", "StandardForm"}]}], "]"}]}], 
                "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnumber", "=", 
        RowBox[{
        "Input", "[", 
         "\"\<Enter the number of the equilibrium point you would like to \
consider. Enter 0 if the software did not find your desired homogeneous \
steady-state or you want to consider them all\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookClose", "[", "aux", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"eqnumber", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eq", "=", 
           RowBox[{"{", "0", "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eq", "=", 
           RowBox[{
            RowBox[{"eqs", "[", 
             RowBox[{"[", "eqnumber", "]"}], "]"}], "//", "Simplify"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]",
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Mathematica found only one homogeneous steady-state in your \
system. It will proceed with that one.\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eq", "=", 
        RowBox[{
         RowBox[{"eqs", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq", "=", 
     RowBox[{"{", "0", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jacmat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"kinetics", ",", 
     RowBox[{"{", "var", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8906780445102253`*^9, 3.890678111040274*^9}, {
   3.8906781795127645`*^9, 3.8906784723669205`*^9}, {3.8906785744092817`*^9, 
   3.8906785839304657`*^9}, {3.8906787332421875`*^9, 
   3.8906787671951303`*^9}, {3.8906789819966283`*^9, 
   3.8906789824024916`*^9}, {3.8906790253463373`*^9, 3.890679035958171*^9}, {
   3.890820891985819*^9, 3.8908209526656675`*^9}, {3.8908212019136896`*^9, 
   3.890821214519494*^9}, {3.890837938573892*^9, 3.8908379389418235`*^9}, {
   3.8908382727067757`*^9, 3.8908382957217493`*^9}, {3.8908387008302355`*^9, 
   3.8908387038880215`*^9}, {3.8910083771331935`*^9, 
   3.8910083788524365`*^9}, {3.8910117811657915`*^9, 
   3.8910118162434745`*^9}, {3.891278238460943*^9, 3.891278263877515*^9}, {
   3.8912786161584015`*^9, 3.8912786250376377`*^9}, {3.89127870864843*^9, 
   3.8912787270360756`*^9}, {3.891359625495322*^9, 3.8913596282053213`*^9}, {
   3.8913671468534007`*^9, 3.8913671591708355`*^9}, {3.891411787963504*^9, 
   3.891411790255947*^9}, {3.8915052309278564`*^9, 3.8915052315753045`*^9}, {
   3.895235012316103*^9, 3.895235012854446*^9}, {3.8952350873704386`*^9, 
   3.895235125268959*^9}, {3.895235765202467*^9, 3.8952358013314924`*^9}, {
   3.895236341392643*^9, 3.895236357512231*^9}, {3.895236445138153*^9, 
   3.8952364766744957`*^9}, {3.895237058595951*^9, 3.8952370951082315`*^9}, {
   3.895388155978882*^9, 3.8953881641251416`*^9}, {3.8953936835232267`*^9, 
   3.895393697173332*^9}, {3.895397325992364*^9, 3.8953973492203894`*^9}, {
   3.895399144623319*^9, 3.8953991451181927`*^9}, {3.8953992207896357`*^9, 
   3.895399227346514*^9}, 3.895425360033792*^9, {3.8954255588244505`*^9, 
   3.895425559316889*^9}, {3.8954256889194355`*^9, 3.895425689181632*^9}, {
   3.8954258540533*^9, 3.8954258542957*^9}, {3.8954261202773647`*^9, 
   3.8954261451925635`*^9}, {3.8954263798239727`*^9, 3.895426380093327*^9}, {
   3.8954264195342565`*^9, 3.8954264198323936`*^9}, {3.8954269344055133`*^9, 
   3.895426934681567*^9}, {3.895427185972866*^9, 3.8954272404195886`*^9}, {
   3.895427467813653*^9, 3.8954274679638987`*^9}, {3.8954275154645133`*^9, 
   3.8954275271506853`*^9}, {3.895427605450692*^9, 3.8954276412437615`*^9}, {
   3.8954279351491203`*^9, 3.8954279435683675`*^9}, {3.8954281159799*^9, 
   3.8954281166961107`*^9}, 3.8954281579797754`*^9, {3.895428238357767*^9, 
   3.8954282402653947`*^9}, {3.895658672283351*^9, 3.8956586758470488`*^9}, {
   3.8956587442102966`*^9, 3.895658775516533*^9}, 3.8956588845424643`*^9, 
   3.895660012819561*^9, {3.895669176646825*^9, 3.8956691804870205`*^9}, {
   3.895669282131542*^9, 3.8956692951223326`*^9}, {3.895756390242838*^9, 
   3.895756402623145*^9}, {3.8957582128860664`*^9, 3.895758258119711*^9}, {
   3.895758570600191*^9, 3.895758574517352*^9}, 3.895819240073947*^9, {
   3.8958363884659786`*^9, 3.8958364148518105`*^9}, {3.8969060283997135`*^9, 
   3.896906037067047*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"5cbca695-ca74-488b-a139-a446b3ff92a4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kernel of the Jacobian matrix", "Title",
 CellChangeTimes->{{3.8952358174342804`*^9, 3.895235823044009*^9}, {
  3.8954272089623084`*^9, 
  3.8954272093927565`*^9}},ExpressionUUID->"b4b8a194-920c-498a-838c-\
7ef029e5294d"],

Cell["\<\
Mathematica finds the kernel of the Jacobian matrix, after finding an \
invertible (n - 1)x(n - 1) submatrix on it, if the parameters for a \
bifurcation were provided.\
\>", "Text",
 CellChangeTimes->{{3.8968753077334957`*^9, 
  3.8968753761997833`*^9}},ExpressionUUID->"b4d74d42-b282-4d76-a057-\
3e600b12bab6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dummymat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dmat", 
      RowBox[{"row", ",", "col"}]], ",", 
     RowBox[{"{", 
      RowBox[{"row", ",", "nvar"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dummyvec", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dvec", "varnum"], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jacobianmat", "=", 
   RowBox[{"jacmat", "-", 
    RowBox[{"\[Mu]NF", "*", "diffmatrix"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerodet", "=", 
   RowBox[{"Det", "[", "dummymat", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerodet", "=", 
   RowBox[{"zerodet", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dummymat", "[", 
         RowBox[{"[", 
          RowBox[{"row", ",", "col"}], "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"jacobianmat", "[", 
          RowBox[{"[", 
           RowBox[{"row", ",", "col"}], "]"}], "]"}], "-", 
         RowBox[{"\[Lambda]NF", "*", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "nvar", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"row", ",", "col"}], "]"}], "]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"row", ",", "nvar"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonzero", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"zerodet", ",", "\[Lambda]NF"}], "]"}], "/.", 
    RowBox[{"\[Lambda]NF", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerodet", "=", 
   RowBox[{"zerodet", "/.", 
    RowBox[{"\[Lambda]NF", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeroder", "=", 
   RowBox[{"D", "[", 
    RowBox[{"zerodet", ",", "\[Mu]NF"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "eq", "]"}], ">", "1"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Mu]val", "=", 
      RowBox[{"Quiet", "@", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"zeroder", "==", "0"}], "/.", "eq"}], "/.", "fixedpar"}], 
          "/.", "parval"}], ",", "\[Mu]NF"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"solnum", "=", "1"}], ",", 
       RowBox[{"solnum", "<=", 
        RowBox[{"Length", "[", "\[Mu]val", "]"}]}], ",", 
       RowBox[{"solnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", 
                 RowBox[{
                  RowBox[{"\[Mu]NF", "/.", 
                   RowBox[{"\[Mu]val", "[", 
                    RowBox[{"[", "solnum", "]"}], "]"}]}], ",", "Choptol"}], 
                 "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Abs", "[", "zerodet", "]"}], "<", "tol"}]}], "/.", 
              RowBox[{"\[Mu]val", "[", 
               RowBox[{"[", "solnum", "]"}], "]"}]}], "/.", "eq"}], "/.", 
            "fixedpar"}], "/.", "parval"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Mu]val", "=", 
            RowBox[{"\[Mu]val", "[", 
             RowBox[{"[", "solnum", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "==", 
           RowBox[{"Length", "[", "\[Mu]val", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", 
           "\"\<You are not actually at a Turing bifurcation\>\"", "]"}]}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["v", "varnum"], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ValueQ", "[", "\[Mu]val", "]"}], " ", "&&", " ", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"\[Mu]val", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "0"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getout", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"row", "=", "1"}], ",", 
       RowBox[{"row", "<=", "nvar"}], ",", 
       RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"getout", "==", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Break", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"col", "=", "1"}], ",", 
          RowBox[{"col", "<=", "nvar"}], ",", 
          RowBox[{"col", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"submatrixrows", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Range", "[", "nvar", "]"}], ",", 
              RowBox[{"{", "row", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"submatrixcols", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Range", "[", "nvar", "]"}], ",", 
              RowBox[{"{", "col", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"jacobianmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], 
                    "]"}], "/.", "\[Mu]val"}], "/.", "eq"}], "/.", 
                 "fixedpar"}], "/.", "parval"}], "]"}], "!=", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"criticalrow", "=", "row"}], ";", "\[IndentingNewLine]", 
              RowBox[{"criticalcol", "=", "col"}], ";", "\[IndentingNewLine]", 
              RowBox[{"getout", "=", "1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"criticalrow", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"criticalcol", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"submatrixrows", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "nvar", "]"}], ",", 
        RowBox[{"{", "criticalrow", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submatrixcols", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "nvar", "]"}], ",", 
        RowBox[{"{", "criticalcol", "}"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{"[", "criticalcol", "]"}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]sol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"jacobianmat", "[", 
          RowBox[{"[", 
           RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], "]"}], ",", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"[", "submatrixcols", "]"}], "]"}]}], "]"}], "==", 
       RowBox[{"-", 
        RowBox[{"jacobianmat", "[", 
         RowBox[{"[", 
          RowBox[{"submatrixrows", ",", 
           RowBox[{"{", "criticalcol", "}"}]}], "]"}], "]"}]}]}], ",", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"[", "submatrixcols", "]"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"\[Phi]", "/.", "\[Phi]sol"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"varnum", "=", "1"}], ",", 
   RowBox[{"varnum", "<=", "nvar"}], ",", 
   RowBox[{"varnum", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"varnum", "<=", 
      RowBox[{"nvar", "-", "numberofzerotemporalderivatives"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], "=", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], "=", "0"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["sol", 
    RowBox[{"1", ",", "1"}]], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["W", 
        RowBox[{"1", ",", "1", ",", "varnum"}]], "[", "X", "]"}], "->", 
      RowBox[{
       RowBox[{
        SubscriptBox["A", "1"], "[", "X", "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dersol", 
    RowBox[{"1", ",", "1"}]], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["sol", 
      RowBox[{"1", ",", "1"}]], ",", "X"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["der2sol", 
    RowBox[{"1", ",", "1"}]], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["dersol", 
      RowBox[{"1", ",", "1"}]], ",", "X"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8908379421660953`*^9, 3.890837946760846*^9}, {
   3.8908380222019863`*^9, 3.8908382649902353`*^9}, {3.890838365633258*^9, 
   3.890838426499406*^9}, {3.890838479992857*^9, 3.890838482586275*^9}, {
   3.890838607433332*^9, 3.8908386239350843`*^9}, {3.890838673494182*^9, 
   3.8908386737417946`*^9}, {3.891008642610325*^9, 3.891008644034711*^9}, {
   3.8910087260908203`*^9, 3.8910087975807967`*^9}, {3.8910118244593515`*^9, 
   3.8910118523420944`*^9}, {3.8910119824088306`*^9, 
   3.8910119826545744`*^9}, {3.891278350096554*^9, 3.8912783923494434`*^9}, {
   3.891278458954806*^9, 3.8912784660273476`*^9}, {3.891278501955251*^9, 
   3.89127850611102*^9}, 3.8912786009765697`*^9, {3.8912786331950736`*^9, 
   3.8912786879474154`*^9}, 3.8912804114370003`*^9, {3.8913612177548866`*^9, 
   3.891361227008133*^9}, {3.891364034104721*^9, 3.8913640610554056`*^9}, {
   3.891364107204362*^9, 3.8913641086450863`*^9}, {3.8913641469071274`*^9, 
   3.891364174366186*^9}, {3.891364208732103*^9, 3.891364220034178*^9}, {
   3.8913642564583707`*^9, 3.8913642807167935`*^9}, {3.8913643270564504`*^9, 
   3.8913643358626833`*^9}, {3.89136439009624*^9, 3.891364491301955*^9}, {
   3.8913663064801884`*^9, 3.8913663662993965`*^9}, {3.891366522555418*^9, 
   3.891366609210707*^9}, {3.891367171183612*^9, 3.8913671822246265`*^9}, {
   3.8913675577347636`*^9, 3.891367558153657*^9}, {3.8914134941734686`*^9, 
   3.8914135077422967`*^9}, {3.891413715633811*^9, 3.8914137160588055`*^9}, {
   3.8914138770782223`*^9, 3.891413895491497*^9}, {3.8914139449896317`*^9, 
   3.891413971203255*^9}, {3.891414030453076*^9, 3.89141405585074*^9}, {
   3.8914337082728815`*^9, 3.8914337114239798`*^9}, {3.891436168612285*^9, 
   3.8914361888684034`*^9}, {3.89143870885564*^9, 3.891438715505005*^9}, {
   3.891439447339345*^9, 3.891439463429737*^9}, {3.8952351757753725`*^9, 
   3.895235487469984*^9}, {3.8952355477364445`*^9, 3.8952355595561967`*^9}, {
   3.895235855996832*^9, 3.895235914451939*^9}, {3.895236246289893*^9, 
   3.895236251791911*^9}, 3.895236520005498*^9, {3.8952366208132496`*^9, 
   3.8952366599519987`*^9}, {3.8952367421895084`*^9, 
   3.8952367462766495`*^9}, {3.8952368169516697`*^9, 3.895236845765771*^9}, {
   3.8952368778025265`*^9, 3.895236915236767*^9}, {3.8952371216206827`*^9, 
   3.8952371260016947`*^9}, {3.895237192767122*^9, 3.895237199850296*^9}, {
   3.895237408805979*^9, 3.8952374112973557`*^9}, {3.8952375588551593`*^9, 
   3.8952375590845704`*^9}, {3.8952411886409626`*^9, 3.895241220504713*^9}, {
   3.8952417060403585`*^9, 3.8952417293689284`*^9}, {3.8952417597882147`*^9, 
   3.8952417783894787`*^9}, {3.895393730860072*^9, 3.8953937791531734`*^9}, {
   3.8953938101744404`*^9, 3.8953938138031025`*^9}, {3.8953938576330137`*^9, 
   3.895393910978653*^9}, {3.8953940010407352`*^9, 3.8953940081864667`*^9}, {
   3.8953940410956645`*^9, 3.8953940428038034`*^9}, 3.8953955571175847`*^9, {
   3.895399236559389*^9, 3.895399246451634*^9}, {3.8954261788249826`*^9, 
   3.8954261798863125`*^9}, {3.895426216467985*^9, 3.895426263961667*^9}, {
   3.8954269583481116`*^9, 3.895426974379551*^9}, {3.895427020312051*^9, 
   3.8954270742402925`*^9}, {3.895428175911461*^9, 3.895428184280898*^9}, 
   3.895428223199233*^9, {3.8954318954029365`*^9, 3.8954319810627813`*^9}, 
   3.895432148649288*^9, {3.8954322564973297`*^9, 3.895432284718607*^9}, {
   3.8956432237181787`*^9, 3.89564325345604*^9}, {3.8956442858563457`*^9, 
   3.895644304309688*^9}, {3.8956664101122203`*^9, 3.8956664115739717`*^9}, {
   3.8957579460792184`*^9, 3.8957580462823725`*^9}, {3.8957595945827866`*^9, 
   3.8957596121874332`*^9}, {3.8957597573003397`*^9, 
   3.8957597779536095`*^9}, {3.8957599582635236`*^9, 3.895759987428463*^9}, {
   3.8957609203735356`*^9, 3.895760923095827*^9}, {3.8957610656304965`*^9, 
   3.895761068347578*^9}, {3.8958364676425543`*^9, 3.8958364683926353`*^9}, {
   3.8958428950809965`*^9, 3.895842954520792*^9}, {3.8958429870253105`*^9, 
   3.8958430538461485`*^9}, 3.8958434352304773`*^9, {3.8958435394691396`*^9, 
   3.8958435434784813`*^9}, {3.896344725950115*^9, 3.896344734872848*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"ba1473d1-5aed-4060-aac2-2c3cb7a6c1f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kernel of the adjoint", "Title",
 CellChangeTimes->{{3.895235922290038*^9, 3.895235925682999*^9}, {
  3.896367021269752*^9, 
  3.896367021574452*^9}},ExpressionUUID->"5cafe80f-fe2b-43f2-bc97-\
220a654ba175"],

Cell["\<\
Mathematica finds the kernel of the transpose of the Jacobian matrix, using \
the same submatrix used before.\
\>", "Text",
 CellChangeTimes->{{3.89687543375546*^9, 
  3.896875474093751*^9}},ExpressionUUID->"ae428f0a-a208-480c-87b1-\
50551fc4c33b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["v", "varnum"], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "[", 
    RowBox[{"[", "criticalrow", "]"}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]sol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"jacobianmat", "[", 
           RowBox[{"[", 
            RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], "]"}], 
          "]"}], ",", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"[", "submatrixrows", "]"}], "]"}]}], "]"}], "==", 
       RowBox[{"-", 
        RowBox[{"Transpose", "[", 
         RowBox[{"jacobianmat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"{", "criticalrow", "}"}], ",", "submatrixcols"}], "]"}], 
          "]"}], "]"}]}]}], ",", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"[", "submatrixrows", "]"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"\[Psi]", "/.", "\[Psi]sol"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8910064420472236`*^9, 3.891006549455819*^9}, {
   3.891006637611881*^9, 3.8910066458966446`*^9}, {3.891278394256345*^9, 
   3.8912784204155545`*^9}, 3.8913675607521257`*^9, {3.8914356032726283`*^9, 
   3.891435603484974*^9}, 3.8952359347473354`*^9, 3.895237241468288*^9, {
   3.895758057977438*^9, 3.8957580912663546`*^9}, {3.895759315833376*^9, 
   3.8957593268934336`*^9}, {3.895759575754737*^9, 3.8957595759442425`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"a3894b42-9b16-446b-99f4-b500710381cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bifurcation curves", "Title",
 CellChangeTimes->{{3.8954278300192676`*^9, 3.89542783307276*^9}, {
  3.8963597852607503`*^9, 
  3.896359785550768*^9}},ExpressionUUID->"4488db71-1104-4303-b187-\
bae35678313d"],

Cell["\<\
Mathematica finds the bifurcation curves satisfying all the constraints \
imposed by the kinetics and the Turing conditions. To do that, it solves an \
initial value problem starting at a bifurcation point found using the lines \
to search defined above.\
\>", "Text",
 CellChangeTimes->{{3.8968754831658187`*^9, 
  3.896875630069837*^9}},ExpressionUUID->"87af798e-5705-4784-8e1b-\
1bc1ecdc431f"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "par", "]"}], "==", "2"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"variabledependence", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "varnum", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"kineticsaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"kinetics", "/.", "fixedpar"}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zerodetaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"zerodet", "/.", "fixedpar"}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zeroderaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"zeroder", "/.", "fixedpar"}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", "zeroderaux"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"D", "[", 
      RowBox[{"equations", ",", "time"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{"\[Mu]NF", "'"}], "[", "time", "]"}], "2"], "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"varnum", "=", "1"}], "nvar"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
         "2"]}], "-", 
       SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equations", "[", 
         RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"equationnumber", ",", 
         RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equationsGlobalLP", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"kineticsaux", ",", 
       RowBox[{"zerodetaux", "/.", 
        RowBox[{
         RowBox[{"\[Mu]NF", "[", "time", "]"}], "->", "0"}]}]}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"equationsGlobalLP", "=", 
     RowBox[{"D", "[", 
      RowBox[{"equationsGlobalLP", ",", "time"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equationsGlobalLP", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"varnum", "=", "1"}], "nvar"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
         "2"]}], "-", 
       SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equationsGlobalLP", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equationsGlobalLP", "[", 
         RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"equationnumber", ",", 
         RowBox[{"Length", "[", "equationsGlobalLP", "]"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvar", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", "\[Mu]NF"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvartimedependent", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"allvar", "[", 
         RowBox[{"[", "nvar", "]"}], "]"}], "[", "time", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"nvar", ",", 
         RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"allvarGlobalLP", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvarGlobalLP", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvarGlobalLP", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvarGlobalLPtimedependent", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"allvarGlobalLP", "[", 
         RowBox[{"[", "nvar", "]"}], "]"}], "[", "time", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"nvar", ",", 
         RowBox[{"Length", "[", "allvarGlobalLP", "]"}]}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"numberofbifurcationcurves", "=", 
     RowBox[{"Length", "[", "initialvalueTuring", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"solutioncurves", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"solutioncurvesGlobalLP", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"bifnum", "=", "1"}], ",", 
      RowBox[{"bifnum", "<=", "numberofbifurcationcurves"}], ",", 
      RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fixedparameter", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"par", ",", 
            RowBox[{
             RowBox[{"initialvalueTuring", "[", 
              RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fixedparameter", "==", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"anotherparameter", "=", "2"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"anotherparameter", "=", "1"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "eq", "]"}], "==", "1"}], " ", "||", " ", 
          RowBox[{"simpleeq", "==", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"initialvalues", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"zerodet", ",", "zeroder"}], "}"}], ",", 
                   "kinetics"}], "]"}], "==", "0"}], "/.", "fixedpar"}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "anotherparameter", "]"}], "]"}], ",", 
                   "\[Mu]NF"}], "}"}], ",", "var"}], "]"}], "//", 
               "Evaluate"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"initialvaluesGlobalLP", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", "zerodet", "}"}], ",", "kinetics"}], "]"}], "==",
                   "0"}], "/.", "fixedpar"}], "/.", 
                RowBox[{"\[Mu]NF", "->", "0"}]}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "anotherparameter", "]"}], "]"}], "}"}], ",", 
                 "var"}], "]"}], "//", "Evaluate"}]}], "]"}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"initialvalues", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"zerodet", ",", "zeroder"}], "}"}], "==", "0"}], "/.",
                  "eq"}], "/.", "fixedpar"}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "anotherparameter", "]"}], "]"}], ",", 
                 "\[Mu]NF"}], "}"}], "//", "Evaluate"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"initialvaluesGlobalLP", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"zerodet", "==", "0"}], "/.", 
                  RowBox[{"\[Mu]NF", "->", "0"}]}], "/.", "eq"}], "/.", 
                "fixedpar"}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"par", "[", 
                RowBox[{"[", "anotherparameter", "]"}], "]"}], "//", 
               "Evaluate"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialvalues", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"initialvalues", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "varnum", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "->", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"initialvalues", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "varnum", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"varnum", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"initialvalues", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"initialsolnum", ",", 
            RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"initialvalues", "=", 
        RowBox[{"DeleteDuplicates", "[", "initialvalues", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"initialsolnum", "=", "1"}], ",", 
         RowBox[{"initialsolnum", "<=", 
          RowBox[{"Length", "[", "initialvalues", "]"}]}], ",", 
         RowBox[{"initialsolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"initialvalueTuring", "[", 
               RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"simpleeq", "==", "1"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Length", "[", "eq", "]"}], ">", "1"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Quiet", " ", "@", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{"var", "\[Element]", "Reals"}], ")"}]}], "/.", 
                   "eq"}], "/.", "fixedpar"}], "/.", 
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ",", 
                RowBox[{"Continue", "[", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"initialvalues", "[", 
               RowBox[{"[", "initialsolnum", "]"}], "]"}], "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"initialvalues", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "/.", "eq"}], "/.", 
                    "fixedpar"}], "/.", 
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ")"}]}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Activate", "[", 
             RowBox[{"Inactivate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"\[Mu]NF", ",", "Choptol"}], "]"}], "!=", "0"}], 
                 " ", "&&", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"Abs", "[", 
                    RowBox[{"{", 
                    RowBox[{"zerodet", ",", "zeroder"}], "}"}], "]"}], "]"}], 
                  "<", "tol"}], " ", "&&", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "eq", "]"}], ">", "1"}], ",", 
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"var", "/.", "eq"}], ")"}], "-", "var"}], "]"}], 
                    "<", "tol"}], ",", "True"}], "]"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<=", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "anotherparameter", "]"}], "]"}], "<=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"nonzero", ",", "Choptol"}], "]"}], "!=", "0"}]}], 
                "/.", "fixedpar"}], "/.", 
               RowBox[{"initialvalues", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}]}], "]"}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dereval", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"varnum", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"initialderivatives", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"equations", "/.", 
                   RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
                  RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"dernumber", "=", "1"}], ",", 
               RowBox[{"dernumber", "<=", 
                RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
               RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equations", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equationsaux", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tempsol", "=", 
                 RowBox[{"Quiet", "@", 
                  RowBox[{"NDSolve", "[", 
                   RowBox[{"equationsaux", ",", "allvar", ",", 
                    RowBox[{"{", 
                    RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], 
                    ",", 
                    RowBox[{"Method", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<EquationSimplification\>\"", "->", 
                    "\"\<Residual\>\""}], "}"}]}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], "&&",
                    " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"solutioncurves", ",", "tempsol"}], "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initialvaluesGlobalLP", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"initialvaluesGlobalLP", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "varnum", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "->", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"initialvaluesGlobalLP", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "varnum", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"varnum", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"initialvaluesGlobalLP", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"initialsolnum", ",", 
            RowBox[{"Length", "[", "initialvaluesGlobalLP", "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialvaluesGlobalLP", "=", 
        RowBox[{"DeleteDuplicates", "[", "initialvaluesGlobalLP", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"initialsolnum", "=", "1"}], ",", 
         RowBox[{"initialsolnum", "<=", 
          RowBox[{"Length", "[", "initialvaluesGlobalLP", "]"}]}], ",", 
         RowBox[{"initialsolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{
            RowBox[{"initialvaluesGlobalLP", "[", 
             RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"initialvalueTuring", "[", 
               RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"simpleeq", "==", "1"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Length", "[", "eq", "]"}], ">", "1"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Quiet", "@", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{"var", "\[Element]", "Reals"}], ")"}]}], "/.", 
                   "eq"}], "/.", "fixedpar"}], "/.", 
                 RowBox[{"initialvaluesGlobalLP", "[", 
                  RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ",", 
                RowBox[{"Continue", "[", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"initialvaluesGlobalLP", "[", 
               RowBox[{"[", "initialsolnum", "]"}], "]"}], "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"initialvaluesGlobalLP", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "/.", "eq"}], "/.", 
                    "fixedpar"}], "/.", 
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ")"}]}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Activate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"zerodet", "/.", 
                    RowBox[{"\[Mu]NF", "->", "0"}]}], "]"}], "<", "tol"}], 
                 " ", "&&", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "eq", "]"}], ">", "1"}], ",", 
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"var", "/.", "eq"}], ")"}], "-", "var"}], "]"}], 
                    "<", "tol"}], ",", "True"}], "]"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<=", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "anotherparameter", "]"}], "]"}], "<=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "]"}], "/.", 
               "fixedpar"}], "/.", 
              RowBox[{"initialvaluesGlobalLP", "[", 
               RowBox[{"[", "initialsolnum", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dereval", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"varnum", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"initialderivatives", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"equationsGlobalLP", "/.", 
                   RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"allvarGlobalLPtimedependent", ",", "time"}], 
                   "]"}], "/.", 
                  RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"dernumber", "=", "1"}], ",", 
               RowBox[{"dernumber", "<=", 
                RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
               RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equationsGlobalLP", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equationsaux", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tempsol", "=", 
                 RowBox[{"Quiet", "@", 
                  RowBox[{"NDSolve", "[", 
                   RowBox[{"equationsaux", ",", "allvarGlobalLP", ",", 
                    RowBox[{"{", 
                    RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], 
                    ",", 
                    RowBox[{"Method", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<EquationSimplification\>\"", "->", 
                    "\"\<Residual\>\""}], "}"}]}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], " ", 
                   "&&", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"solutioncurvesGlobalLP", ",", "tempsol"}], "]"}],
                    ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&",
        " ", 
       RowBox[{
        RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{
            "{", "\"\<This script could not find a Turing bifurcation curve \
or a BD-line for your desired parameters. Try changing tolerances or initial \
values\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}]}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBmIQXfFXofwD61vH2fMO1oBom+meU0F03M7+RSDa9VT0
MjB/McN6EC2y3WgXiD6z6dhREB0QMuMCiO7U8bwEouumz/4Boo228/0G0QvM
Cv+D6BMsRswfgTSX2zJhEL33535REH3V5agsiBaxElYD0T+em5uD6LQNBWDa
5skV1U9Amrf9oAGInnGltBxEH1j+C0zPu1ns8xlIP7rk5g+imW7LRYDoQ0Wq
YPoVl2ACiGbPDMkCi1/pP8LO9tbRwXo5mD5039GVC0jvOcXlDqKvygT7gGiO
5RFgWtchamIkkE4Ucp8Joi1+cO2JBtJi67zA9I8pRkdAdFnL+pMg+pvpJOZE
ID17miQbiF4T9slpPZBWYV7pDqL1Tkj0bWB/6ygfOaEfRDec7jLdDKR/3zGx
ANFhhy+kbQfSTFnZOSD6znzdz7uA9P7LkV9ANAB5CdC7
  "],
 CellLabel->"In[58]:=",ExpressionUUID->"fdb328a8-4025-4938-acf3-217bd8eb2181"]
}, Closed]],

Cell[CellGroupData[{

Cell["Auxiliary variables", "Title",
 CellChangeTimes->{{3.895390247342123*^9, 
  3.8953902504363685`*^9}},ExpressionUUID->"59e5598c-b1a4-495f-b255-\
391127440ca6"],

Cell["\<\
If the third and/or fifth-order coefficients were already found and saved, \
this section only loads the corresponding files. Otherwise, this section \
defines the variables to make the Taylor expansion of the system\
\>", "Text",
 CellChangeTimes->{{3.89687573324382*^9, 
  3.896875807479829*^9}},ExpressionUUID->"14a70aa0-2798-4b9a-8ecd-\
60aaee713a2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coefs", "=", "\"\<y\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"nmax", ">=", "5"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
       "FileExistsQ", "[", "\"\<Third-order coefficient.mx\>\"", "]"}], " ", "&&",
        " ", 
       RowBox[{
       "FileExistsQ", "[", "\"\<Fifth-order coefficient.mx\>\"", "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"C3", "=", 
        RowBox[{"Import", "[", "\"\<Third-order coefficient.mx\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"C5", "=", 
        RowBox[{"Import", "[", "\"\<Fifth-order coefficient.mx\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"coefs", "=", "\"\<n\>\""}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FileExistsQ", "[", "\"\<Third-order coefficient.mx\>\"", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C3", "=", 
       RowBox[{"Import", "[", "\"\<Third-order coefficient.mx\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"coefs", "=", "\"\<n\>\""}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"conjpar", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
           RowBox[{"parval", "[", 
            RowBox[{"[", "parnum", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"parval", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"parnum", ",", 
          RowBox[{"Length", "[", "parval", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conjpar", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"conjpar", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"fixedpar", "[", 
              RowBox[{"[", "parnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"fixedpar", "[", 
             RowBox[{"[", "parnum", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"parnum", ",", 
            RowBox[{"Length", "[", "fixedpar", "]"}]}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"conjpar", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"conjpar", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", "\[Mu]NF", "]"}], "->", "\[Mu]NF"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "[", "kNF", "]"}], "->", "kNF"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["sol", 
       RowBox[{"0", ",", "0"}]], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["W", 
           RowBox[{"0", ",", "0", ",", "varnum"}]], "[", "X", "]"}], "->", 
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["dersol", 
      RowBox[{"0", ",", "0"}]], "=", 
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["sol", 
        RowBox[{"0", ",", "0"}]], ",", "X"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["der2sol", 
      RowBox[{"0", ",", "0"}]], "=", 
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["dersol", 
        RowBox[{"0", ",", "0"}]], ",", "X"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "1"}], ",", 
      RowBox[{"order", "<=", "5"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"sub", "=", "0"}], ",", 
        RowBox[{"sub", "<=", "5"}], ",", 
        RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"EvenQ", "[", "order", "]"}], "&&", " ", 
             RowBox[{"\[Not]", 
              RowBox[{"EvenQ", "[", "sub", "]"}]}]}], ")"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Not]", 
              RowBox[{"EvenQ", "[", "order", "]"}]}], " ", "&&", " ", 
             RowBox[{"EvenQ", "[", "sub", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SubscriptBox["sol", 
             RowBox[{"order", ",", "sub"}]], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["W", 
                 RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                "]"}], "->", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["dersol", 
             RowBox[{"order", ",", "sub"}]], "=", 
            RowBox[{"D", "[", 
             RowBox[{
              SubscriptBox["sol", 
               RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["der2sol", 
             RowBox[{"order", ",", "sub"}]], "=", 
            RowBox[{"D", "[", 
             RowBox[{
              SubscriptBox["dersol", 
               RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"jacobianmat", "=", 
     RowBox[{"jacobianmat", "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"jacobianmatr", "=", 
     RowBox[{
      RowBox[{"jacmat", "-", 
       RowBox[{
        SuperscriptBox["mul", "2"], "*", "\[Mu]NF", "*", "diffmatrix"}]}], "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Psi]", "=", 
     RowBox[{"\[Psi]", "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["sol", 
      RowBox[{"1", ",", "1"}]], "=", 
     RowBox[{
      SubscriptBox["sol", 
       RowBox[{"1", ",", "1"}]], "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["dersol", 
      RowBox[{"1", ",", "1"}]], "=", 
     RowBox[{
      SubscriptBox["dersol", 
       RowBox[{"1", ",", "1"}]], "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["der2sol", 
       RowBox[{"1", ",", "1"}]], "-", 
      SubscriptBox["der2sol", 
       RowBox[{"1", ",", "1"}]]}], "/.", 
     RowBox[{"\[Mu]NF", "->", 
      SuperscriptBox["kNF", "2"]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"conjprime", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "'"}], "[", "y_", "]"}], "->", 
       RowBox[{"HoldForm", "[", 
        FractionBox[
         RowBox[{"Conjugate", "[", 
          RowBox[{"D", "[", 
           RowBox[{"y", ",", "X"}], "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{"y", ",", "X"}], "]"}]], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"toexpand", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox[
                  RowBox[{
                  "var", "\[LeftDoubleBracket]", "varnum", 
                   "\[RightDoubleBracket]"}], "order"], "[", 
                 RowBox[{"x", ",", "X"}], "]"}], "\[Rule]", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"sub", "=", 
                   RowBox[{"-", "order"}]}], "order"], 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                   "]"}], " ", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                   "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", "x"}]]}]}]}],
                "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "p"}], ",", "varnum"}]], "[", "X", "]"}], "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "p", ",", "varnum"}]], "[", "X", 
                    "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"p", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["sol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["sol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["sol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["sol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["sol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["sol", 
       RowBox[{"4", ",", "3"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"toexpandderxx", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox[
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "varnum", 
                    "\[RightDoubleBracket]"}], "order"], "[", 
                   RowBox[{"x", ",", "X"}], "]"}], ",", "x", ",", "x"}], 
                 "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"-", 
                  SuperscriptBox["kNF", "2"]}], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"sub", "=", 
                    RowBox[{"-", "order"}]}], "order"], 
                  RowBox[{
                   SuperscriptBox["r", "2"], "*", 
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                    "]"}], " ", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", 
                    "x"}]]}]}]}]}], "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "index"}], ",", "varnum"}]], "[", "X", "]"}],
                   "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "index", ",", "varnum"}]], "[", "X",
                     "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"index", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["sol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["sol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["sol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["sol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["sol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["sol", 
       RowBox[{"4", ",", "3"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"toexpandderXx", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox[
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "varnum", 
                    "\[RightDoubleBracket]"}], "order"], "[", 
                   RowBox[{"x", ",", "X"}], "]"}], ",", "X", ",", "x"}], 
                 "]"}], "\[Rule]", 
                RowBox[{"\[ImaginaryI]", "*", "kNF", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"sub", "=", 
                    RowBox[{"-", "order"}]}], "order"], 
                  RowBox[{"sub", "*", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "'"}], "[",
                     "X", "]"}], " ", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", 
                    "x"}]]}]}]}]}], "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "index"}], ",", "varnum"}]], "'"}], "[", "X",
                    "]"}], "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "index", ",", "varnum"}]], "'"}], 
                    "[", "X", "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"index", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["dersol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["dersol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["dersol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["dersol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["dersol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["dersol", 
       RowBox[{"4", ",", "3"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"toexpandderXX", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox[
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "varnum", 
                    "\[RightDoubleBracket]"}], "order"], "[", 
                   RowBox[{"x", ",", "X"}], "]"}], ",", "X", ",", "X"}], 
                 "]"}], "\[Rule]", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"sub", "=", 
                   RowBox[{"-", "order"}]}], "order"], 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "''"}], 
                   "[", "X", "]"}], " ", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                   "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", "x"}]]}]}]}],
                "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "index"}], ",", "varnum"}]], "''"}], "[", 
                   "X", "]"}], "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "index", ",", "varnum"}]], "''"}], 
                    "[", "X", "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"index", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["der2sol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["der2sol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["der2sol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["der2sol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["der2sol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["der2sol", 
       RowBox[{"4", ",", "3"}]]}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8910075082946806`*^9, 3.8910075228152714`*^9}, {
   3.8910075706375017`*^9, 3.891007689903224*^9}, {3.8910077460377865`*^9, 
   3.89100774930982*^9}, {3.891007781849799*^9, 3.891007853468502*^9}, {
   3.891008017415059*^9, 3.891008151150443*^9}, {3.891008309202035*^9, 
   3.8910083581326866`*^9}, {3.891008492978525*^9, 3.8910085112878*^9}, {
   3.8910114915883617`*^9, 3.8910114920076375`*^9}, {3.89101165773881*^9, 
   3.891011664017143*^9}, {3.891012046920682*^9, 3.891012074440398*^9}, {
   3.891012184596204*^9, 3.8910122163935204`*^9}, {3.8912780055534644`*^9, 
   3.8912780076960373`*^9}, {3.8912781218703036`*^9, 
   3.8912781221263046`*^9}, {3.891278194962117*^9, 3.8912782303170443`*^9}, {
   3.891278773046852*^9, 3.8912788436643534`*^9}, {3.8912791446026573`*^9, 
   3.891279188314161*^9}, {3.8912793497010527`*^9, 3.8912793594701085`*^9}, {
   3.8912794172856817`*^9, 3.891279423112281*^9}, {3.891281897496488*^9, 
   3.891281897817503*^9}, {3.89136248810867*^9, 3.891362502184837*^9}, {
   3.8913645114700565`*^9, 3.8913645152918234`*^9}, {3.891367278640957*^9, 
   3.891367311495427*^9}, {3.8914130421374617`*^9, 3.8914130425740347`*^9}, {
   3.8914135362760963`*^9, 3.8914135365610948`*^9}, {3.8914137076765785`*^9, 
   3.891413741796623*^9}, {3.891416307164044*^9, 3.8914163075049815`*^9}, {
   3.891431515366051*^9, 3.8914315265106297`*^9}, {3.8914337264079776`*^9, 
   3.8914337268015714`*^9}, {3.8914376763669553`*^9, 
   3.8914376981032567`*^9}, {3.8914411070760384`*^9, 3.891441136546509*^9}, {
   3.8914413822835703`*^9, 3.8914413825704365`*^9}, {3.8915051980182953`*^9, 
   3.8915052271374483`*^9}, {3.891520166658786*^9, 3.8915201671307216`*^9}, {
   3.8915324782089343`*^9, 3.891532527759901*^9}, {3.895235584088151*^9, 
   3.895235630890587*^9}, {3.8952360909410243`*^9, 3.895236171829955*^9}, {
   3.895237288409603*^9, 3.8952372889664936`*^9}, {3.895241359118166*^9, 
   3.895241409028061*^9}, {3.8952417993318014`*^9, 3.89524183646583*^9}, {
   3.895387170081184*^9, 3.895387182519307*^9}, {3.8953898661484537`*^9, 
   3.8953898856723824`*^9}, {3.8953899194144177`*^9, 
   3.8953899197517204`*^9}, {3.8953905885563765`*^9, 3.895390607315241*^9}, {
   3.895391450865588*^9, 3.8953919242326593`*^9}, 3.895391985075384*^9, {
   3.8953920211990776`*^9, 3.8953920213375607`*^9}, {3.8953933668274937`*^9, 
   3.8953933801894655`*^9}, {3.8953955006391563`*^9, 3.895395563968426*^9}, {
   3.8953968363902445`*^9, 3.8953968801065164`*^9}, {3.8954257449541216`*^9, 
   3.8954257480811863`*^9}, {3.8956433566674643`*^9, 
   3.8956433943818407`*^9}, {3.8956437465872154`*^9, 3.895643807006666*^9}, {
   3.895644396848751*^9, 3.8956445458389225`*^9}, {3.895645045137765*^9, 
   3.8956450784398155`*^9}, {3.8956451094188623`*^9, 3.895645279526049*^9}, {
   3.8956457387859163`*^9, 3.895645821088733*^9}, {3.8956459070171146`*^9, 
   3.895646290172578*^9}, {3.8956471644067316`*^9, 3.895647165409175*^9}, {
   3.895647215957505*^9, 3.8956472201018324`*^9}, 3.8956586185623446`*^9, 
   3.895659105957363*^9, {3.895818642104947*^9, 3.895818642857977*^9}, {
   3.8958364306277103`*^9, 3.8958364312688327`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"badd11d8-df7e-46a4-8c64-95e5572ef76a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Taylor expansion", "Title",
 CellChangeTimes->{{3.8910073887548065`*^9, 3.891007390926674*^9}, {
  3.8910074344942245`*^9, 3.8910074359215517`*^9}, {3.891007515161849*^9, 
  3.891007516479077*^9}, {3.891008916433653*^9, 3.891008955749086*^9}, {
  3.891280453469096*^9, 3.8912804539701233`*^9}, {3.8915177889106903`*^9, 
  3.891517795162298*^9}, {3.8952372661344137`*^9, 3.89523726799854*^9}, {
  3.8952373039945*^9, 3.895237320623995*^9}, {3.8952385424550734`*^9, 
  3.895238543013917*^9}, {3.8953902584084578`*^9, 
  3.8953902709160185`*^9}},ExpressionUUID->"975f7379-5e89-4c9d-9c35-\
2517707099ec"],

Cell["\<\
Mathematica computes the Taylor expansion of the system up to order nmax\
\>", "Text",
 CellChangeTimes->{{3.896875836206487*^9, 
  3.8968758511092*^9}},ExpressionUUID->"a0fefe8f-2f26-4637-bafc-edd7bea0a157"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expr", "=", 
     RowBox[{"kinetics", "/.", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}], "->", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"order", "=", "0"}], "nmax"], 
          RowBox[{
           SuperscriptBox["\[Epsilon]NF", "order"], "*", 
           RowBox[{
            SubscriptBox[
             RowBox[{"var", "[", 
              RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
            RowBox[{"x", ",", "X"}], "]"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"expansion", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "1"}], ",", 
      RowBox[{"order", "<=", "nmax"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"expansion", ",", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"order", "!"}]], 
           RowBox[{"D", "[", 
            RowBox[{"expr", ",", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]NF", ",", "order"}], "}"}]}], "]"}]}], "/.", 
          RowBox[{"\[Epsilon]NF", "->", "0"}]}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8906785957145324`*^9, 3.890678609403802*^9}, {
  3.8906787105192423`*^9, 3.890678711054577*^9}, {3.890678776838481*^9, 
  3.8906789625892935`*^9}, {3.89067904003786*^9, 3.89067906663437*^9}, {
  3.891011486353433*^9, 3.891011487715682*^9}, {3.8953902601780715`*^9, 
  3.895390261127928*^9}, {3.8956445610139427`*^9, 3.8956445900903425`*^9}, {
  3.89564629823055*^9, 3.8956463281548204`*^9}, {3.8958430822551403`*^9, 
  3.8958430910459814`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"2e32b0e0-a41c-4002-a99b-e9daae978379"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ansatz expansion", "Title",
 CellChangeTimes->{{3.895390281334725*^9, 
  3.8953902927520714`*^9}},ExpressionUUID->"31009231-e5e1-4bd5-b49d-\
53ebf474df13"],

Cell["\<\
Addition of the linear operator to the expansion of the reaction\
\>", "Text",
 CellChangeTimes->{{3.89687604221647*^9, 
  3.896876070671256*^9}},ExpressionUUID->"9ef0a0d4-5957-4304-b51d-\
4fa62a57d438"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"equations", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "1"}], ",", 
      RowBox[{"order", "<=", "nmax"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"order", "<=", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"equations", ",", 
           RowBox[{
            RowBox[{"expansion", "[", 
             RowBox[{"[", "order", "]"}], "]"}], "+", 
            RowBox[{"Dot", "[", 
             RowBox[{"diffmatrix", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{"x", ",", "x"}]], 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
                  RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}]}]}],
           "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"3", "<=", "order", "<=", "4"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"equations", ",", 
             RowBox[{
              RowBox[{"expansion", "[", 
               RowBox[{"[", "order", "]"}], "]"}], "+", 
              RowBox[{"Dot", "[", 
               RowBox[{"diffmatrix", ",", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "x"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "+", 
                 RowBox[{"2", "*", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "X"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], 
                    RowBox[{"order", "-", "2"}]], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}]}], 
               "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"equations", ",", 
             RowBox[{
              RowBox[{"expansion", "[", 
               RowBox[{"[", "order", "]"}], "]"}], "+", 
              RowBox[{"Dot", "[", 
               RowBox[{"diffmatrix", ",", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "x"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "+", 
                 RowBox[{"2", "*", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "X"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], 
                    RowBox[{"order", "-", "2"}]], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "+", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"X", ",", "X"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], 
                    RowBox[{"order", "-", "4"}]], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], 
               "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8906791447797537`*^9, 3.890679343841946*^9}, {
   3.890679378735796*^9, 3.890679438306658*^9}, {3.8906794761291485`*^9, 
   3.8906796054668407`*^9}, {3.8906800011264915`*^9, 
   3.8906801277077518`*^9}, {3.8906802622761917`*^9, 3.890680278573492*^9}, {
   3.8906805125437913`*^9, 3.8906805224712844`*^9}, {3.8906807449302835`*^9, 
   3.8906808237528253`*^9}, {3.890680891412051*^9, 3.8906810999806385`*^9}, {
   3.891007076654664*^9, 3.8910070774451733`*^9}, {3.8910114394876986`*^9, 
   3.8910114495627565`*^9}, {3.891412511472025*^9, 3.89141251316732*^9}, {
   3.891435688412567*^9, 3.891435688740713*^9}, {3.8953902012661343`*^9, 
   3.895390202476407*^9}, 3.8953923005432415`*^9, {3.8956446055515337`*^9, 
   3.895644667269793*^9}, {3.8956463128668165`*^9, 3.895646322060215*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"751cb34e-5132-4079-9042-ce30049ea319"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving equations at each order", "Title",
 CellChangeTimes->{{3.8953903043084345`*^9, 
  3.8953903089576807`*^9}},ExpressionUUID->"5a3a3e1d-f27d-43c0-b2b2-\
1e5928aa479d"],

Cell["\<\
Mathematica solves the equation at each order to find the symbolic \
coefficients\
\>", "Text",
 CellChangeTimes->{{3.8968760866469383`*^9, 3.8968760903322105`*^9}, {
  3.896876163011267*^9, 
  3.896876197654064*^9}},ExpressionUUID->"1415cb93-4b04-4cb2-959b-\
6a17fceb7fdb"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solvcond", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"solvcond", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "2"}], ",", 
      RowBox[{"order", "<=", "nmax"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "order", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"solvcond", ",", "0"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"equation", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"equations", "[", 
             RowBox[{"[", "order", "]"}], "]"}], "/.", "toexpand"}], "/.", 
           "toexpandderxx"}], "/.", "toexpandderXx"}], "/.", 
         "toexpandderXX"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"sub", "=", "0"}], ",", 
         RowBox[{"sub", "<=", "order"}], ",", 
         RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"EvenQ", "[", "order", "]"}], "&&", " ", 
               RowBox[{"\[Not]", " ", 
                RowBox[{"EvenQ", "[", "sub", "]"}]}]}], ")"}], " ", "||", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Not]", " ", 
                RowBox[{"EvenQ", "[", "order", "]"}]}], " ", "&&", " ", 
               RowBox[{"EvenQ", "[", "sub", "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"order", "==", "nmax"}], " ", "&&", " ", 
             RowBox[{"sub", "!=", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"order", "==", "4"}], " ", "&&", " ", 
             RowBox[{"sub", ">", "2"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"auxeq", "=", 
           RowBox[{
            RowBox[{
             FractionBox["kNF", 
              RowBox[{"2", "\[Pi]"}]], 
             RowBox[{
              SubsuperscriptBox["\[Integral]", "0", 
               FractionBox[
                RowBox[{"2", "\[Pi]"}], "kNF"]], 
              RowBox[{"equation", "*", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "\[ImaginaryI]"}], "*", "sub", "*", "kNF", "*", 
                 "x"}]], 
               RowBox[{"\[DifferentialD]", "x"}]}]}]}], "//", "Simplify"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"auxeq", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "auxeq"}], "/.", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["W", 
                  RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                 "]"}], "->", "0"}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "//", 
            "Simplify"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"order", "!=", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"sub", "!=", "1"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"auxsol", "=", 
                RowBox[{"LinearSolve", "[", 
                 RowBox[{"dummymat", ",", "dummyvec"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"auxsol", "=", 
                RowBox[{
                 RowBox[{"auxsol", "/.", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"dummymat", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}], "->", 
                    RowBox[{"jacobianmatr", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}]}], "/.", 
                    RowBox[{"mul", "->", "sub"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"row", ",", "nvar"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}], "]"}]}], "/.", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dummyvec", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"auxeq", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["sol", 
                 RowBox[{"order", ",", "sub"}]], "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                    "]"}], "->", 
                   RowBox[{"auxsol", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["dersol", 
                 RowBox[{"order", ",", "sub"}]], "=", 
                RowBox[{"D", "[", 
                 RowBox[{
                  SubscriptBox["sol", 
                   RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["der2sol", 
                 RowBox[{"order", ",", "sub"}]], "=", 
                RowBox[{"D", "[", 
                 RowBox[{
                  SubscriptBox["dersol", 
                   RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}]}], ";"}],
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"solvcond", ",", 
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{"Dot", "[", 
                    RowBox[{"auxeq", ",", "\[Psi]"}], "]"}], 
                   RowBox[{"Dot", "[", 
                    RowBox[{"\[Phi]", ",", "\[Psi]"}], "]"}]]}]}], "]"}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"order", "!=", "nmax"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"usefulvec", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["auxvec", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"auxsol", "=", 
                   RowBox[{"LinearSolve", "[", 
                    RowBox[{
                    RowBox[{"dummymat", "[", 
                    RowBox[{"[", 
                    RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"dummyvec", "[", 
                    RowBox[{"[", "submatrixcols", "]"}], "]"}]}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"auxsol", "=", 
                   RowBox[{
                    RowBox[{"auxsol", "/.", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dummymat", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}], "->", 
                    RowBox[{"jacobianmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"row", ",", "nvar"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}], "]"}]}], "/.", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dummyvec", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"auxeq", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"usefulvec", "[", 
                    RowBox[{"[", "submatrixcols", "]"}], "]"}], "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", 
                    RowBox[{"submatrixcols", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}]], "[", "X", "]"}], "->", 
                    RowBox[{"auxsol", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"nvar", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"usefulvec", "[", 
                    RowBox[{"[", "criticalcol", "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "criticalcol"}]], "[", 
                    "X", "]"}], "->", "0"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["sol", 
                    RowBox[{"order", ",", "sub"}]], "=", "usefulvec"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["dersol", 
                    RowBox[{"order", ",", "sub"}]], "=", 
                   RowBox[{"D", "[", 
                    RowBox[{
                    SubscriptBox["sol", 
                    RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["der2sol", 
                    RowBox[{"order", ",", "sub"}]], "=", 
                   RowBox[{"D", "[", 
                    RowBox[{
                    SubscriptBox["dersol", 
                    RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}]}], 
                  ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}],
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8912782820412655`*^9, 3.8912783111581135`*^9}, {
   3.8912784377134094`*^9, 3.891278443135502*^9}, {3.891278547331915*^9, 
   3.8912785888709354`*^9}, {3.8912787467529783`*^9, 3.891278749711026*^9}, {
   3.891278884536026*^9, 3.8912789916188087`*^9}, {3.8912790229653907`*^9, 
   3.89127906433963*^9}, {3.8912792188225007`*^9, 3.8912792198615007`*^9}, {
   3.8912794585216045`*^9, 3.8912794593986015`*^9}, {3.8912805880085635`*^9, 
   3.891280684080511*^9}, {3.8912807150591526`*^9, 3.8912807153991485`*^9}, {
   3.891280936699304*^9, 3.8912811108317165`*^9}, {3.8912812803294473`*^9, 
   3.8912813268544416`*^9}, {3.891281426236225*^9, 3.891281427969783*^9}, {
   3.8912815336214547`*^9, 3.891281639249179*^9}, {3.8912818701198297`*^9, 
   3.8912818713888297`*^9}, {3.8912819208155813`*^9, 
   3.8912819218095827`*^9}, {3.8912822076171083`*^9, 3.891282318313404*^9}, {
   3.8912825751115723`*^9, 3.8912826212847123`*^9}, {3.8912826546672583`*^9, 
   3.8912827145909233`*^9}, {3.8912828335963106`*^9, 
   3.8912828475783844`*^9}, {3.8913597954389353`*^9, 
   3.8913597978244534`*^9}, {3.891360330784241*^9, 3.8913603596211195`*^9}, {
   3.891360394197403*^9, 3.891360585624901*^9}, 3.8913606412383013`*^9, {
   3.89136104632998*^9, 3.8913610734971437`*^9}, {3.891361381676696*^9, 
   3.8913613906487255`*^9}, {3.8913621324210224`*^9, 3.891362229178543*^9}, {
   3.8913623344309015`*^9, 3.8913623436758027`*^9}, {3.8913625553554554`*^9, 
   3.8913625559284544`*^9}, {3.8913626078647614`*^9, 3.891362654793866*^9}, {
   3.891362715307205*^9, 3.8913627557212315`*^9}, {3.891362811221194*^9, 
   3.8913628542578225`*^9}, {3.891362940667872*^9, 3.891362999093012*^9}, {
   3.8913630898132877`*^9, 3.8913630901710696`*^9}, {3.8913632512516766`*^9, 
   3.8913632663831987`*^9}, {3.891363317248144*^9, 3.891363333514456*^9}, {
   3.8913633991670904`*^9, 3.8913634050460224`*^9}, {3.8913636663207836`*^9, 
   3.891363680134602*^9}, {3.8913637145884824`*^9, 3.8913637379783926`*^9}, 
   3.8913638270912437`*^9, {3.8913649928255935`*^9, 3.8913649931821613`*^9}, {
   3.8913654030721235`*^9, 3.8913654040671744`*^9}, {3.891367716953764*^9, 
   3.8913677221237383`*^9}, {3.89136782317605*^9, 3.8913678236042204`*^9}, {
   3.891367885566408*^9, 3.891367888664566*^9}, {3.8913679499782033`*^9, 
   3.891367971310688*^9}, {3.8914120375132008`*^9, 3.891412094986128*^9}, {
   3.891413268910467*^9, 3.8914132726870594`*^9}, {3.891414023563636*^9, 
   3.8914140262890253`*^9}, {3.8914140893393936`*^9, 
   3.8914142612164865`*^9}, {3.891414297934016*^9, 3.8914143301329975`*^9}, {
   3.891414389180242*^9, 3.8914145836630306`*^9}, {3.8914146560237517`*^9, 
   3.8914146614727545`*^9}, {3.891414770984223*^9, 3.8914147763257947`*^9}, {
   3.8914148073470697`*^9, 3.8914148208622484`*^9}, {3.891414860723753*^9, 
   3.891414860999753*^9}, {3.891414952547634*^9, 3.8914150775504436`*^9}, {
   3.891415125237281*^9, 3.891415216515827*^9}, {3.8914153285519023`*^9, 
   3.8914153681869173`*^9}, {3.8914154624744463`*^9, 3.891415527370666*^9}, {
   3.891415661139343*^9, 3.8914157039301195`*^9}, {3.8914159487332935`*^9, 
   3.891415950212698*^9}, {3.891415984105797*^9, 3.8914160079108534`*^9}, {
   3.8914161656298094`*^9, 3.891416213046152*^9}, {3.891416625295349*^9, 
   3.891416635596052*^9}, {3.8914229218997636`*^9, 3.8914229499401245`*^9}, {
   3.89142341798869*^9, 3.8914234228096504`*^9}, {3.8914237507109375`*^9, 
   3.8914237798933787`*^9}, {3.8914238113235064`*^9, 3.891423851109641*^9}, {
   3.891431260440771*^9, 3.8914313209382906`*^9}, {3.8914316657846155`*^9, 
   3.8914316696687536`*^9}, {3.891431960817112*^9, 3.891431962101017*^9}, {
   3.8914331017937126`*^9, 3.8914331398788943`*^9}, {3.8914358792440586`*^9, 
   3.891435885571937*^9}, {3.8914373217754726`*^9, 3.89143737285233*^9}, {
   3.8914378120762835`*^9, 3.891437841168311*^9}, {3.8914384295278845`*^9, 
   3.891438485090257*^9}, {3.891439668887679*^9, 3.891439694809305*^9}, {
   3.8915254782568507`*^9, 3.8915254800623455`*^9}, {3.891861080858152*^9, 
   3.8918610850888844`*^9}, {3.891880980796477*^9, 3.891880981846337*^9}, 
   3.8952389171276217`*^9, {3.895386693938452*^9, 3.895386709906249*^9}, 
   3.895387135780505*^9, {3.89538733045947*^9, 3.8953873313278723`*^9}, {
   3.8953874439392195`*^9, 3.895387472823164*^9}, {3.8953886634166393`*^9, 
   3.895388672060294*^9}, {3.895388965816328*^9, 3.895388991205279*^9}, {
   3.8953892095953755`*^9, 3.8953893127219553`*^9}, {3.8953893975602894`*^9, 
   3.8953894049376087`*^9}, {3.895390869137729*^9, 3.895390877633423*^9}, {
   3.8953912939928827`*^9, 3.8953912941087017`*^9}, {3.89539240555837*^9, 
   3.8953924060524006`*^9}, {3.8953925959865284`*^9, 3.895392602446885*^9}, {
   3.895392719176372*^9, 3.895392794091338*^9}, {3.895395301884531*^9, 
   3.8953953824839306`*^9}, {3.895396729801237*^9, 3.8953967501278334`*^9}, {
   3.8953970110206327`*^9, 3.895397019191662*^9}, {3.8953973833150415`*^9, 
   3.8953973834903526`*^9}, {3.895427323722612*^9, 3.895427337797324*^9}, {
   3.895481074434719*^9, 3.895481074714653*^9}, {3.895643822710439*^9, 
   3.895643831466565*^9}, {3.8956446825851464`*^9, 3.8956448012286882`*^9}, {
   3.8956453241579204`*^9, 3.895645417297291*^9}, {3.8956463340940247`*^9, 
   3.8956463462501907`*^9}, 3.8956980341804876`*^9, {3.895759629460738*^9, 
   3.895759629992372*^9}, {3.895760009026192*^9, 3.895760009460331*^9}, {
   3.895818656147724*^9, 3.895818656857855*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"5a683087-6769-48aa-a98b-e2a85730a676"]
}, Closed]],

Cell[CellGroupData[{

Cell["Getting coefficients", "Title",
 CellChangeTimes->{{3.895390348620699*^9, 3.895390351819915*^9}, {
  3.896964817533112*^9, 
  3.8969648177197514`*^9}},ExpressionUUID->"b720bbc5-22a5-423a-bc30-\
2c9c18f99b35"],

Cell[TextData[{
 "Mathematica extracts the third and fifth-order coefficients from the \
previous expansion.Also, Mathematica finds the coefficients ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Alpha]", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1c5345f7-0a35-4c7d-ae45-1213626b5d6e"],
 " that determine the equation the amplitude solves at a codimension-two point"
}], "Text",
 CellChangeTimes->{{3.8968762104715314`*^9, 3.8968762359741545`*^9}, {
  3.8968762702631063`*^9, 3.896876270463159*^9}, {3.8968763144780784`*^9, 
  3.896876362736129*^9}},ExpressionUUID->"246e49dc-2627-4f96-b123-\
14166c8ea7ee"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C3", "=", 
     RowBox[{"solvcond", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "2"}], ",", 
      RowBox[{"order", ">=", "0"}], ",", 
      RowBox[{"order", "--"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"sub", "=", "0"}], ",", 
        RowBox[{"sub", "<=", "order"}], ",", 
        RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"C3", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"C3", "/.", 
             SubscriptBox["sol", 
              RowBox[{"order", ",", "sub"}]]}], "/.", 
            SubscriptBox["dersol", 
             RowBox[{"order", ",", "sub"}]]}], "/.", 
           SubscriptBox["der2sol", 
            RowBox[{"order", ",", "sub"}]]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"C3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"C3", "/.", "conjpar"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "->", "0"}]}], "/.", 
      RowBox[{
       RowBox[{
        SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<Third-order coefficient.mx\>\"", ",", "C3"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"nmax", ">=", "5"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"C5", "=", 
        RowBox[{"solvcond", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"order", "=", "4"}], ",", 
         RowBox[{"order", ">=", "0"}], ",", 
         RowBox[{"order", "--"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"sub", "=", "0"}], ",", 
           RowBox[{"sub", "<=", "order"}], ",", 
           RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"order", "==", "4"}], " ", "&&", " ", 
               RowBox[{"sub", ">", "2"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"C5", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"C5", "/.", 
                SubscriptBox["sol", 
                 RowBox[{"order", ",", "sub"}]]}], "/.", 
               SubscriptBox["dersol", 
                RowBox[{"order", ",", "sub"}]]}], "/.", 
              SubscriptBox["der2sol", 
               RowBox[{"order", ",", "sub"}]]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"C5", "=", 
        RowBox[{"C5", "/.", "conjpar"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[Alpha]NF", "1"], "=", 
        RowBox[{"Coefficient", "[", 
         RowBox[{"C5", ",", 
          RowBox[{
           RowBox[{
            SubscriptBox["A", "1"], "''"}], "[", "X", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[Alpha]NF", "2"], "=", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{"C5", ",", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                RowBox[{
                 SubscriptBox["A", "1"], "[", "X", "]"}], "]"}], "2"], "*", 
              RowBox[{
               RowBox[{
                SubscriptBox["A", "1"], "'"}], "[", "X", "]"}]}]}], "]"}], 
           "+", 
           RowBox[{"Coefficient", "[", 
            RowBox[{"C5", ",", 
             RowBox[{
              RowBox[{
               SubscriptBox["A", "1"], "[", "X", "]"}], "*", 
              RowBox[{"Conjugate", "[", 
               RowBox[{
                SubscriptBox["A", "1"], "[", "X", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{
                SubscriptBox["A", "1"], "'"}], "[", "X", "]"}]}]}], "]"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[Alpha]NF", "3"], "=", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "*", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"C5", ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
              SubscriptBox["A", "1"], "[", "X", "]"}], "2"], "*", 
            RowBox[{"Conjugate", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "]"}]}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[Alpha]NF", "4"], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"C5", "/.", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "->", "0"}]}], "/.", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["A", "1"], "''"}], "[", "X", "]"}], "->", "0"}]}], "/.", 
         RowBox[{
          RowBox[{
           SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"C5", "=", 
        SubscriptBox["\[Alpha]NF", "4"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<Fifth-order coefficient.mx\>\"", ",", "C5"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8914376241605654`*^9, 3.891437625671474*^9}, 
   3.8914382911451178`*^9, {3.8914388897827864`*^9, 3.891439065182951*^9}, {
   3.891439119608291*^9, 3.891439168326683*^9}, {3.8914392353822303`*^9, 
   3.891439238500129*^9}, {3.891439560881304*^9, 3.891439565447703*^9}, {
   3.8914400015391097`*^9, 3.891440019625805*^9}, {3.8914403390958195`*^9, 
   3.8914403516674366`*^9}, {3.8914503903976126`*^9, 
   3.8914504018431015`*^9}, {3.8915013270022745`*^9, 3.891501330139021*^9}, {
   3.8915022961652966`*^9, 3.891502359730925*^9}, {3.891502469505395*^9, 
   3.8915024719227877`*^9}, {3.8915026141559153`*^9, 
   3.8915026503921366`*^9}, {3.891502714836328*^9, 3.8915027182923822`*^9}, {
   3.891502760885398*^9, 3.8915027844538755`*^9}, {3.8915028902000794`*^9, 
   3.8915028969473505`*^9}, {3.8915029384217854`*^9, 
   3.8915029648688636`*^9}, {3.891503052754713*^9, 3.8915030588663254`*^9}, {
   3.891505260377139*^9, 3.891505293340233*^9}, {3.8915064733065796`*^9, 
   3.8915065087743053`*^9}, {3.891508234492185*^9, 3.8915082502339034`*^9}, {
   3.891508472614611*^9, 3.8915084755185566`*^9}, {3.8915325670930986`*^9, 
   3.8915325770378704`*^9}, {3.89188095188918*^9, 3.891880952091041*^9}, {
   3.891884474856989*^9, 3.8918844757016673`*^9}, {3.8952373955893164`*^9, 
   3.895237396042495*^9}, {3.895237865421593*^9, 3.8952378690960236`*^9}, 
   3.8952382192690163`*^9, {3.895241558859524*^9, 3.8952415837353716`*^9}, {
   3.8952418549496403`*^9, 3.895241859580656*^9}, {3.89538783589052*^9, 
   3.8953878858010006`*^9}, {3.8953882186605673`*^9, 
   3.8953882296697774`*^9}, {3.8953976961694365`*^9, 
   3.8953977172602215`*^9}, {3.895397761957958*^9, 3.895397762277561*^9}, {
   3.8953978074834905`*^9, 3.895397933607459*^9}, {3.8953980014624505`*^9, 
   3.8953984672575445`*^9}, {3.895398504039594*^9, 3.895398527169013*^9}, {
   3.8953986402722783`*^9, 3.895398675379572*^9}, {3.8953987079759316`*^9, 
   3.895398728270647*^9}, 3.895398884226127*^9, {3.8953994783501787`*^9, 
   3.895399481227302*^9}, {3.8953995321779966`*^9, 3.8953995382616615`*^9}, {
   3.8953998690952263`*^9, 3.895399896780435*^9}, {3.8954254166535406`*^9, 
   3.8954254181848574`*^9}, {3.895425454771001*^9, 3.895425507004882*^9}, {
   3.895425773777924*^9, 3.8954258414560623`*^9}, {3.8954336902439423`*^9, 
   3.895433701819147*^9}, {3.895434167089511*^9, 3.895434171103548*^9}, {
   3.8956454298322716`*^9, 3.8956454658611383`*^9}, {3.895646352585684*^9, 
   3.895646363160283*^9}, 3.8956464994453096`*^9, {3.895698040743148*^9, 
   3.8956980442315083`*^9}, {3.896964799082729*^9, 
   3.896964809595725*^9}},ExpressionUUID->"92b76d96-921d-4849-a40c-\
d06b5af83e61"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross-order coefficient", "Title",
 CellChangeTimes->{{3.8958441162737217`*^9, 
  3.8958441751882124`*^9}},ExpressionUUID->"22ed8e9a-ac08-49b1-a105-\
ccaa93207ba4"],

Cell["Mathematica finds the cross-order coefficient, if requested", "Text",
 CellChangeTimes->{{3.8968762944456177`*^9, 
  3.896876307054241*^9}},ExpressionUUID->"33f00c93-f20f-42d8-bde1-\
743c401a23cc"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"crosscoef", "==", "\"\<y\>\""}], " ", "&&", " ", 
    RowBox[{
     RowBox[{"Length", "[", "eq", "]"}], ">", "1"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "crosspar", "]"}], "==", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"crosspar", "=", 
        RowBox[{"crosspar", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"C11", "=", 
     FractionBox[
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"jacobianmat", "/.", "eq"}], ",", "crosspar"}], "]"}], 
          ",", "\[Phi]"}], "]"}], ",", "\[Psi]"}], "]"}], 
      RowBox[{"Dot", "[", 
       RowBox[{"\[Phi]", ",", "\[Psi]"}], "]"}]]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8958441601729593`*^9, 3.8958442156110077`*^9}, {
   3.89584428961308*^9, 3.8958443871887455`*^9}, {3.895844422323782*^9, 
   3.8958444232395816`*^9}, 3.89584446009347*^9, {3.895844536249735*^9, 
   3.8958445441398525`*^9}, {3.8968762769944887`*^9, 3.896876277839266*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"c55ec3d7-8d3f-4fab-8804-a4ea848a2cb1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Changes of criticality", "Title",
 CellChangeTimes->{{3.8954324193678913`*^9, 3.895432430516776*^9}, {
  3.8968763837307997`*^9, 
  3.896876386803398*^9}},ExpressionUUID->"8258dbe0-d1fc-429e-b0fe-\
ea1230796fe6"],

Cell["Mathematica finds the changes of criticality if requested", "Text",
 CellChangeTimes->{{3.8968763943004045`*^9, 
  3.8968764032385044`*^9}},ExpressionUUID->"be60d8d7-f0cb-4095-b82c-\
19e8939f49b4"],

Cell[BoxData[
 RowBox[{"Catch", "[", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&", 
     " ", 
     RowBox[{
      RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Throw", "[", 
      "\"\<This script could not find a bifurcation curve for this \
system\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nmax", ">=", "5"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fifthcoeff", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"criticalitychanges", "!=", "\"\<y\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Throw", "[", 
         "\"\<You do not want to find changes of criticality\>\"", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"codimensiontwopoints", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"outersolnum", "=", "1"}], ",", 
       RowBox[{"outersolnum", "<=", 
        RowBox[{"Length", "[", "solutioncurves", "]"}]}], ",", 
       RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"innersolnum", "=", "1"}], ",", 
         RowBox[{"innersolnum", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"solutioncurves", "[", 
            RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aux", "=", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
             "]"}], "/.", "variabledependence"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Variables", "[", 
              RowBox[{
               RowBox[{"aux", "/.", 
                RowBox[{
                 RowBox[{"solutioncurves", "[", 
                  RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
               RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"auxC3", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", "time", "}"}], ",", "#", ",", 
               RowBox[{"RuntimeOptions", "->", 
                RowBox[{"{", 
                 RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}], 
                 "}"}]}]}], "]"}], "&"}], "@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"C3", "/.", "fixedpar"}], "/.", 
                   RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{"\[Mu]NF", "->", 
                 RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
               "variabledependence"}], "/.", 
              RowBox[{
               RowBox[{"solutioncurves", "[", 
                RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"allvals", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{"auxC3", "[", "time", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "timedifference"}], 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vals", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"valnum", "=", "1"}], ",", 
            RowBox[{"valnum", "<=", 
             RowBox[{
              RowBox[{"Length", "[", "allvals", "]"}], "-", "1"}]}], ",", 
            RowBox[{"valnum", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"allvals", "[", 
                   RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "*", 
                 RowBox[{
                  RowBox[{"allvals", "[", 
                   RowBox[{"[", 
                    RowBox[{"valnum", "+", "1"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "<", "0"}], " ", "&&", 
               " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"allvals", "[", 
                  RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ">", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Chop", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", 
                    RowBox[{
                    RowBox[{"allvals", "[", 
                    RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  "Choptol"}], "]"}], "!=", "0"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"vals", ",", 
                RowBox[{
                 RowBox[{"allvals", "[", 
                  RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"tnum", "=", "1"}], ",", 
            RowBox[{"tnum", "<=", 
             RowBox[{"Length", "[", "vals", "]"}]}], ",", 
            RowBox[{"tnum", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"initialvalueoft", "=", 
              RowBox[{"vals", "[", 
               RowBox[{"[", "tnum", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"critchangetemp", "=", 
              RowBox[{"time", "/.", 
               RowBox[{"Quiet", "@", 
                RowBox[{"FindRoot", "[", 
                 RowBox[{
                  RowBox[{"auxC3", "[", "time", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"time", ",", "initialvalueoft"}], "}"}]}], 
                 "]"}]}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<=", "critchangetemp", "<=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], " ", "&&", " ", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"auxC3", "[", "critchangetemp", "]"}], "]"}], "<", 
                 "tol"}], " ", "&&", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "critchangetemp", "]"}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}], ">", 
                 "0"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"auxiliaryarray", "=", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\[Mu]NF", "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}], 
                  "/.", 
                  RowBox[{"time", "->", "critchangetemp"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"codimensiontwopoints", ",", "auxiliaryarray"}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"ValueQ", "[", "fifthcoeff", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"fifthcoeff", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
                    RowBox[{"time", "->", "critchangetemp"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"C5", "/.", "fixedpar"}], "/.", 
                    RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                    RowBox[{"\[Mu]NF", "->", 
                    RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
                    "variabledependence"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
                    RowBox[{"time", "->", "critchangetemp"}]}], "}"}]}], 
                    "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "codimensiontwopoints", "]"}], ">", "0"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"codimensiontwopoints", "=", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"par", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "\[Mu]NF"}], "}"}], ",", 
            "var"}], "]"}], "/.", "codimensiontwopoints"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"codimensiontwopoints", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"codimensiontwopoints", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"EuclideanDistance", "[", "##", "]"}], "<", "disttol"}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"critchange", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "->", 
              RowBox[{
               RowBox[{"codimensiontwopoints", "[", 
                RowBox[{"[", "critnum", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "->", 
              RowBox[{
               RowBox[{"codimensiontwopoints", "[", 
                RowBox[{"[", "critnum", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"critnum", ",", 
             RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"codimensiontwopoints", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"3", "+", "varnum"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"critnum", ",", 
             RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ValueQ", "[", "fifthcoeff", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"auxarr", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"critnum", "=", "1"}], ",", 
             RowBox[{"critnum", "<=", 
              RowBox[{"Length", "[", "critchange", "]"}]}], ",", 
             RowBox[{"critnum", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"getout", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"fifthnum", "=", "1"}], ",", 
                RowBox[{"fifthnum", "<=", 
                 RowBox[{"Length", "[", "fifthcoeff", "]"}]}], ",", 
                RowBox[{"fifthnum", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"getout", "==", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"fifthcoeff", "[", 
                    RowBox[{"[", "fifthnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "/.", 
                   RowBox[{"critchange", "[", 
                    RowBox[{"[", "critnum", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"auxarr", ",", 
                    RowBox[{"fifthcoeff", "[", 
                    RowBox[{"[", "fifthnum", "]"}], "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"getout", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fifthcoeff", "=", "auxarr"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ValueQ", "[", "fifthcoeff", "]"}], " ", "&&", " ", 
           RowBox[{
            RowBox[{"Length", "[", "fifthcoeff", "]"}], ">", "0"}]}], ",", 
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{
            "\"\<Fifth-order coefficient at codimension-two bifurcation \
points.txt\>\"", ",", "fifthcoeff"}], "]"}], ";"}], "\[IndentingNewLine]", 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ValueQ", "[", "critchange", "]"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Length", "[", "critchange", "]"}], ">", "0"}]}], ",", 
             RowBox[{"Export", "[", 
              RowBox[{
              "\"\<Codimension-two bifurcation points.txt\>\"", ",", 
               "critchange"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]",
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.895432439016435*^9, 3.89543244673415*^9}, {
   3.8954324990803785`*^9, 3.895432586711835*^9}, {3.8954326762482696`*^9, 
   3.8954326770459056`*^9}, {3.895432715266409*^9, 3.8954327174397974`*^9}, {
   3.8954327690198593`*^9, 3.8954328375704412`*^9}, {3.8954329061120834`*^9, 
   3.8954329190150194`*^9}, {3.8954329516860323`*^9, 3.895433003076493*^9}, {
   3.8954332756657686`*^9, 3.8954332813660984`*^9}, {3.8954341875323477`*^9, 
   3.895434191486082*^9}, {3.8954342660500345`*^9, 3.895434311458144*^9}, {
   3.8954343612755375`*^9, 3.8954344420803947`*^9}, {3.895434646750369*^9, 
   3.8954346543234153`*^9}, {3.895434697269803*^9, 3.895434699002818*^9}, {
   3.895434768338003*^9, 3.895434806713364*^9}, {3.8956434054218225`*^9, 
   3.895643468187522*^9}, {3.89564383977068*^9, 3.8956438451513195`*^9}, {
   3.895650088308819*^9, 3.89565009062534*^9}, {3.895650267321447*^9, 
   3.8956502706981363`*^9}, {3.8956591154363317`*^9, 
   3.8956591175214195`*^9}, {3.8956593009952574`*^9, 
   3.8956593011714635`*^9}, {3.895659333807905*^9, 3.8956594333466425`*^9}, {
   3.895661053455301*^9, 3.8956610563638334`*^9}, 3.8956622091287374`*^9, {
   3.895664293872265*^9, 3.8956643251240177`*^9}, {3.8956663634840117`*^9, 
   3.8956663636448126`*^9}, {3.8956680905655947`*^9, 3.8956681955856557`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"1563a7cb-eece-4d24-ae39-9fc8fff20e3b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bifurcation diagram plotting", "Title",
 CellChangeTimes->{{3.895435198809738*^9, 
  3.8954352032012653`*^9}},ExpressionUUID->"d50f385e-4539-490d-b5a5-\
aafb6b65b078"],

Cell[TextData[{
 "Mathematica plots the bifurcation curves found colored according to the \
sign of the third order coefficient and the sign of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["k", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "20efb386-542a-4ae2-82e3-506004c3f2d9"]
}], "Text",
 CellChangeTimes->{{3.896876499310449*^9, 
  3.8968765237501154`*^9}},ExpressionUUID->"bd19fffe-c90d-4430-8d32-\
8e9cca6e1e30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Catch", "[", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&", 
     " ", 
     RowBox[{
      RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Throw", "[", 
      "\"\<This script could not find a bifurcation curve for this \
system\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "parnames", "]"}], "<", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"parnames", "=", "par"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ValueQ", "[", "critchange", "]"}], " ", "&&", " ", 
        RowBox[{
         RowBox[{"Length", "[", "critchange", "]"}], ">=", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"critpoints", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/.", 
                RowBox[{"critchange", "[", 
                 RowBox[{"[", "critnum", "]"}], "]"}]}], "]"}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"critnum", ",", 
             RowBox[{"Length", "[", "critchange", "]"}]}], "}"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"bifcurveplot", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GlobalLPplot", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"outersolnum", "=", "1"}], ",", 
       RowBox[{"outersolnum", "<=", 
        RowBox[{"Length", "[", "solutioncurves", "]"}]}], ",", 
       RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"innersolnum", "=", "1"}], ",", 
         RowBox[{"innersolnum", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"solutioncurves", "[", 
            RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aux", "=", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
             "]"}], "/.", "variabledependence"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Variables", "[", 
              RowBox[{
               RowBox[{"aux", "/.", 
                RowBox[{
                 RowBox[{"solutioncurves", "[", 
                  RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
               RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"auxnonzero", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", "time", "}"}], ",", "#", ",", 
               RowBox[{"RuntimeOptions", "->", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
              "]"}], "&"}], "@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar"}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{"\[Mu]NF", "->", 
                 RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
               "variabledependence"}], "/.", 
              RowBox[{
               RowBox[{"solutioncurves", "[", 
                RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"auxC3", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", "time", "}"}], ",", "#", ",", 
               RowBox[{"RuntimeOptions", "->", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
              "]"}], "&"}], "@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"C3", "/.", "fixedpar"}], "/.", 
                   RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{"\[Mu]NF", "->", 
                 RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
               "variabledependence"}], "/.", 
              RowBox[{
               RowBox[{"solutioncurves", "[", 
                RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempplot", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"ParametricPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                     " ", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], "<", "0"}]}], 
                   "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                     " ", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], ">", "0"}]}], 
                   "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], "<", "0"}]}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], "==", "0"}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], " ", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"time", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Red", ",", "Blue", ",", 
                 RowBox[{"{", 
                  RowBox[{"Green", ",", "Dotted"}], "}"}], ",", "Gray"}], 
                "}"}]}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"bifcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"outersolnum", "=", "1"}], ",", 
       RowBox[{"outersolnum", "<=", 
        RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}]}], ",", 
       RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"innersolnum", "=", "1"}], ",", 
         RowBox[{"innersolnum", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"solutioncurvesGlobalLP", "[", 
            RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tempplot", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"ParametricPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                "}"}], "/.", " ", 
               RowBox[{
                RowBox[{"solutioncurvesGlobalLP", "[", 
                 RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"time", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurvesGlobalLP", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurvesGlobalLP", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", "Gray", "}"}]}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"GlobalLPplot", ",", "tempplot"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bifcurveplot", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"bifcurveplot", ",", "GlobalLPplot"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CreateDocument", "[", 
      RowBox[{
       RowBox[{"Dynamic", "[", "plot2", "]"}], ",", 
       RowBox[{"WindowSize", "->", 
        RowBox[{"{", 
         RowBox[{"500", ",", "500"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", "critpoints", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plot2", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"bifcurveplot", ",", "critpoints", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
             ",", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"RotateLabel", "->", "False"}], ",", 
          RowBox[{"FrameStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
          RowBox[{"AspectRatio", "->", "1"}]}], "]"}]}], " ", 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"plot2", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"bifcurveplot", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
             ",", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"RotateLabel", "->", "False"}], ",", 
          RowBox[{"FrameStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
          RowBox[{"AspectRatio", "->", "1"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8954352407655687`*^9, 3.895435351307047*^9}, {
  3.895435406752877*^9, 3.8954354378472877`*^9}, {3.8954355841780214`*^9, 
  3.8954356080053015`*^9}, {3.895475873745516*^9, 3.8954758751751575`*^9}, {
  3.8956434806516714`*^9, 3.89564351456166*^9}, {3.8956438539857783`*^9, 
  3.895643854171158*^9}, {3.8956678403166037`*^9, 3.895667883594569*^9}, {
  3.8956699925482097`*^9, 3.8956699934140873`*^9}, {3.8956702605384316`*^9, 
  3.895670260998264*^9}, {3.8956708198734627`*^9, 3.895670823120852*^9}, {
  3.8956708941952596`*^9, 3.8956709050484095`*^9}, {3.8956710648408823`*^9, 
  3.8956711092212105`*^9}, {3.8956711766630573`*^9, 3.8956711773613887`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"9b433723-f3b4-4c41-a9c6-27561d0be08d"],

Cell[BoxData[
 GraphicsBox[{{{{}, {}, {}, {}, 
     TagBox[
      {RGBColor[0, 1, 0], AbsoluteThickness[1.6], Opacity[1.], 
       Dashing[{0, Small}], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1: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
ayXtfxWUK+w=
        "]]},
      Annotation[#, "Charting`Private`Tag$7622#1"]& ]}, {}}, {{{}, {}, {}, {}, 
     TagBox[
      {RGBColor[0, 1, 0], AbsoluteThickness[1.6], Opacity[1.], 
       Dashing[{0, Small}], FaceForm[Opacity[0.3]], LineBox[CompressedData["
1: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
KA==
        "]]},
      Annotation[#, "Charting`Private`Tag$7708#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], AbsoluteThickness[1.6], Opacity[1.], FaceForm[
       Opacity[0.3]], 
       LineBox[{{1.9601398487756303`, 8.000999999999998}, {1.937532119235054, 
        7.839053695156316}, {1.9150549940934618`, 7.677103625198677}, {
        1.870492703737806, 7.3531922894890025`}, {1.7829366262952617`, 
        6.705330050906945}, {1.7613745591546497`, 6.543357406024948}, {
        1.7399433538068092`, 6.381382368860538}, {1.6974737048065163`, 
        6.05742643719284}, {1.614107080099678, 5.40950314660685}, {
        1.5935935299603734`, 5.247523165046163}, {1.573211408508698, 
        5.08554528167279}, {1.5529608589316721`, 4.923570499653128}, {
        1.5328420373443028`, 4.761600153382385}, {1.5128551296269932`, 
        4.599635883095088}, {1.493000359816921, 4.437679700536303}, {
        1.4732780132258643`, 4.275733986459286}, {1.4566183905363483`, 
        4.138090608631205}}]},
      Annotation[#, "Charting`Private`Tag$7749#1"]& ], 
     TagBox[
      {RGBColor[0, 0, 1], AbsoluteThickness[1.6], Opacity[1.], FaceForm[
       Opacity[0.3]], LineBox[CompressedData["
1:eJwVz3s0lHkYB/DJXTYmjA4KZVXItTbk8oyQpVYT9Zpxa0xmJpfSRVKNSyhN
bmGn2SVmF02acpfaRCKrm457pVYiml1rvUdmlFv7e/94zvd8zvf7z7OeFevP
ViCRSIHoiDQ03lfu5zsH5686OK27QKaW69p3+e2cA0HJ+bhLcWRqSJdod/GM
HDIaaBPxxVpU1wIRKaFMDumn8rKl+zSp/pn3TQZU5OA4Rq5ZvK9B5U5YDwT0
z4KJ2LD4ao4K1fwm5bQFfxZ8qlhfNDyVqRVF7A8it1lg9DrLx74qUmUJSwf4
tz6DZodt9EHuCuok6wFTlDsDYwam0sWKLxAzb7o/fxIHHZpZXYnZKCSVD94+
uweHhZ9I71nPOmE5Vyil+OBwuXJ3P735TwhmJw7Oe+FgPlq6Sq2zA+q2G/2Y
TMVB66kjfV7nMTyXdVPaHHC4Ph4Y92/oIwh2EW8etsRBLYXv+YTeBDyDv7xb
jXAYbyi7EGtTDzMqNzluOjgkB80nbVKtgEjpqDRAA4eT+PMD8j3XwKu91kZb
DYf9TAdBj+XPEGNU8HGjCg6uxr1x2m05cHQM61FTxkFDX4NMseJDmur2vm1K
ODy60WTfr34BtKe1jUWKOAjbShsz16VCUZNx7Tbksm/m7jz1FGgZp4y+UcDB
MKjHNPEiDzZYtwoEyAWvlov6hs7AQuhXlTDkR4yupZiq09DO+DXeErlZ2mtY
V38KpotjmIrIlWSFwpb1cZAQMa48vAKHxp17s2SSE/Dk2W9+Lcj5b6lZ6THH
ISnNZH85cp33lEcm9xgsT8axM5EbHKe3SN8chV7f7sp45GyDkWYXpyMgxfPz
WcjrPzUs15RHQ43Ow9c05Gd62ktTEAVib+Mhd+S1/JQaXe1IaGlS/24rMuVL
YpWqlAtpizWRG5F5NGFe/d8ccF45STJE3vUt6wRFiQNhXkpCLeQr96o0eUZs
uJWV3ayMnDf0ufUsPQLmgzxfLZBwaG1LK/k97xB8X7erdwa5ktZPF79jQbXd
mrl/kF8E87YAsECvcWlpFFnLf+JVqygcLgoFiu+Qo2opLyJ0w8Fks/OVAWRX
R7WHYwVMUNLTnHuJvKrQdXUTmQnHqQkbnyKv9PhkO7XjILjqm9m0I19OjXay
3hsGDpJ10mbkiChbjkdyKBzuSp2/h1yafClA3hwCMnv5x3rkQ3lzClZzwSCE
6tBq5I7E1RH63sFgeONutQR5ktH4vDsvCN5aWu4WI5e73H7fLmWARL7iYCmy
7eFO8hl/BmgFOvuUII9YhPUp36VDDL9bVIisrJdpfHYLHabv8C2EyBrBHi+i
JYHAI2VkFiDfqr50N8Q0EOo5sb5XkO90ui2KJRiMRG1yIVxqf9NCWIFBmeeo
FWHBjazGDDEGdGCuJox9MJFGlmIQ0nLudS5yPW71wL4Qg0EjfS7hc75+4YN8
DLKPP07PQea6BeyIiMQgrUsST5g1ZG7D5GIwFJ9/mLAYT0oJYWPwh5C9h3BR
6JATFo76EANdwptnX2r5MTBQnaoqy0Zeu/Bh1s8HAzuf6wLCw5zHEpo3BsNl
1zIID8TmPvD3Qvv0nGjC79eskgW6Y3AytWgrYb3KhHscJwyO8JvMCLuq4z7R
Dhhk6H9aQzgo59u2Yz9gwJQxFrOQ63ak65+zw8Czp/g/wtmyTp3zNug/bGKE
cDHJPTLDCgNal10f4drrmEGOJQbXEpM6CP9ifWyTwByD/wGeq4Sx
        "]]},
      Annotation[#, "Charting`Private`Tag$7749#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], AbsoluteThickness[1.6], Opacity[1.], FaceForm[
       Opacity[0.3]], 
       LineBox[{{1.456890628161139, 4.140346168709313}, {1.4634597236751132`, 
        4.194709100420967}, {1.4854648510590736`, 4.375930546493493}, {
        1.5076359700945352`, 4.557166450726089}, {1.5299726526891493`, 
        4.738413231015623}, {1.5751414569521127`, 5.100928289983183}, {
        1.5979730945489423`, 5.282192380605545}, {1.620969289194549, 
        5.4634588423585315`}, {1.6674548356601704`, 5.8259936258608915`}, {
        1.7623954803598323`, 6.551048774794935}, {1.7865404894163333`, 
        6.732306279696663}, {1.8108493170280857`, 6.91356042370979}, {
        1.8599581994887846`, 7.276057644708633}, {1.884758165273422, 
        7.457300213125946}, {1.9097218013223483`, 7.6385381297490325`}, {
        1.9348490453112517`, 7.819771410979366}, {1.9601398487756303`, 
        8.000999999999998}}]},
      Annotation[#, "Charting`Private`Tag$7791#1"]& ], 
     TagBox[
      {RGBColor[0, 0, 1], AbsoluteThickness[1.6], Opacity[1.], FaceForm[
       Opacity[0.3]], LineBox[CompressedData["
1:eJwV03s01HkUAHDNFOWVV7NOhGzGToi2VGp1p9RhUR4xGIYxHrPRUEOiZVra
Y0iZOXlkM2ySBjkYjDjjEaON2GIrr0wPQ07mZH/GoC20X3/cc8/nnPvHvffc
u5MR7xuFU1NT80exngVpnMfX1TAo2nPeuoBEAVlx29C6A4fjQgJtKGDK+ypb
t7cHNm5iRwGXid+W1j054NdY7kCBz9H91jfW6zn5fc0HKRA125ez7uJLql9n
TyJr9frlIqduyevIYlBgrjP6Iw+Z8aD3+3sCCtDspmLzkKXyNO0eswDAqWxe
FCLT2fTkypIAGGVxXG8jf83kjSeaBwJbzcS2FNn4AjVS3BAIfPVBVRnyweED
C4LjQaBwbHG6j7zT2dKI+CEIunWlgmpkw93ZhqpcKpygL72vRdbf/Hdh0P5g
kGSL2hqRuX/kW2vOB8PgoGtqC7JZHX+gsjoEhtpIYe3IafuNdZxiaJA1WT/f
jRzX7klrPhkKe10+sXqRH/w7nUU3C4OA7CfiZ8i3hEzbGi06eDxPJb9CtpRq
e9bfoIPgDa71NXKEg7WqQDcc/HVFe+TIbpJ7Jrnl4eBWGl48i5zkqcgxOMQA
YZDEcQF5piht+/kpBjw3anBbQX7YKS7NvB0B9tFz9E0bMCgLnQxx9ImEh8mh
OD1kZfbYMQUxCma9kjq3Ix+WM72xtSgoL3xuSUQeren9YjEVDTJ2esE+5P6h
E7gRJRPubvvr1DFktp2Xs5bGWZArz97zQVanNt2f94qBxgQuMwJ52MG1KE4c
C7XNr6UXkeeUbOI4kQWjdW//y0HGFy2m8afjYGaF5VKOzJLpBI2EnAf+rtX5
NuQ2d+rwcOgFcBcbV08gGxXep/mWsCH2uE3NGrKKbGWVq0wAeuQ7LgmHQVXM
xxLfOxfhlZVzRSAyQbZWm5F8Ca4lKxk85L2iVtxjQQpcHb9OGUFmxyjKNrJS
oTlBn7Ubj+ZtMg73rLkCuofw3wTIZlvN+xUGGaAREqH/40Z0nzpRdborv0MJ
1mKOIacs4Bq7RFkQmWh/zFQd9R9hcAW7ngvxzxZ4YxoYnNGnmceX5kHslL6j
XBODHMHPN6v3FQMv+cmZbgMMWrSZXOY5Ibhf7EpdRP5m2hZ3sEYIz75eekQy
xMB2Zloa/UkIYRTn9gJk7TXCNoPESnjqJq1ONUL3yXErWc2rAmfmqJBPwKAi
NmozxaYGCpbOdZw2xeDPUxLRiyoRJBV2vZMi77vac7pfKYJ8u7qJn3ZgcBd/
uML6aAN8KfC1OWKGwU3/z3Y5Ew0gWbXmxFtg8I/2EHX6SBNQ9oxhn63QfImP
9E1rH8LATQeh0AkDudz76B1VF5Bu+fsNHcFAfFzYce5ON5AmKBbEoxhcy/H3
vhEkBQmmORntgsGHw9uJ6V96gES1dDXxweBAux9tq1MfTNjgL9OyMPihPMbQ
0PIVsDIIu+byMcCV/dK1S28ExKHt5spy9O/L/L5i2hhUSRS85AG0j++4+ADe
W6gPPtUydXYe4Myh+tYaBcSPTNszWhfgweplxeOKDeR+wmghR0sF+kuvQ3QI
eHKdLKUuMVQFHFeCz27uRvKM5kqfRH0RLp/MtF2M0SBL7M1SVoMXgeB9jU+V
bSZr8hwzlkWL0BHA9Vj20iR3bnrpsoW+BIVPe7zKHHXIe98kkXa0LMHTwASh
oFKXrDOb6PFebxnCDC26XurokZvULLSU7sswmD40EJ+pR/4fERmFFQ==
        "]]},
      Annotation[#, "Charting`Private`Tag$7791#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {GrayLevel[0.5], AbsoluteThickness[1.6], Opacity[1.], FaceForm[Opacity[
       0.3]], LineBox[CompressedData["
1:eJwl0n8s1HEYB/DjtJPuUtLqcpXrQu7SD50V0VFTc5pWcgytlCStLsuunfy4
6JdirLBuXXFTqZO1Wz8Id5yFfnyZGDb9kaZmjDJlq7iT93N/fPbZa8/zfPZ5
ns9HeFx56KQji8UKnl/YY0N6l5i4k7I6o+2nXDITUlpjJo/viJ+CP/EN5HUt
r37DSk02OVfR8xd+/Dma7B5w1wZbORIy47GXHTnvmSM2V6ofiXOG1Qe7yV16
Hg8+NvaIvHJ8mxsc1XiTbK6IXwEXdKeTxem+Arg4UUH2SjgqhJ0sQeTSiEBv
OK5TRG5udpDA1SUu9vzGrVvgazXWxbAp+Z4//GDtNJlJ4wbANk+7n+os22FD
+yzZx5wfBA+228+rVY3L4H3fBeTdSlY4rDkhJF9vSJXD0jAp+Yu+6ADsH2Hv
L7GiOAa+ox4gr4k8nQC7p1ym+TUEXkmC2zbmLIXvM+WpcN4Ghrw5ovIMrAr9
5QbL9vPPw3LFP7LYmJQOM9ZQcokimczRdFE/hlDOObi2zJvck6tVwo7yCR7s
5DBC+aY6C/ns19UZ8OFbk+SsdxMqWPtxE9XXZvMy4YDRQopPdxgvUTwxjAsP
9ffmwPyCkEXwXPmyPNjvrcgFVpdpr1LcJFhI/ZUN34A9vq1yhvvmBIXwCz6b
Aw880RXDnjzbAvp/0UO3YZHrsBP8bGdaOb1n1yAb1njVa+HJpgFHODxzWgdf
fGN2gFN46kq4/0I9C27Vt1TB74N1c024X0ZUNfyjTW+Ds1xnDXBKjIQ8pvR7
Dj80TFhhS5T4Jc2DqSLv6nxdDyv7YsiBbJEJnooVk/f8kbbCsuW+5Eijfwec
L5WQT1WxPsA+o+vJIkULA/8HDS+33g==
        "]]},
      Annotation[#, "Charting`Private`Tag$7819#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {GrayLevel[0.5], AbsoluteThickness[1.6], Opacity[1.], FaceForm[Opacity[
       0.3]], LineBox[CompressedData["
1:eJwl0n0sFHAYB/Dr5M7L4e5Slw11U5SLNKNLs7Jyce6c6ChqLdUW5uU2IykT
U0gdKRd2dmu4GVPKS16uc812y2VZFkv+ktbEkkIzb/k+/vjtt8+efZ/fnt8e
YWJ69HUmg8EI3jy4vab3rfVxfp/wiO3/ECFaCeb5ishN1bJB+HXPQfIbi8UM
t49ueXXq6js4JkFBDrTTGOD3rbVk5+P7u2H9r5mtfi2R7fBqvMc6fGC46QUc
NFlHZo1zmuFZnWYDTg24pIcvvq1lGDZtLHathwOGOrbB7dqnOjjQ3cCE09qk
WnhPiNEKPhrPrYFVyrHtcP2Augr+2TxhDX/2iaiEh/7+Y8HN5/vVsMbB0QYu
3y0pg4uTeLaweIxdAk92etvBRXGFRXCi5Ig9XDUaVADLzHIOLBO05MGirzoH
mOFcmQvnlB12hOtWWbfgs/nLVI8a98mGFSYT2d3TNRPOmp0n+8f3qOClBC/K
85TqdLjRt58c9YiTBo8VXuPC+a80VJ/4cYoPz3y8R3nvXQvkycZM8u1Fxg7Y
ZBeZAeteDvLgnOjHKfCXykyyxDH6BrweW0r99acHrsDM1E9OcMeZvQmw0ec+
+dwzuRJ+YAkka+aGFLCLSkiuHpZI4QtTbuTch8dC4YI8e3L33UMnaZ9i12g+
m5DeIHhevkTWqf3EsJNggcxntwbANeYVsqGc5Q8vxNhSv3DrJD847PvW+zsv
F4ngEb6Y7MHu8oT9MpRkt6wSIVzITSdXhbe5Ul5aStanZQhgYXIDudMUxodT
blrIFZFqB9o35hrZZfqODWxge9H/Jef3WsGCAQX5SSh3Q7pp+VIu2VKwsQx/
828gm7NDF2GtuI9sdH7+B44LHiF3ta3Pwf8BmKa6IA==
        "]]},
      Annotation[#, "Charting`Private`Tag$7846#1"]& ]}, {}}, 
   {PointSize[0.02], PointBox[{1.4562745830184693`, 4.135241772055607}]}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->True,
  FrameLabel->{
    FormBox["\"\\!\\(\\*RowBox[{\\\"b\\\"}]\\)\"", TraditionalForm], 
    FormBox["\"\\!\\(\\*RowBox[{\\\"a\\\"}]\\)\"", TraditionalForm]},
  FrameStyle->Directive[FontSize -> 15],
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "ScalingFunctions" -> 
    None},
  PlotRange->{{0, 2}, {0, 8}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  RotateLabel->False,
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.8956700947369757`*^9, 3.8956704419192724`*^9, 
  3.895671025046344*^9, 3.895671254475441*^9, 3.8956731260791807`*^9, 
  3.8956764888689327`*^9, 3.8956790576497917`*^9, 3.8957485733674126`*^9, 
  3.8957532853548174`*^9, 3.895756524712311*^9, 3.8957587518790207`*^9, 
  3.895758977726225*^9, 3.8957593422901907`*^9, 3.895759403106267*^9, 
  3.8957596390214477`*^9, 3.895759691609788*^9, 3.895759827472419*^9, 
  3.895760059676918*^9, 3.8957609334321327`*^9, 3.8957609943004365`*^9, 
  3.8957611641402364`*^9, 3.895818725760618*^9, 3.895818826517378*^9, 
  3.8958188862515516`*^9, 3.895819259166627*^9, 3.8958193730309353`*^9, 
  3.89581951139474*^9, 3.89584361864001*^9, 3.89584445451706*^9, 
  3.8969073367617483`*^9, 3.8969083553758397`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"519fa367-3713-44ac-b7eb-571955b5a052"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3D bifurcation curves", "Title",
 CellChangeTimes->{{3.895475618755782*^9, 3.895475622324048*^9}, {
  3.8956477345179358`*^9, 
  3.895647736795082*^9}},ExpressionUUID->"1b7279de-0e9a-4073-b020-\
f91d9b567541"],

Cell["Mathematica continues codimension-two curves, if requested", "Text",
 CellChangeTimes->{{3.8968765379964027`*^9, 
  3.89687654933407*^9}},ExpressionUUID->"6e5294df-fd8c-47fb-85ca-\
cd85145d1851"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"checker", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Not]", 
     RowBox[{"ValueQ", "[", "critchange", "]"}]}], " ", "||", " ", 
    RowBox[{
     RowBox[{"Length", "[", "critchange", "]"}], "==", "0"}], " ", "||", " ", 
    RowBox[{"cod2", "!=", "\"\<y\>\""}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"checker", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lowerbound", "=", 
     RowBox[{"Range", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"upperbound", "=", 
     RowBox[{"Range", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"otherpar", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", "3"}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"par", ",", 
          RowBox[{"par3", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"index", "=", "1"}], ",", 
          RowBox[{"index", "<=", "2"}], ",", 
          RowBox[{"index", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", "parnum", "]"}], "]"}], "==", 
             RowBox[{"par", "[", 
              RowBox[{"[", "index", "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"index", "==", "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervalx", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervalx", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervaly", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervaly", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"otherpar", ",", "parnum"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"lowerbound", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "=", 
          RowBox[{"extrainterval", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"upperbound", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "=", 
          RowBox[{"extrainterval", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fixedparameter3", "=", "parnum"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"parval3", "=", "parval"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", 
       RowBox[{"Length", "[", "fixedpar", "]"}]}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "fixedparameter3", "]"}], "]"}], "==", 
         RowBox[{
          RowBox[{"fixedpar", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"parval3", ",", 
           RowBox[{"fixedpar", "[", 
            RowBox[{"[", "parnum", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"incond", "=", 
          RowBox[{"fixedpar", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"fixedpar3", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{"fixedpar", ",", 
       RowBox[{"{", 
        RowBox[{"parval3", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"conjprime3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "'"}], "[", "y_", "]"}], "->", 
       RowBox[{"HoldForm", "[", 
        FractionBox[
         RowBox[{"Conjugate", "[", 
          RowBox[{"D", "[", 
           RowBox[{"y", ",", "time"}], "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{"y", ",", "time"}], "]"}]], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"absprime3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "'"}], "[", "y_", "]"}], "->", 
       RowBox[{"HoldForm", "[", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"y", ",", "time"}], "]"}], "*", 
           RowBox[{"Conjugate", "[", "y", "]"}]}], "+", 
          RowBox[{"y", "*", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"D", "[", 
             RowBox[{"y", ",", "time"}], "]"}], "]"}]}]}], 
         RowBox[{"2", "*", 
          RowBox[{"D", "[", 
           RowBox[{"y", ",", "time"}], "]"}], "*", 
          RowBox[{"Abs", "[", "y", "]"}]}]], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"kineticsaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"kinetics", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zerodetaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zerodet", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zeroderaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zeroder", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"auxC3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"C3", "/.", "fixedpar3"}], "/.", 
           RowBox[{"kNF", "->", 
            SqrtBox["\[Mu]NF"]}]}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", "zeroderaux"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", "auxC3"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"ReleaseHold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"equations", ",", "time"}], "]"}], "/.", "conjprime3"}], "/.",
        "absprime3"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{"\[Mu]NF", "'"}], "[", "time", "]"}], "2"], "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"varnum", "=", "1"}], "nvar"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
         "2"]}], "-", 
       SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equations", "[", 
         RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"equationnumber", ",", 
         RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"allvar", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par3", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par3", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par3", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", "\[Mu]NF"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvartimedependent", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"allvar", "[", 
         RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", 
         RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"initialconditions", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "codimensiontwopoints", "]"}], "==", "1"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"initialconditions", ",", 
         RowBox[{"codimensiontwopoints", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"pointnum", "=", "1"}], ",", 
        RowBox[{"pointnum", "<=", 
         RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], ",", 
        RowBox[{"pointnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"inp", "=", 
          RowBox[{"HoldForm", "[", 
           RowBox[{"Input", "[", 
            RowBox[{
            "\"\<Would you like to continue point \>\"", " ", "<>", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"codimensiontwopoints", "[", 
                RowBox[{"[", "pointnum", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", "2"}], "]"}], "]"}], "]"}], " ", "<>", " ", 
             "\"\<[y/n]\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"inp", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"initialconditions", ",", 
              RowBox[{"codimensiontwopoints", "[", 
               RowBox[{"[", "pointnum", "]"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"solutioncurves3", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"bifnum", "=", "1"}], ",", 
      RowBox[{"bifnum", "<=", "numberofbifurcationcurves"}], ",", 
      RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"initialvalues", "=", 
        RowBox[{"initialconditions", "[", 
         RowBox[{"[", "bifnum", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"initialvalues", ",", "incond"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dereval", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"initialvalues", "[", 
              RowBox[{"[", "varnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"varnum", ",", 
            RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"initialderivatives", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"equations", "/.", 
             RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
            RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"dernumber", "=", "1"}], ",", 
         RowBox[{"dernumber", "<=", 
          RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
         RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equations", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialvalues", "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                RowBox[{
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equationsaux", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", 
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time", 
                 "]"}], "==", 
                RowBox[{
                 RowBox[{"extrainterval", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time", 
                 "]"}], "==", 
                RowBox[{
                 RowBox[{"extrainterval", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempsol", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NDSolve", "[", 
             RowBox[{"equationsaux", ",", "allvar", ",", 
              RowBox[{"{", 
               RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], ",", 
              RowBox[{"Method", "->", 
               RowBox[{"{", 
                RowBox[{
                "\"\<EquationSimplification\>\"", "->", "\"\<Residual\>\""}], 
                "}"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], " ", "&&", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"solutioncurves3", ",", "tempsol"}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "solutioncurves3", "]"}], "==", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{
            "{", "\"\<This script could not find a Codimension-two \
bifurcation curve for your desired parameters. Try changing tolerances or \
initial values\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8954756273405137`*^9, 3.895475680722141*^9}, {
   3.8954757199021873`*^9, 3.8954758654317746`*^9}, 3.8954810434786043`*^9, {
   3.89564353007386*^9, 3.8956435618080664`*^9}, {3.895647645975181*^9, 
   3.8956476865588245`*^9}, {3.8956479328569984`*^9, 3.895648092395144*^9}, 
   3.895649018040077*^9, {3.8956490500832844`*^9, 3.895649257820964*^9}, {
   3.8956493077475405`*^9, 3.8956494188913093`*^9}, {3.8956494644125137`*^9, 
   3.895649605964903*^9}, {3.8956500643300824`*^9, 3.895650070246585*^9}, 
   3.8956592913265467`*^9, {3.8956594469643993`*^9, 3.895659453193489*^9}, {
   3.895676570492354*^9, 3.89567657344588*^9}, {3.89568350308055*^9, 
   3.895683648539012*^9}, {3.8956836910193853`*^9, 3.89568370386314*^9}, {
   3.8956838209975967`*^9, 3.895683821660875*^9}, {3.895683863637514*^9, 
   3.8956838645487967`*^9}, {3.89568419948907*^9, 3.895684221602098*^9}, {
   3.8956846921169868`*^9, 3.895684698108713*^9}, {3.8956847421099863`*^9, 
   3.895684746342307*^9}, {3.8956849028087263`*^9, 3.8956849624188795`*^9}, {
   3.8956856734041705`*^9, 3.895685693929438*^9}, {3.8956857512385283`*^9, 
   3.895685751506445*^9}, {3.895686549929406*^9, 3.8956865528353987`*^9}, {
   3.8956866047754164`*^9, 3.8956867482981462`*^9}, {3.8956869361394515`*^9, 
   3.8956869599486666`*^9}, {3.895686991707305*^9, 3.8956870677566414`*^9}, {
   3.895687116649618*^9, 3.8956871189746037`*^9}, {3.8956871879575033`*^9, 
   3.8956872009934635`*^9}, {3.8956876620715685`*^9, 
   3.8956876940470743`*^9}, {3.895687746184574*^9, 3.895687759124637*^9}, {
   3.8956880062896843`*^9, 3.895688031844426*^9}, {3.8956881548866568`*^9, 
   3.895688155786559*^9}, {3.895688257910473*^9, 3.8956882936422844`*^9}, {
   3.8956883257030473`*^9, 3.895688403244361*^9}, {3.8956887751194715`*^9, 
   3.8956887801966853`*^9}, {3.8956888209053383`*^9, 3.895688824966505*^9}, {
   3.8956889656555414`*^9, 3.895688973744858*^9}, {3.895748654960019*^9, 
   3.8957486551683736`*^9}, {3.8957523722513633`*^9, 3.895752373768447*^9}, {
   3.8968770243344393`*^9, 3.89687703636053*^9}, {3.8968770668907347`*^9, 
   3.896877075466335*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"482e93db-e6df-423f-ba70-4d0a435202b3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Other Turing bifurcation curves", "Title",
 CellChangeTimes->{{3.89547591085975*^9, 
  3.895475915530171*^9}},ExpressionUUID->"8aeea5b5-47a5-4bfc-91b2-\
e38b668c0d13"],

Cell["\<\
As for the continuation of codimension two curves, an extra parameter is \
needed, this section computes more Turing bifurcation curves when that \
parameter is fixed at the parameter values provided above. The initial \
conditions considered are the codimension-two points found for that fixed \
parameter value in the previous cell\
\>", "Text",
 CellChangeTimes->{{3.896876563234068*^9, 3.89687660243521*^9}, {
  3.8968766546217346`*^9, 3.8968766615603895`*^9}, {3.8968771223123074`*^9, 
  3.896877169142969*^9}},ExpressionUUID->"54680546-436d-411a-b1b4-\
4c7c938a4711"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fixedparametervalues", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"initialconditions", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"turingbifurcationcurves", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"turingnumber", "=", "1"}], ",", 
      RowBox[{"turingnumber", "<=", 
       RowBox[{"Length", "[", "otherTuring", "]"}]}], ",", 
      RowBox[{"turingnumber", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"fixedparametervalues", ",", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "fixedparameter3", "]"}], "]"}], "->", 
          RowBox[{"otherTuring", "[", 
           RowBox[{"[", "turingnumber", "]"}], "]"}]}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"turingnumber", "=", "1"}], ",", 
      RowBox[{"turingnumber", "<=", 
       RowBox[{"Length", "[", "otherTuring", "]"}]}], ",", 
      RowBox[{"turingnumber", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"getout", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"outersolnum", "=", "1"}], ",", 
         RowBox[{"outersolnum", "<=", 
          RowBox[{"Length", "[", "solutioncurves3", "]"}]}], ",", 
         RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"getout", "==", "1"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"innersolnum", "=", "1"}], ",", 
            RowBox[{"innersolnum", "<=", 
             RowBox[{"Length", "[", 
              RowBox[{"solutioncurves3", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"solt", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"NMinimize", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time",
                     "]"}], "-", 
                    RowBox[{
                    RowBox[{"fixedparametervalues", "[", 
                    RowBox[{"[", "turingnumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"], "/.", 
                  RowBox[{
                   RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", "time"}], 
                "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<=", 
                RowBox[{"(", 
                 RowBox[{"time", "/.", 
                  RowBox[{"solt", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "<=", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"solt", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "tol"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"initialconditions", ",", 
                    RowBox[{"Check", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "/.", 
                    RowBox[{"solt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "Null"}], "]"}]}], 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"initialconditions", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allvar", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allvar", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{"initialconditions", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}], "/.", 
                    RowBox[{"solt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"getout", "=", "1"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]",
                 "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"bifnum", "=", "1"}], ",", 
      RowBox[{"bifnum", "<=", 
       RowBox[{"Length", "[", "initialconditions", "]"}]}], ",", 
      RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fixedparametereval", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "fixedparameter3", "]"}], "]"}], "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "fixedparameter3", "]"}], "]"}], "/.", 
            RowBox[{"initialconditions", "[", 
             RowBox[{"[", "bifnum", "]"}], "]"}]}], ")"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kineticsaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"kinetics", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", 
                RowBox[{"otherpar", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", 
              RowBox[{"otherpar", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"\[Mu]NF", "->", 
           RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zerodetaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"zerodet", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", 
                RowBox[{"otherpar", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", 
              RowBox[{"otherpar", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"\[Mu]NF", "->", 
           RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zeroderaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"zeroder", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", 
                RowBox[{"otherpar", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", 
              RowBox[{"otherpar", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"\[Mu]NF", "->", 
           RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", "zeroderaux"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time", "]"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"D", "[", 
         RowBox[{"equations", ",", "time"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "'"}], "[", 
            "time", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "'"}], "[", 
            "time", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[Mu]NF", "'"}], "[", "time", "]"}], "2"], "+", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"varnum", "=", "1"}], "nvar"], 
           SuperscriptBox[
            RowBox[{
             RowBox[{
              RowBox[{"var", "[", 
               RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}],
             "2"]}], "-", 
          SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"equations", "[", 
            RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"equationnumber", ",", 
            RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"initialvalues", "=", 
        RowBox[{"initialconditions", "[", 
         RowBox[{"[", "bifnum", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dereval", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"initialvalues", "[", 
              RowBox[{"[", "varnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"varnum", ",", 
            RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"initialderivatives", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"equations", "/.", 
             RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
            RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"dernumber", "=", "1"}], ",", 
         RowBox[{"dernumber", "<=", 
          RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
         RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equations", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialvalues", "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                RowBox[{
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equationsaux", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", 
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempsol", "=", 
           RowBox[{"NDSolve", "[", 
            RowBox[{"equationsaux", ",", "allvar", ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], ",", 
             RowBox[{"Method", "->", 
              RowBox[{"{", 
               RowBox[{
               "\"\<EquationSimplification\>\"", "->", "\"\<Residual\>\""}], 
               "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], " ", "&&", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"turingbifurcationcurves", ",", "tempsol"}], "]"}], 
             ";"}], ","}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8954759238653526`*^9, 3.8954759865585675`*^9}, {
  3.895643572304961*^9, 3.8956436047670174`*^9}, {3.8956481296260095`*^9, 
  3.89564820575352*^9}, {3.895649650965356*^9, 3.8956497256967926`*^9}, {
  3.895689469106891*^9, 3.895689484387652*^9}, {3.895689532343933*^9, 
  3.895689617869485*^9}, {3.895689674770615*^9, 3.8956896828142223`*^9}, {
  3.8956897253476787`*^9, 3.895689735228913*^9}, {3.8956898088363514`*^9, 
  3.895689912624589*^9}, {3.8956899615465884`*^9, 3.895689967384285*^9}, {
  3.895690037784216*^9, 3.8956900603790655`*^9}, {3.8956901129443216`*^9, 
  3.8956902457114444`*^9}, {3.89569030592418*^9, 3.8956903156685514`*^9}, {
  3.896877206445666*^9, 3.896877212330518*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"d1a38189-a75f-495a-8e90-0c9d80700ad3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Codimension-two bifurcation diagram plotting", "Title",
 CellChangeTimes->{
  3.8954760027248507`*^9},ExpressionUUID->"d8e321cb-8dd8-47b4-8dd2-\
a1cdcb039ab4"],

Cell["\<\
Mathematica plots the codimension-two curve with all the other Turing \
bifurcation curves found in the previous cell. The intersections between the \
Turing curves and the codimension-two curve will also be marked.\
\>", "Text",
 CellChangeTimes->{{3.8968766738681097`*^9, 
  3.8968767413823028`*^9}},ExpressionUUID->"abc3d507-0518-4b9a-a98d-\
7d6f72638fbd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"parnames3", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"counter", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", "3"}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"par", ",", 
          RowBox[{"par3", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"parnames3", ",", 
           RowBox[{"parnames", "[", 
            RowBox[{"[", "counter", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"counter", "=", 
          RowBox[{"counter", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "par3name", "]"}], "==", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"parnames3", ",", "par3name"}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"parnames3", ",", 
            RowBox[{"par3", "[", 
             RowBox[{"[", "fixedparameter3", "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"bifcurveplot", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"turingcurveplot", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"critpoints", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"par3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"par3", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/.", 
            RowBox[{"initialconditions", "[", 
             RowBox[{"[", "bifnum", "]"}], "]"}]}], "]"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"bifnum", ",", 
         RowBox[{"Length", "[", "initialconditions", "]"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"outersolnum", "=", "1"}], ",", 
      RowBox[{"outersolnum", "<=", 
       RowBox[{"Length", "[", "turingbifurcationcurves", "]"}]}], ",", 
      RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"innersolnum", "=", "1"}], ",", 
        RowBox[{"innersolnum", "<=", 
         RowBox[{"Length", "[", 
          RowBox[{"turingbifurcationcurves", "[", 
           RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"aux", "=", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
            "]"}], "/.", "variabledependence"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Variables", "[", 
             RowBox[{
              RowBox[{"aux", "/.", 
               RowBox[{
                RowBox[{"turingbifurcationcurves", "[", 
                 RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
              RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"auxnonzero", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}], 
                "}"}]}]}], "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar3"}], "/.", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"turingbifurcationcurves", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"auxC3", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}], 
                "}"}]}]}], "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"C3", "/.", "fixedpar3"}], "/.", 
                   RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"turingbifurcationcurves", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                   " ", 
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], "<", "0"}]}], 
                 " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                   " ", 
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], ">", "0"}]}], 
                 " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], "<", "0"}]}], " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Green", ",", "Dotted"}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"outersolnum", "=", "1"}], ",", 
      RowBox[{"outersolnum", "<=", 
       RowBox[{"Length", "[", "solutioncurves3", "]"}]}], ",", 
      RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"innersolnum", "=", "1"}], ",", 
        RowBox[{"innersolnum", "<=", 
         RowBox[{"Length", "[", 
          RowBox[{"solutioncurves3", "[", 
           RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"aux", "=", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
            "]"}], "/.", "variabledependence"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Variables", "[", 
             RowBox[{
              RowBox[{"aux", "/.", 
               RowBox[{
                RowBox[{"solutioncurves3", "[", 
                 RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
              RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"auxnonzero", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
             "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar3"}], "/.", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"solutioncurves3", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}]}], "/.", 
                 RowBox[{
                  RowBox[{"solutioncurves3", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", " ", 
                 RowBox[{
                  RowBox[{"solutioncurves3", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "->", "Black"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"bifcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bifcurveplot", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"turingcurveplot", ",", "bifcurveplot"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"CreateDocument", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", "plot3", "]"}], ",", 
      RowBox[{"WindowSize", "->", 
       RowBox[{"{", 
        RowBox[{"500", ",", "500"}], "}"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ValueQ", "[", "critpoints", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"plot3", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"bifcurveplot", ",", "critpoints", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "StandardForm"}], "]"}]}],
            "}"}]}], ",", 
         RowBox[{"RotateLabel", "->", "False"}], ",", 
         RowBox[{"AxesStyle", "->", 
          RowBox[{"Directive", "[", 
           RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
         RowBox[{"BoxRatios", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}], " ", 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"plot3", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"bifcurveplot", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "StandardForm"}], "]"}]}],
            "}"}]}], ",", 
         RowBox[{"RotateLabel", "->", "False"}], ",", 
         RowBox[{"AxesStyle", "->", 
          RowBox[{"Directive", "[", 
           RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
         RowBox[{"BoxRatios", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.895476046596933*^9, 3.89547608140477*^9}, {
   3.8956436164038916`*^9, 3.89564364598274*^9}, {3.8956482322981625`*^9, 
   3.8956482508370934`*^9}, {3.8956499003847294`*^9, 
   3.8956499217983027`*^9}, {3.895690376580452*^9, 3.895690472517498*^9}, {
   3.8956914996468005`*^9, 3.8956915003492856`*^9}, {3.895691549426552*^9, 
   3.895691587904831*^9}, {3.895691918821433*^9, 3.8956919555170517`*^9}, {
   3.8956920251025147`*^9, 3.89569206214524*^9}, {3.895692094525321*^9, 
   3.895692109882864*^9}, {3.895692978415348*^9, 3.8956930242312098`*^9}, {
   3.895693206646363*^9, 3.8956932422293415`*^9}, {3.895693997116338*^9, 
   3.895694001905223*^9}, {3.895697246384327*^9, 3.8956972559521537`*^9}, 
   3.8956974256394386`*^9, {3.89569763833916*^9, 3.8956976811608944`*^9}, {
   3.895751951268671*^9, 3.8957520009447107`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"7d6aac12-cf9b-4179-a52e-ac2b6dc47746"],

Cell[BoxData[
 Graphics3DBox[{{{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], AbsoluteThickness[2], 
       Line3DBox[{{1.9601385305936663`, 4.764560328305439*^-22, 
        8.000989742388}, {1.7912689037426566`, 4.764560328305439*^-22, 
        6.767659294643479}, {1.6299857087931642`, 4.764560328305439*^-22, 
        5.534178638903451}, {1.5521966493018449`, 4.764560328305439*^-22, 
        4.917436585758178}, {1.4763178512440966`, 4.764560328305439*^-22, 
        4.300765236250194}, {1.4576481120040314`, 4.764560328305439*^-22, 
        4.146621011383659}, {1.4567177874900714`, 4.764560328305439*^-22, 
        4.138914162351574}}]},
      Annotation[#, "Charting`Private`Tag$10510#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 0, 1], AbsoluteThickness[2], Line3DBox[CompressedData["
1:eJxNyH1Q0nccwHFGy0wHgo/hQ9asUzvdbaJhePXBh7TcMinkh2KKEGppoVYS
E81hWVOnzgbnKPXYDdOaN01x3Si7OVema+W88txgd+maqIeRC7Q6t3X7w+/3
fff+57VZLDsgJZNIJPab17yZGZfvb0leAtL/qWK8zQnRwmoaZ2pk69d1TsjH
Dlor22xunOld3Gy60bHqa+Ib4t4yUDmn2vlNXkXIGTVeLTIFhcO+uU/d9rt9
1du/+8JyhuzKIYc/5jL3It+ZkNiwXOvMYQhzm4N3PV91WuJTUYDEAh6x+4UL
Atuq9wZdzKZLRuHF9rt501uRD93+KpE01wdvv+IdPO6PXB91NrXV1AmShu6f
enyQ033VafeiWuFJcHN5lDfyJycd36SWqmHADhqpF/KMX0MLNqU1Qv5DPjz1
RF6f/vJkhKEGWPy14acxr/AxPjJ9VA3QNMj2x7wrIFH+2/tVkFvITLvvgXwy
cK9C8roSQgONBiXm0edlLksfVIDwgjUkCnPrzI93+Zll0Be2/rHNHfkhnVlG
oSqA1HWF14H5z+Lxw9delELGo2+vSzFvGJYX1CSfArvE0RyAOZui0x64dQL2
UEysCTryDbrrD2YKSkCcfm1Zgzlx0a2kmCiGYOB/ysW8RzPpuy6lCHhNflYa
5jkXPKJ/mToOr3XD/FEa8hU5UVy6/Rj0jn723nnM5dr6tUM3CyBNv/h9Eua0
O5o7O8uPgrrL5CBjXrV5QjcUewT6Gh9UD7ohv9VJhH0ZmQ8CQiGowpwxxArW
xubBlk22OMBctUh36FNywRCysvIvFfm4xbt/S7kUeolWkRHzCL+k+4NXD4OT
+w6n05ibzpGFH85LgMq18nZg3mJelg0nSKBtwQh2CvKiqbJu+mUxBMy/7Ddg
Lj52JaLTWQyRz+1aOeYdn4jqBipzgMaRnojEPHksa+M6hwhm9mvG7O8g39Oy
QRWoFEFFLfNSD+YD3JiUhX+yoYKzzV6Muc1yVUcNyoaRPxhqJuaXWOy/9Pws
ECdtMz9zRa6tVUSUnD0EZrepnm7MN8bfNsaPZEJq+EhkIeYLhX+Hql0yQXF0
cDYEc7uhY98EIYQEbnLYnAvyd/2ml57dyABDbwqtHfOPZ+9p1Z4ZcI4dXpmL
ecki6YafKh1mPfOCQjBXjmXtvrwsgLr+MuWf65G/cub9MH5EAI0BHjw95mRT
PSt6joAVH1eGCnP3M5Ofx+gJCFL6PszCfHFe4jKcQ8B/RWDVkQ==
        "]]},
      Annotation[#, 
       "Charting`Private`Tag$10557#1"]& ]}, {}}, {{}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], AbsoluteThickness[2], 
       Line3DBox[{{1.4564016444025771`, 4.764560328305439*^-22, 
        4.136294659054795}, {1.4647401819977302`, 4.764560328305439*^-22, 
        4.205291400020241}, {1.4856920549678612`, 4.764560328305439*^-22, 
        4.3777945188952065`}, {1.5067943258483543`, 4.764560328305439*^-22, 
        4.550310702893824}, {1.5494486824997238`, 4.764560328305439*^-22, 
        4.895370238093529}, {1.5927010601482299`, 4.764560328305439*^-22, 
        5.240451897523546}, {1.7716679577042116`, 4.764560328305439*^-22, 
        6.6208039746113645`}, {1.9601385305936663`, 4.764560328305439*^-22, 
        8.000989742388}}]},
      Annotation[#, "Charting`Private`Tag$10608#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 0, 1], AbsoluteThickness[2], Line3DBox[CompressedData["
1:eJxN021QEnYcB3CVwFRUHIZEsfNhTB3iNCar5fyRm55r7tplhmYICIZCii4f
Gk7PTDu1XbKiM9YoPcX5kLbVFpQ2pEx3uqTbrGW6wLw9eGLnVOzO9Fy3F/7/
37vvm8+r75tvUJZqf7abi4vLrlclvGrIF4wHmR7z4PJ/qnYvzEo9f5YIILu4
P60C82/tLYsv9QIw1wyO6TFvjON25kwI4GaJMvAZ5usnlsdfyNJA+LXOHuSJ
PDgrN/j12TTwHfMXiTFvOsC6JShKhxGbKrAV8xaSgUCiHIKVfqdoGvMFtVzK
bj8EF4mpj0O9sD1XK2OoqRmQR+ynKzHXr7udPON+GKKGQu51YL5K9zpfcOMw
kCxbjXOYNy+88aGzXAgvxaVsDhl5p921LTY+E5gUn/1KzHM0Q6OjZBG89dAx
1IN544XJwNklEXRbvxqcw1w7U/ErKU8MTRTLULQ3coc60tQ9L4bz92urizDf
tz295W21BH6pjli9hnkGzXax2i0LmOHk58uYf8MhJgY0ZcFvq3tFPB/kHKa8
K/p9KUSle5HKMC81K1prF6VwtX235ifMi5aJ/7B/kEFTV+25Ncz/zS+VHivO
hgjdvok9vsgH3wu7c1ZwBIZnkmwnMGcp9KVhsXKYnoj0tmDu+m5u3fXIHDAQ
DVoiBbny7y/7Yj7JhbrnxuQEzOu/yw9vKFRAm/qyrB7zgwNklum+Etw/mMoc
xVye//GmqKQ8yI4PdXj7Ifd44N980JoPZM5kXArmKdNTddwDBRDbwGVrMVdO
PkrdllwInX+Z3Mcw1x0nMBTCzyAjQX6X8Rpy7pyRZes5BtSZlB1CzG8m1Ohq
6MUwPhWaYsCcuSvaM8heAqxETtsM5ob6U8FPx44Dk+BNiqQi36ro7S9nlAHZ
+CmoMV+yRtDmaBVwmWp9PIA5zSLUPBmoBBXv4TDDH/l8FM+1gXUSTksW9SWY
G7/vm3wn7hSE9riqxjEvmNYF3I6uh6XhLIJkC/LyLUWe5p0auKVbkzJpyIcd
smfGp1qoHGkaVwcg/9NRJeOR9NCckEylb0d+pOw0z7SjAyK0zOLuEOQxfaZL
P3KvQ6Fk1C6KRz7ySHX7LncAzm2y6XM6kB8VX9kcw34C/Nw79jd3LqE/mtc2
b/uDwF9Jqrtm/ty54X5O30qn0INvvfF74si95Q0H5iXLypQPv/Bo14KI8WLD
M6+09zYGUfh7w8+0hn2EnK7xW++tovD/A4JKy9w=
        "]]},
      Annotation[#, 
       "Charting`Private`Tag$10636#1"]& ]}, {}}, {{}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], AbsoluteThickness[2], 
       Line3DBox[{{2.0009937735534837`, 0.4999999999999999, 
        1.6458013929274953`}, {1.917122260808584, 0.4999999999999999, 
        1.508099357126499}}]},
      Annotation[#, "Charting`Private`Tag$10689#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 0, 1], AbsoluteThickness[2], Line3DBox[CompressedData["
1:eJxTTMoPSmViYGAQAmJmIA4M/fqwY+Y/+3//QeC+fRG7lSUf0w/7olrmT91t
CPErfurm3x59t2fNt5rnxfsXLn45balfXPVX+8Unba4Gz/4NF9/gUNtmrPLZ
3vAZn7mV+S+4eJru/wlRzz/Yv3wnqJx/8DtcfIXRIymPNy/tu1iPK4q9+QoX
XyqpdnotyxN7RRY7sbgrn+Hi+ZFzVmrH3rJfsvr6i96Tn+DikWqGggVFl+25
5+00Onb8I1w86rLj1om5J+077iRGhHoixLum/5sic/+Q/dSslQ8uHv8AF/93
eeNKg7s77K27/m/nrEeIK85p+B5Wv8l+oRijVkA8Qlx96p5MD4sN9go+5kf/
2iLEo998mPL50hp7Qw7RBhZLhPhWl9Whttlr7NM3XZLpN0aIH2lWSgtmXWN/
7nLwYXsDhPg9tX3J18+utgcACCIPpg==
        "]]},
      Annotation[#, "Charting`Private`Tag$10715#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 1, 0], AbsoluteThickness[2], Dashing[{0, Small}], 
       Line3DBox[CompressedData["
1:eJxNzn1Q0wUcBvC15csOSHxBweQQJqFsOqFiOtEvuihhicLSDRgyBoMxxQkj
xBUvSXiAChZ4sHMXL+Jc0BwMPQmTUqEXCQzY2CISQqFoY1PJskNG9o+/73P3
/PP547nHVyyPkZBJJBL7eSnPGz6hDVrv/hCc8/9nFPhdnW0lt5qgemTV8iUv
EX5EFPpr679NcEMondQ/drzwLWZW+jpOM1TbKutrJwn3nn1Xl/BJMzC6zCGP
bhJ+WvGm9frUF+BtT4olNxL+iDN39pT8MqyofTmi+HXC/RpuTvektIEx8EBh
dL39hb9lZCxP+70DpNSRZPUc4a1tWsdDYwswl/HOxfoQO7NeNOXu+xpI78mM
UdEJ52xmSJ3SelhgLn4lP4jwhG0akd8qNWQtNfJcWIQXAb205IdK+G1D/ix9
K+FG7tQTE6UCujSD2fFswiMnElMdPqWwLDUgg7KN8L8tmxa6biyGliVQdwj5
mFU/PnHsBJi7Nyd/iZzmpxYythRCo5b5wI585nzZHe3aPOhQANkzlHC7jHtQ
oFTCV6LQJjZy7e0RD6lXLlDPDuveQx7sLusNC82BcNVHVjlym//iqadF2bCf
d63gY+TnzW6OPUsVQF8T4axCnnOLu2j4fiac8fhuphG5d9MJf0HXUWg3JDoN
yFeXqNNO6uTAVL4j+AY59f25vM/HM2DIc1j1I3LRVGc4Zd9h+Gycd9SMPHJo
ZUPvMxns7pSLxpGbOqY1dH060J7em7cibx78WldYKQXT4bsfPkFuab3u8kZV
GtSTZlRO5Bq326rL51JhktWtXrid8Plv+xvvdEiARC2juiP/hXs1qnQ0Bc40
9LK8kF/8S9Gf65kCMJos9kVe7WAGtB9Khj5mPy0QeUz+pcxFN8Sww3ZRHoz8
+z/qsvXrxLBxb4GEjbyqr8SgqEkC3cTKgV3IAwYfH6ugJoGNM3YqEnmSQRi2
6bQINGspVB5ycne5ab2rCIL38IfikK+IDKoeCEmExV7Hi8T4f0t5b5bkIKRc
pY3KkMtkIZbU8gQYIsdrs5C/epxa+9pPQrgr2unxAfKo6YLiAlchKE2U7UXI
8yStlrAD8fBnzrOKMuTdFp5YciUO/FbL3/4UOY3BvebvFgd5Omu0Cjlrx5qB
rbmxwBGM7KtDbrf87FNuE8A0LWe/FnlW82TNhXgB3GOo+vTIIzJ0AexhPhh6
alyuIL90xEmLquKD74Ox6HbkpTsXBP6zlw//AQXvWYI=
        "]]},
      Annotation[#, "Charting`Private`Tag$10741#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], AbsoluteThickness[2], 
       Line3DBox[{{1.9175630335648524`, 0.4999999999999999, 
        1.5088214699639748`}, {2.0009937735534837`, 0.4999999999999999, 
        1.6458013929274953`}}]},
      Annotation[#, "Charting`Private`Tag$10767#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 0, 1], AbsoluteThickness[2], Line3DBox[CompressedData["
1:eJxTTMoPSmViYGAQAmJmIP7R8uqxr8EH+3//QeC+vdWVmG87z62257qUEHjF
CCH+cHfUorU/VttnuVRHrrBBiIfbKKxT37bG3lJlraqxK0J80VMl20VVa+3P
bzkSMyUEIT5Zb1bLA7n19spp+tclkhHiirc/vFlWvsHeaMm8+KBVCPHHR3d/
q1XbZs/nl9x2ROEjXJzLMDn97NkD9htM525/MxEh/rqczat6/jF7v/52fsey
T3BxzV0rGIXcLtp//hTu/zDxM1x86+VtuhvSr9t3nzv3LsblK1x84amVHj5P
Htrb9T3KNGb7Dhf/kjcx+tGk5/bPX129ED71J1z8euTBtVOPv7e/ZT3RQkTq
N1zcJuir2IvgT/ZeioFGUVv+wMWnpU078+LVF/sV6w3q4iP/wcUjXIWWsc38
br/j2/nnwjMR4lNb3iz2Y/xhDwApwhgN
        "]]},
      Annotation[#, "Charting`Private`Tag$10793#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 1, 0], AbsoluteThickness[2], Dashing[{0, Small}], 
       Line3DBox[CompressedData["
1:eJxNzX1Q0gccBnAmkJr09kfTc+UAW1nOptZVIvLtZbZmJRWdgIgvmCW+0vxd
eCLXpCm5jGVcYaZRKWlWE2drqO2lfFnNbFnt2DJf2IyOXOpE3Tknzv3T7/vc
Pf987rl7WLLsfSluFApl01ypc2UNDuy1RIyAa/b/9EPxFvqav/lC8KwSF9xE
zijRdk6UCME7K67BjPxqeoFyQ6cQTBnlFbXIFVnr67+OEcH82uQFl5AvL7B7
9PSJYPK5ZeYcchHT0cxNE0Ok/4j6NPKi/NQVGo9YKOUEiE4gl+oIEFTFgvPD
FOkx5DbRv1uyBRKo5oVsUiHvbnbukHvGwbfibk0O8o4Z3p2XLXHwRxTNPx35
fuONpjatFDhPynYnI6d9vnqVbk88JPgV1EiQv8oOBTozAYj48SQB8rYl9bV0
90RQFf1ashM54eI31+UnQu7jt1dtQz5BjfFaSEuCMmbOfQ7y7b7q1+bSJCgy
3P0pFPnkPVmD0E8Gzw6Zh1YjX2elEsF35jwyrJWF3IviU/MsORmGLhu6fZA7
lvVnurMOQLSp17AI77VPXPsdB8BmWDo8D/ms0r+j9asUiFhninRxSZ9f8eI5
zXgQ7E/TGieQ75CvHVfrDkHVYe+wP5H/Y8mN23UyFQYYgdM25Gt5zG+gRQ4q
p8NqRZ5lPMLOHE2DZex+zwfIA059yWbIMuC39tR73yPnxPAl5ROZINc5yxuR
m3qZlRfKsqEzUK6vRi4udFjcOhXw3nm4fgZ5bV/8lePWw5DFGkgpRK6uHKIS
b+XAGP1FlwJ5Y3RHrwdBwMeMIKsQ+fhgXriedgS6Wm1j4chDhpvMUW65YDiR
0P4Oco0yqC8gLA8u6aSPnOGks5XB144+zYdAc1VmC3LNdKQ6IuBTcG3+y04g
P53xyQ++GzTQy91zio78R7GyifJuIbxkfNYXzyF9+LZKMsooBhnn/iNBGOme
3PWTaXwd/JL3xUP2RtJlW5e3LTbqIc+L7/wolHT71MBR/eLzcIvdnuEdRHoP
8fPo9IWLIKi8uLKBTTq1NTbhd60JGhOPC2w00vWC6A88aupBXXF27LF2+I0f
rPbjbVbchqnZGWWPD7n3/U4aoqi8Ca94xvSpY6Tnls/eUm00Qz7X3ZhqQb82
RZddcgNGYoNL29xG3/j786IWFr+ugzULBs9Ql5De1UQVj92tg/8Am4c53w==

        "]]},
      Annotation[#, "Charting`Private`Tag$10821#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], AbsoluteThickness[2], 
       Line3DBox[{{2.000999130373891, 0.9999999992845877, 
        0.8030399622454749}, {1.9013592276606022`, 0.9999999992845877, 
        0.735857574251727}, {1.8121632213789243`, 0.9999999992845877, 
        0.6744757073300819}, {1.7716185806477114`, 0.9999999992845877, 
        0.6461398371782818}, {1.7337477459185222`, 0.9999999992845877, 
        0.6194055271370326}, {1.7246895798564297`, 0.9999999992845877, 
        0.6129710345514169}, {1.7180016263353861`, 0.9999999992845877, 
        0.608210019546037}}], Line3DBox[CompressedData["
1:eJxTTMoPSmViYGAQAmJmIBaRaT1yz+uD/eo1c//////evpZBeI2/xlL7t1lM
dRuRxGuM5WtbVZfam2tH7M1GEo+dnvfeWnGpfdfFX/fueyLErz86o7RWYqm9
K3N4YzCSeM3+a1wqAkvtIx/a3sm1R4gHS3nlN9Qvse9mTL0bbYIQn75/dnvY
l8X2Fscc7yrrIcSjPHf8r9y42P7k1C3nPqshxLsZP13+nbfY3m+T8rPdSkju
kctS7fddbH9DsIbloCxCvKmZefFs7cX2xyf+XnlUCiG+6VtstqHUYnuVJZeF
dcUR4kynAzPUOBbbR7wXu/1NBCEue/flxLX/FtlfLRATNBRCiCu0BLtM+rLI
fsHEb5viBRDiPfqX9VjfL7JvMvaUO8SLENfbsHlz54tF9muu7nt3hgsh/ubd
Qo2Yx4vsAU1s+1w=
        "]]},
      Annotation[#, "Charting`Private`Tag$10849#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 0, 1], AbsoluteThickness[2], Line3DBox[CompressedData["
1:eJxTTMoPSmViYGBQAWJmIH7K/UBKvvq3/eo1c//////eXsdcOPJ+8WP7yzJy
ix4VI8S3xt2p7st8bC91uVhAIgAh7nW8JLvU7LH91Af7Wj7pIMQP/z54ToPl
sX1eXV9o34tfcPHlbivc3y18ZP874N/hJcsQ4nNWl3047/TI/sQW1TlJz3/A
xV2S2/QjEu/bHy8yPKo/6ztcfJLFm6Y/2bftb+5M2iq++ytc/BJLfmR23VX7
9bzWWjemfIGL57QqNDGuv2i/VX5asG/gZ7j4q52f/4XMP2XfrtfL7TrzE1xc
5F9K69qSo/Yi0omb1osjxK89nrFad89B+08+DdOPHvoIFz+/Z3KjSuc++2N3
xDiN6hDihTpryv07d9k3mJQEa3shxAWlXQzZm7fbe9nuPPtGCSG+vH2/q6zD
VvuyrZs5ev9/gItrvORO2Gy72f7u99Ubqh4jxINuqVq1rt1oL/r55er80wjx
phcdagLxG+z3f56+23cLQtwgN+hOjd86+71Xa7deWoAQ/zhD90ll6Bp7y0nt
S9N6EeIXFiiW3ipdZd84S+lxWzVC/P28143G11fY83TNs6zMRlKfJqv0u3a5
/dyed1U3kxDiPpd7peQvLrPnWchYqxWFEG8+1nJbX3eZ/dcZ0zz4wxDiv9W3
ytc/XmofXu7+8GkgQvzxle2J1bOX2qupm0ad8keIz2dyWClcsdQ+zE4+YqUv
Qrz73Ush/tCl9nOTcrum+SDEi5MzxDc6L7U3r5/F3eSNEF9r/v5KltFS+5KV
q5bYIInPnpr/TkZvqb3+Ry+F714IcYs+/5oLmkvtn9ycaP8ISfz8/IpFbRpL
7QHpgwJy
        "]]},
      Annotation[#, "Charting`Private`Tag$10875#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 1, 0], AbsoluteThickness[2], Dashing[{0, Small}], 
       Line3DBox[CompressedData["
1:eJxF030w03EcB/Blsju7C5FaQ3JaeWgOXUa6z69zqES00O7sOhsucjlT6ha6
0gMuiWrRiWyeMoREyiITetCdPOTZCGkeVjuROZa/vt8/3v+87v3f+967eTGn
wnVIJBJjI+SNaCKO21VSfoO0/KlWq1XBXEfyZ75CDDV6H4Ky9bCPrNpc+zsm
hug6zykVGbuZPN6ZtdHfVha6ZjikQk4RLKib7SVAcM1KBXLsDa1p5eWpEhC+
avJZrMQeGnFRwlmSQHpWR8tKLnaTgxW1hlGFQAz3rsuSsOf15Vhmny4CFi3Z
24iPndw03gXsYnjQf4Bb5Yk96DpTmXO7BCybDo1rbbCfSdmXt9pWCtrAljC1
PnYRm/nPzrcMQtxoNxuUC8i5506K1FopiMy59YmfsPc8l8xu7ayAAaeJbl4h
dkbmlMmTzVXw+ET15FoCdjNuQGKSezWENctyWwOw9ydZiWvya8AvYd3F2Qx7
lgWVFBxZC6yC+4T+xDxy/xtZjd+j60C8YzF2XYQ92YmSFmfRAKqj7GnBEezf
ttBZOb6NkDimzNAdmEPO4YeLe22bYbmUvnTXE3uchun/xUoOP+dB6J86i3zh
xevoKxbtoOf1w4MXokT+i35sp/dsJ6SZPoqvi5pBvp/Md5jY1Qt+7Hf02LJJ
5Hd4mwz+0MfhvCZV6jPYg9zLtIRT7qqGlXSLEWueHLnupRhhAW0F3BxujToL
xMhjMrre2LmSCFuFzNFcwkDeN8NUpU+SiQsK42y/3BLkhorIwykZFGLPULfw
rLodubv92/q8BCpRUywr8igbRF7rkx9MDzAgNJdDR99fncZ/sX4mreAbEYFf
ObSXH/EvKvldnY4GxsR2JbVIsrSMfNhlWswYMCGYD/e2UXVIBNpXkZk7dM+U
+A8+ihkY
        "]]},
      Annotation[#, "Charting`Private`Tag$10901#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[1, 0, 0], AbsoluteThickness[2], 
       Line3DBox[{{1.0026107700834859`, 0.9999999992845877, 
        0.036889770245456026`}, {1.0033610630851346`, 0.9999999992845877, 
        0.036930514314381976`}, {1.0040067530369199`, 0.9999999992845877, 
        0.03698064487116421}, {1.0098565386543106`, 0.9999999992845877, 
        0.03804914104283176}, {1.0130362565012163`, 0.9999999992845877, 
        0.039064849789651385`}, {1.015487027780088, 0.9999999992845877, 
        0.04003585823319801}, {1.017700960902905, 0.9999999992845877, 
        0.041041778647002425`}, {1.0179892495878566`, 0.9999999992845877, 
        0.04118121573860795}, {1.0182753246357263`, 0.9999999992845877, 
        0.04132143383589253}, {1.0182788872087367`, 0.9999999992845877, 
        0.04132319156205904}}], 
       Line3DBox[{{1.7181040974849522`, 0.9999999992845877, 
        0.6082830326251468}, {1.7281183417953574`, 0.9999999992845877, 
        0.6154085245990341}, {1.738334805171076, 0.9999999992845877, 
        0.6226579625858217}, {1.7487556206470591`, 0.9999999992845877, 
        0.6300320008560423}, {1.770217774223463, 0.9999999992845877, 
        0.6451556566450642}, {1.7925171527178156`, 0.9999999992845877, 
        0.6607812534979829}, {1.8901775244340444`, 0.9999999992845877, 
        0.7282305062108689}, {2.000999130373891, 0.9999999992845877, 
        0.8030399622454749}}]},
      Annotation[#, "Charting`Private`Tag$10927#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 0, 1], AbsoluteThickness[2], Line3DBox[CompressedData["
1:eJxN0FtIk3EYgHG1TSpplLqBSCsnHgJbeRo2D+9oUmkts8Ns4k3LEypMh9ZS
DENlGxtlpNYa29L8tmnmGku+uaQyWDnTQaDmHKJTJCzEU8OR4PLq+3vx3Pwu
nyih6HpJUEBAQPReB/YS5xjli7nr8KZf4/f718AqkKQo4jGQjMbiMZeRi4Zd
OnMCBpNqenr1Pj86FDmQl4iBLPS5xrbPuc/EFWupGLB1MfOkK8gXgrHpNjYG
SfbZQNU+N/fi9hkuBpvdK4YEHnJoksvjeBhUtQtG7uUh14Q4DxrFGDyJ7Cq3
5SPfkOKsly8wUM3b3Yl85Oe2piI8yxio1ynHVYXI2d/1s7RUPRi+tIbhQuTM
ZhrjkVMPzDx+2bcK5GN+1cygyADaMsNPaz3y88ZjnnS7ESboVbl9SuRPh1Up
GcV9kP9JSK3VIvcG115oi+iHDu3Izl0LclvNaXcRawDwAm/3IQdyRmmmJC3r
Hbxu5FxzLyAnPYhyaGRm6GkK00l3kXcdUXT6mRboJJs7ySc2CH+8SleuBQ+C
IHl5qiwHeSvLFT14Hwe1J7s8uxF5abvoT12DDT6ncZSUD8iTdKbKQNpH4IuT
9X3hm4RPtHC+jmMjMPReMpalQL4ZIo0rptjBfPHq/Cv2FuHVQQJR0a4Dfjtz
KNaWv+hDc/hcjeQHcH38HbrMS7hJ0bhNmZmE6RWLujBim3C99NLth24XZBzu
IXNKfITj46u/kl1zcIfEYL89849w+6i1y9fhgd7pgrqbw8jPthh48cJF2K4M
M8bd2iE8lnmSbM5cAiqVlHqjAXm9KVR9qnYJ/gOJ4u2q
        "]]},
      Annotation[#, "Charting`Private`Tag$10953#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {RGBColor[0, 1, 0], AbsoluteThickness[2], Dashing[{0, Small}], 
       Line3DBox[CompressedData["
1:eJxNz31Qy3EcB/DZoma74pQVUtGk60EPknT6/E5OrY4RQp7W7kYRurZzpafr
lO7qollXHmb0W2usbOkydFwS5aiuqTiGUiuzGjUtaWr6x+/rj/c/r3vf++7t
wT0TxyOTSCS/uVDm4l/m1Uojk7Ca2htWq/UHXO4XirUXl2Kr28mC2bYp+Of+
x/deqbVzwhY+n8l5EG4iXHnT6nMwbQnGMdiK6M56wq1Vq5jp8sVYjjemxge0
hK9j8TfGlDlgdunqDk+n14RvZZ8PXG6hYYaW8rG4ujrCLw7xWQ6xdpi7iMoU
iI4RfuutZkfxTRuMMah56BZUQbgXVb2ZNk7CAtmfL2jmNRO+J8gnd5oyDcOy
caPYtYfwLQcFco7EBN5ie80Rsg7t7yrPp7MGIOuK0NZ8FP2Kovteq4nsBW+l
+WtEvIHwbw7Bvj6LOqHn7IfH2akjhNdHv6D9ut0GlyoHUhjYKOHZmvHCq9AC
iUwpt6MdeYTm0/DppKeQ0OAkTA01Eu5gsAl7o3wMaQVdihIR8v1e2C5FxCPg
G9xb9O+Rf3HhJ8Wq1dCcN/RV5/KdcItkw4tT2Q0Q+U53P4ONfHq8Xqivr4eU
6qbMoEzkl3kVksmYe5DcdD3+qAw5vUiw5o9FBV1Dm7bpXyL/7dl5Yp/uLrBb
Uxkho8jx/OSE+JEaoChe+abQfxAubVmfOxGmgIbEQYVxLfIsZw/eaPdtaHjl
sqRrG/J9uVG/g87JoZs1X32ai5x3cgLPO1AN24WFrY45yGXUYS0kyKBNNxEa
LUG+M+RwEzWxCsJnlEaSCjm10aS3n5TCCpVY3teMnPvEptxVKAWmmlJa3YGc
HqXrDTwsBUuG37IkLfLenMixWh8puPNWmksGkV/zzwxd7iiFqe1MKhj/2/cI
8W6cwUHV6xTA+ImcJnAxh/3EIfqZZspvGnnsbjdZwTcctJ7kO6WzyOWc/aSA
IRwEjfI8OnmM8BWf0p4XfcEhPW6E009BbjkbsxP6cTB9DH5fvAD50iJ2sqkP
B7dkEr/SFrkoesR6aK7/F8hzeD8=
        "]]},
      Annotation[#, "Charting`Private`Tag$10981#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {GrayLevel[0], AbsoluteThickness[2], Line3DBox[CompressedData["
1:eJwV13k8VF0YB3BbZJu5KUr211KEJCmi56iohChLm0IoZE8klLUSoVRUQlGS
7LJmKFK2ZA/ZDRGTGcxMg3lvf9x/vp/53Pucc57zO2fkHDyPO3FxcHAs4w83
/ng8ztqhYkGHa5+tNUwdzEmXuLqi/7AwtOFryKAo7lOVt5WYeuakWPYZi6a/
GIoyrS/hxF099oFs/EZzEm/sD/lXTAxJlhmP/zCnQ2tE3YuVpGOkTNuF32fo
GBJfbDSMwX159PhyuasZKXXJZN0XKoaS81UR8xgdjqwtIIvympByprjzX/zC
0Ihosc2iGR0qVfp7VCQOkYb5JCrsezCUpbz5DRn36LOsLGqjEalj1U96XzeG
0nkbVHpxx1gNfHcDjUgM1cH4zV0Ymo/OJ1Xi7jQbV636w5C0+Yh4Wkc7hvSH
dLUicf8gfPnn9sSDpH1+XS5GrRh6vZQTIIc7Zx0H4uPcTwrc/q5SvR5DxI+R
MzdN6XBA8U6FiosOqcnq/rBAEYbiZo4s++Ou8Kkn+u67PSSB2h0tbQUYas7i
NPPE3V/W1Ml9fjfpWuD+lkf5GNrng0rO4a714qFHob82Sd6NuFY+F0OCHR3J
CPe29jcsrZCdpAPmX1313mDo6Na35Tq4K0u6icdXa5I+BT9b5MrCkEPMtORO
3GN5zV9cXN1BcjWpSfz6CkNc3IO5SribnMl5cSdIg+Sd4orZZGColkdq7Trc
+93t74tNqJDYw8tsn1QMTc09PCqE+yElR94rtsqkrNzjGrrPMXTabE0XH+7z
7Pbims4tpP80Rv04UzDk83l3JduEDtejNU79V6NA4vfeYRD/BEOGG6o2LeP+
lLHsoaUlT1IS2dVgk4whscKgDwzca7PLfmu8liNdC55wkEnC0MXHyoNU3Evb
dfUa1kuRvox+7899iKEDjbTTf3DfO+20Q40mTuLIsi2/moih9xW2snO43+JX
e2DbJkayOCz6bt8DDG3xjY+axj13fP0pkQiMdNs7vqc1HkOTupJbf+E+1C7F
kCsRILmKJBMex2Eocyl0/RTuYc6WSem2PKRsXf2z5+9hKOmp75FJ3DNSFiQ1
uZerhRora7bEYkioa/wrGXeHvGpjhYi5at29mN6fu3j/21s+/OebDqZOvaz+
VN21fKm1LBqvU/15zj8XoG6z3F86vo+XQggIvYN7Qj/x3/s7LDN8LfbQ95Es
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
0HUM/gdyh4wG
        "]]},
      Annotation[#, "Charting`Private`Tag$11009#1"]& ]}, {}}, {{{}, {}, 
     TagBox[
      {GrayLevel[0], AbsoluteThickness[2], Line3DBox[CompressedData["
1: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
        "]]},
      Annotation[#, "Charting`Private`Tag$11037#1"]& ]}, {}}, 
   {PointSize[0.02], 
    Point3DBox[{1.4562745830184693`, 4.764560328305439*^-22, 
     4.135241772055607}]}, 
   {PointSize[0.02], 
    Point3DBox[{1.9138867719685657`, 0.4999999999999999, 
     1.5027992992887862`}]}, 
   {PointSize[0.02], 
    Point3DBox[{1.7176594650785015`, 0.9999999992845877, 
     0.6079662071915355}]}},
  Frame -> True,
  RotateLabel -> False,
  Axes->True,
  AxesLabel->{
    FormBox["\"\\!\\(\\*RowBox[{\\\"b\\\"}]\\)\"", TraditionalForm], 
    FormBox[
    "\"\\!\\(\\*SubscriptBox[\\\"\[Lambda]\\\", \\\"0\\\"]\\)\"", 
     TraditionalForm], 
    FormBox["\"\\!\\(\\*RowBox[{\\\"a\\\"}]\\)\"", TraditionalForm]},
  AxesStyle->Directive[FontSize -> 15],
  BoxRatios->{1, 1, 1},
  DisplayFunction->Identity,
  FaceGridsStyle->Automatic,
  ImagePadding->Automatic,
  Method->{
   "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}},
  PlotRange->{{0, 2}, {0, 1}, {0, 8}},
  PlotRangePadding->{{0, 0}, {0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.8969094818626385`*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"bcf36d79-5027-435c-98c6-09ab126c2b8f"]
}, Open  ]]
}, Closed]]
},
WindowSize->{1428., 735.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.3 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"533841ac-82d1-44a9-bf7e-86a6e75e106d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 165, 3, 126, "Title",ExpressionUUID->"ea61d8e4-711d-4d74-b25b-761ac764db40"],
Cell[748, 27, 240, 6, 45, "Text",ExpressionUUID->"fb852f10-685d-44ae-b15a-4cf30567a1b9"],
Cell[991, 35, 179, 3, 36, "Input",ExpressionUUID->"4dd8c56a-24c9-40ec-9db2-0034b1e9c701"]
}, Closed]],
Cell[CellGroupData[{
Cell[1207, 43, 254, 4, 91, "Title",ExpressionUUID->"64324ed7-52be-4b1e-98cb-d02a137df024"],
Cell[1464, 49, 309, 6, 45, "Text",ExpressionUUID->"edf22f9a-7a61-4ca6-96ad-ede52a777aa8"],
Cell[1776, 57, 6414, 150, 705, "Input",ExpressionUUID->"cc69dd3d-cbfb-4595-8acd-5d98b925aded"]
}, Closed]],
Cell[CellGroupData[{
Cell[8227, 212, 153, 3, 91, "Title",ExpressionUUID->"4ef2af19-48fd-4c88-b205-32b86bb1aa82"],
Cell[8383, 217, 458, 9, 75, "Text",ExpressionUUID->"5554f862-fa6d-4737-b089-27d14a42d11b"],
Cell[8844, 228, 12726, 320, 920, "Input",ExpressionUUID->"5cbca695-ca74-488b-a139-a446b3ff92a4"]
}, Closed]],
Cell[CellGroupData[{
Cell[21607, 553, 227, 4, 91, "Title",ExpressionUUID->"b4b8a194-920c-498a-838c-7ef029e5294d"],
Cell[21837, 559, 322, 7, 45, "Text",ExpressionUUID->"b4d74d42-b282-4d76-a057-3e600b12bab6"],
Cell[22162, 568, 14767, 354, 1451, "Input",ExpressionUUID->"ba1473d1-5aed-4060-aac2-2c3cb7a6c1f1"]
}, Closed]],
Cell[CellGroupData[{
Cell[36966, 927, 213, 4, 91, "Title",ExpressionUUID->"5cafe80f-fe2b-43f2-bc97-220a654ba175"],
Cell[37182, 933, 258, 6, 45, "Text",ExpressionUUID->"ae428f0a-a208-480c-87b1-50551fc4c33b"],
Cell[37443, 941, 1872, 48, 161, "Input",ExpressionUUID->"a3894b42-9b16-446b-99f4-b500710381cf"]
}, Closed]],
Cell[CellGroupData[{
Cell[39352, 994, 213, 4, 91, "Title",ExpressionUUID->"4488db71-1104-4303-b187-bae35678313d"],
Cell[39568, 1000, 406, 8, 75, "Text",ExpressionUUID->"87af798e-5705-4784-8e1b-1bc1ecdc431f"],
Cell[39977, 1010, 47377, 1113, 3175, "Input",ExpressionUUID->"fdb328a8-4025-4938-acf3-217bd8eb2181"]
}, Closed]],
Cell[CellGroupData[{
Cell[87391, 2128, 164, 3, 91, "Title",ExpressionUUID->"59e5598c-b1a4-495f-b255-391127440ca6"],
Cell[87558, 2133, 365, 7, 75, "Text",ExpressionUUID->"14a70aa0-2798-4b9a-8ecd-60aaee713a2f"],
Cell[87926, 2142, 21999, 538, 1599, "Input",ExpressionUUID->"badd11d8-df7e-46a4-8c64-95e5572ef76a"]
}, Closed]],
Cell[CellGroupData[{
Cell[109962, 2685, 606, 9, 91, "Title",ExpressionUUID->"975f7379-5e89-4c9d-9c35-2517707099ec"],
Cell[110571, 2696, 218, 4, 45, "Text",ExpressionUUID->"a0fefe8f-2f26-4637-bafc-edd7bea0a157"],
Cell[110792, 2702, 2159, 52, 292, "Input",ExpressionUUID->"2e32b0e0-a41c-4002-a99b-e9daae978379"]
}, Closed]],
Cell[CellGroupData[{
Cell[112988, 2759, 161, 3, 91, "Title",ExpressionUUID->"31009231-e5e1-4bd5-b49d-53ebf474df13"],
Cell[113152, 2764, 213, 5, 45, "Text",ExpressionUUID->"9ef0a0d4-5957-4304-b51d-4fa62a57d438"],
Cell[113368, 2771, 6204, 138, 462, "Input",ExpressionUUID->"751cb34e-5132-4079-9042-ce30049ea319"]
}, Closed]],
Cell[CellGroupData[{
Cell[119609, 2914, 178, 3, 91, "Title",ExpressionUUID->"5a3a3e1d-f27d-43c0-b2b2-1e5928aa479d"],
Cell[119790, 2919, 284, 7, 45, "Text",ExpressionUUID->"1415cb93-4b04-4cb2-959b-6a17fceb7fdb"],
Cell[120077, 2928, 17548, 348, 1328, "Input",ExpressionUUID->"5a683087-6769-48aa-a98b-e2a85730a676"]
}, Closed]],
Cell[CellGroupData[{
Cell[137662, 3281, 214, 4, 91, "Title",ExpressionUUID->"b720bbc5-22a5-423a-bc30-2c9c18f99b35"],
Cell[137879, 3287, 641, 13, 75, "Text",ExpressionUUID->"246e49dc-2627-4f96-b123-14166c8ea7ee"],
Cell[138523, 3302, 8648, 197, 727, "Input",ExpressionUUID->"92b76d96-921d-4849-a40c-d06b5af83e61"]
}, Closed]],
Cell[CellGroupData[{
Cell[147208, 3504, 170, 3, 91, "Title",ExpressionUUID->"22ed8e9a-ac08-49b1-a105-ccaa93207ba4"],
Cell[147381, 3509, 203, 3, 45, "Text",ExpressionUUID->"33f00c93-f20f-42d8-bde1-743c401a23cc"],
Cell[147587, 3514, 1404, 36, 211, "Input",ExpressionUUID->"c55ec3d7-8d3f-4fab-8804-a4ea848a2cb1"]
}, Closed]],
Cell[CellGroupData[{
Cell[149028, 3555, 218, 4, 91, "Title",ExpressionUUID->"8258dbe0-d1fc-429e-b0fe-ea1230796fe6"],
Cell[149249, 3561, 203, 3, 45, "Text",ExpressionUUID->"be60d8d7-f0cb-4095-b82c-19e8939f49b4"],
Cell[149455, 3566, 26435, 595, 2164, "Input",ExpressionUUID->"1563a7cb-eece-4d24-ae39-9fc8fff20e3b"]
}, Closed]],
Cell[CellGroupData[{
Cell[175927, 4166, 173, 3, 91, "Title",ExpressionUUID->"d50f385e-4539-490d-b5a5-aafb6b65b078"],
Cell[176103, 4171, 449, 11, 45, "Text",ExpressionUUID->"bd19fffe-c90d-4430-8d32-8e9cca6e1e30"],
Cell[CellGroupData[{
Cell[176577, 4186, 22902, 527, 1545, "Input",ExpressionUUID->"9b433723-f3b4-4c41-a9c6-27561d0be08d"],
Cell[199482, 4715, 17527, 307, 70, "Output",ExpressionUUID->"519fa367-3713-44ac-b7eb-571955b5a052"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[217058, 5028, 215, 4, 91, "Title",ExpressionUUID->"1b7279de-0e9a-4073-b020-f91d9b567541"],
Cell[217276, 5034, 201, 3, 45, "Text",ExpressionUUID->"6e5294df-fd8c-47fb-85ca-cd85145d1851"],
Cell[217480, 5039, 29556, 721, 2658, "Input",ExpressionUUID->"482e93db-e6df-423f-ba70-4d0a435202b3"]
}, Closed]],
Cell[CellGroupData[{
Cell[247073, 5765, 173, 3, 91, "Title",ExpressionUUID->"8aeea5b5-47a5-4bfc-91b2-e38b668c0d13"],
Cell[247249, 5770, 583, 10, 105, "Text",ExpressionUUID->"54680546-436d-411a-b1b4-4c7c938a4711"],
Cell[247835, 5782, 23432, 556, 1654, "Input",ExpressionUUID->"d1a38189-a75f-495a-8e90-0c9d80700ad3"]
}, Closed]],
Cell[CellGroupData[{
Cell[271304, 6343, 165, 3, 91, "Title",ExpressionUUID->"d8e321cb-8dd8-47b4-8dd2-a1cdcb039ab4"],
Cell[271472, 6348, 369, 7, 75, "Text",ExpressionUUID->"abc3d507-0518-4b9a-a98d-7d6f72638fbd"],
Cell[CellGroupData[{
Cell[271866, 6359, 33751, 784, 2227, "Input",ExpressionUUID->"7d6aac12-cf9b-4179-a52e-ac2b6dc47746"],
Cell[305620, 7145, 33101, 581, 70, "Output",ExpressionUUID->"bcf36d79-5027-435c-98c6-09ab126c2b8f"]
}, Open  ]]
}, Closed]]
}
]
*)

