(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    294898,       6910]
NotebookOptionsPosition[    288511,       6799]
NotebookOutlinePosition[    288985,       6817]
CellTagsIndexPosition[    288942,       6814]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Clearing Variables", "Title",
 CellChangeTimes->{{3.8954751959788213`*^9, 
  3.8954752006811113`*^9}},ExpressionUUID->"ea61d8e4-711d-4d74-b25b-\
761ac764db40"],

Cell["\<\
This section just clears all the variables that have been already defined in \
Mathematica\
\>", "Text",
 CellChangeTimes->{{3.896873793156684*^9, 
  3.896873815190978*^9}},ExpressionUUID->"fb852f10-685d-44ae-b15a-\
4cf30567a1b9"],

Cell[BoxData[
 RowBox[{"Quiet", "@", 
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"4dd8c56a-24c9-40ec-9db2-0034b1e9c701"]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameters", "Title",
 CellChangeTimes->{{3.895427920732616*^9, 3.8954279223516064`*^9}, {
  3.8969641209462895`*^9, 3.8969641211576247`*^9}, {3.896964692999531*^9, 
  3.8969646932068233`*^9}, {3.896965314265585*^9, 
  3.8969653144867287`*^9}},ExpressionUUID->"64324ed7-52be-4b1e-98cb-\
d02a137df024"],

Cell["\<\
This section is to set all the parameters of the system, including tolerances \
and parameters that are set to indicate Mathematica what wants to be computed\
\>", "Text",
 CellChangeTimes->{{3.896873825260089*^9, 
  3.8968738898988423`*^9}},ExpressionUUID->"edf22f9a-7a61-4ca6-96ad-\
ede52a777aa8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "9"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Choptol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "9"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"disttol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "6"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmax", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialt", "=", 
   RowBox[{"-", "1000"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalt", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"smalldifferential", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curvespeed", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberofzerotemporalderivatives", "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqbool", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simpleeq", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"criticalitychanges", "=", "\"\<y\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timedifference", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cod2", "=", "\"\<n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"crosscoef", "=", "\"\<n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alphaval", "=", "\"\<n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"{", 
    RowBox[{"u", ",", "v"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"par", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parnames", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"crosspar", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parval", "=", 
   RowBox[{"{", 
    RowBox[{"r", "->", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fixedpar", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialvalueTuring", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intervalx", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intervaly", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"par3", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"par3name", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extrainterval", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"otherTuring", "=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8954279584311247`*^9, 3.8954279793477287`*^9}, {
   3.895428046269772*^9, 3.8954280474457483`*^9}, {3.8954281115780554`*^9, 
   3.895428112169461*^9}, {3.8954282439796886`*^9, 3.8954282449905586`*^9}, {
   3.8954287450542436`*^9, 3.8954287614847617`*^9}, {3.895428932817608*^9, 
   3.895428933547702*^9}, {3.8954289690397873`*^9, 3.8954289701566887`*^9}, {
   3.8954324512423363`*^9, 3.89543248765158*^9}, {3.8954326858485527`*^9, 
   3.895432686580777*^9}, {3.8954343381346316`*^9, 3.895434352378853*^9}, {
   3.895435386093203*^9, 3.895435392422604*^9}, {3.8954749139291105`*^9, 
   3.8954749142690797`*^9}, {3.8954751909245663`*^9, 3.895475209553584*^9}, {
   3.895475530346212*^9, 3.895475567367071*^9}, {3.895475704879484*^9, 
   3.8954757403294373`*^9}, {3.895480919360569*^9, 3.8954809230323524`*^9}, {
   3.8956478730793495`*^9, 3.895647918541531*^9}, {3.895650043475133*^9, 
   3.8956500438174953`*^9}, {3.8956500811581297`*^9, 
   3.8956500813877087`*^9}, {3.8956501284524*^9, 3.8956501382474136`*^9}, {
   3.8956502465399227`*^9, 3.8956502557286887`*^9}, 3.895650725558692*^9, {
   3.895659094534528*^9, 3.89565909479698*^9}, 3.895659992655587*^9, {
   3.895669338846998*^9, 3.895669339263445*^9}, {3.8956694499036856`*^9, 
   3.895669451357782*^9}, {3.895675717487457*^9, 3.8956757179262857`*^9}, {
   3.8956894970613256`*^9, 3.8956895121797733`*^9}, {3.895692010905773*^9, 
   3.895692016169233*^9}, {3.895756291749323*^9, 3.895756366446519*^9}, {
   3.8957578974904623`*^9, 3.8957579061444445`*^9}, {3.8957581264546776`*^9, 
   3.8957581988342476`*^9}, {3.895758586247681*^9, 3.895758605771484*^9}, {
   3.8957587090164824`*^9, 3.8957587187348733`*^9}, {3.895758843238387*^9, 
   3.8957588582449007`*^9}, {3.895760448019987*^9, 3.895760450946477*^9}, {
   3.8958187869103174`*^9, 3.8958187873142247`*^9}, 3.8958188418199415`*^9, {
   3.8958191955359535`*^9, 3.895819225325616*^9}, {3.8958194132473173`*^9, 
   3.8958194135932255`*^9}, {3.895819517585163*^9, 3.895819581115199*^9}, {
   3.8958196187141714`*^9, 3.8958196650049896`*^9}, {3.895843687512045*^9, 
   3.895843704124234*^9}, {3.8958438872868023`*^9, 3.895843902486864*^9}, {
   3.896345831332492*^9, 3.896345834204544*^9}, {3.8963511793541937`*^9, 
   3.8963511799442263`*^9}, {3.8968738951216125`*^9, 
   3.8968743387422266`*^9}, {3.8968744470693717`*^9, 3.896874540147649*^9}, {
   3.8968745760210156`*^9, 3.8968747191830764`*^9}, {3.896874809509102*^9, 
   3.8968749006747904`*^9}, {3.8968750137950115`*^9, 
   3.8968752088380175`*^9}, {3.8968753932128143`*^9, 
   3.8968753994867764`*^9}, {3.896876608287466*^9, 3.8968766443380823`*^9}, {
   3.8969040989155025`*^9, 3.8969042353854446`*^9}, {3.896964113541272*^9, 
   3.896964115939376*^9}, {3.8969653112185035`*^9, 3.896965311514104*^9}, {
   3.8969678351250343`*^9, 3.8969678368211308`*^9}, {3.897057369842863*^9, 
   3.8970573777708387`*^9}, {3.8970650413840313`*^9, 3.897065048357836*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"cc69dd3d-cbfb-4595-8acd-5d98b925aded"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kinetics", "Title",
 CellChangeTimes->{{3.895235772884898*^9, 
  3.8952357743031654`*^9}},ExpressionUUID->"4ef2af19-48fd-4c88-b205-\
32b86bb1aa82"],

Cell["\<\
Provide the kinetics and the diffusion matrix in this section on the \
variables \[OpenCurlyDoubleQuote]kinetics\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]diffmatrix\[CloseCurlyDoubleQuote], respectively. In \
this section, Mathematica will also find the homogeneous steady states if \
requested\
\>", "Text",
 CellChangeTimes->{{3.896875223393263*^9, 
  3.8968752947811546`*^9}},ExpressionUUID->"5554f862-fa6d-4737-b089-\
27d14a42d11b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nvar", "=", 
   RowBox[{"Length", "[", "var", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kinetics", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "*", "u"}], "-", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "c"], "4"], "*", "u"}], "-", 
      RowBox[{"2", "*", 
       SuperscriptBox[
        SubscriptBox["q", "c"], "2"], "*", "v"}], "+", 
      RowBox[{
       SubscriptBox["b", "3"], "*", 
       SuperscriptBox["u", "3"]}], "-", 
      RowBox[{
       SubscriptBox["b", "5"], "*", 
       SuperscriptBox["u", "5"]}]}], ",", "v"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diffmatrix", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", 
       RowBox[{"-", "1"}]},
      {
       RowBox[{"-", "1"}], "0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"eqbool", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqs", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"kinetics", "==", "0"}], ",", "var"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "eqs", "]"}], ">", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Your system has \>\"", " ", "<>", " ", 
              RowBox[{"ToString", "[", 
               RowBox[{"Length", "[", "eqs", "]"}], "]"}], " ", "<>", " ", 
              "\"\< equilibria\>\""}], "}"}], "]"}], ",", "\"\<Output\>\""}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"eqnum", "=", "1"}], ",", 
         RowBox[{"eqnum", "<=", 
          RowBox[{"Length", "[", "eqs", "]"}]}], ",", 
         RowBox[{"eqnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SelectionMove", "[", 
           RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"NotebookWrite", "[", 
           RowBox[{"aux", ",", 
            RowBox[{"Cell", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<Equilibrium number \>\"", " ", "<>", " ", 
                  RowBox[{"ToString", "[", "eqnum", "]"}], " ", "<>", " ", 
                  "\"\< is equal to \>\""}], ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"eqs", "[", 
                    RowBox[{"[", "eqnum", "]"}], "]"}], ",", 
                   RowBox[{"FormatType", "->", "StandardForm"}]}], "]"}]}], 
                "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnumber", "=", 
        RowBox[{
        "Input", "[", 
         "\"\<Enter the number of the equilibrium point you would like to \
consider. Enter 0 if the software did not find your desired homogeneous \
steady-state or you want to consider them all\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookClose", "[", "aux", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"eqnumber", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eq", "=", 
           RowBox[{"{", "0", "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eq", "=", 
           RowBox[{
            RowBox[{"eqs", "[", 
             RowBox[{"[", "eqnumber", "]"}], "]"}], "//", "Simplify"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]",
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Mathematica found only one homogeneous steady-state in your \
system. It will proceed with that one.\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eq", "=", 
        RowBox[{
         RowBox[{"eqs", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq", "=", 
     RowBox[{"{", "0", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jacmat", "=", 
   RowBox[{"D", "[", 
    RowBox[{"kinetics", ",", 
     RowBox[{"{", "var", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8906780445102253`*^9, 3.890678111040274*^9}, {
   3.8906781795127645`*^9, 3.8906784723669205`*^9}, {3.8906785744092817`*^9, 
   3.8906785839304657`*^9}, {3.8906787332421875`*^9, 
   3.8906787671951303`*^9}, {3.8906789819966283`*^9, 
   3.8906789824024916`*^9}, {3.8906790253463373`*^9, 3.890679035958171*^9}, {
   3.890820891985819*^9, 3.8908209526656675`*^9}, {3.8908212019136896`*^9, 
   3.890821214519494*^9}, {3.890837938573892*^9, 3.8908379389418235`*^9}, {
   3.8908382727067757`*^9, 3.8908382957217493`*^9}, {3.8908387008302355`*^9, 
   3.8908387038880215`*^9}, {3.8910083771331935`*^9, 
   3.8910083788524365`*^9}, {3.8910117811657915`*^9, 
   3.8910118162434745`*^9}, {3.891278238460943*^9, 3.891278263877515*^9}, {
   3.8912786161584015`*^9, 3.8912786250376377`*^9}, {3.89127870864843*^9, 
   3.8912787270360756`*^9}, {3.891359625495322*^9, 3.8913596282053213`*^9}, {
   3.8913671468534007`*^9, 3.8913671591708355`*^9}, {3.891411787963504*^9, 
   3.891411790255947*^9}, {3.8915052309278564`*^9, 3.8915052315753045`*^9}, {
   3.895235012316103*^9, 3.895235012854446*^9}, {3.8952350873704386`*^9, 
   3.895235125268959*^9}, {3.895235765202467*^9, 3.8952358013314924`*^9}, {
   3.895236341392643*^9, 3.895236357512231*^9}, {3.895236445138153*^9, 
   3.8952364766744957`*^9}, {3.895237058595951*^9, 3.8952370951082315`*^9}, {
   3.895388155978882*^9, 3.8953881641251416`*^9}, {3.8953936835232267`*^9, 
   3.895393697173332*^9}, {3.895397325992364*^9, 3.8953973492203894`*^9}, {
   3.895399144623319*^9, 3.8953991451181927`*^9}, {3.8953992207896357`*^9, 
   3.895399227346514*^9}, 3.895425360033792*^9, {3.8954255588244505`*^9, 
   3.895425559316889*^9}, {3.8954256889194355`*^9, 3.895425689181632*^9}, {
   3.8954258540533*^9, 3.8954258542957*^9}, {3.8954261202773647`*^9, 
   3.8954261451925635`*^9}, {3.8954263798239727`*^9, 3.895426380093327*^9}, {
   3.8954264195342565`*^9, 3.8954264198323936`*^9}, {3.8954269344055133`*^9, 
   3.895426934681567*^9}, {3.895427185972866*^9, 3.8954272404195886`*^9}, {
   3.895427467813653*^9, 3.8954274679638987`*^9}, {3.8954275154645133`*^9, 
   3.8954275271506853`*^9}, {3.895427605450692*^9, 3.8954276412437615`*^9}, {
   3.8954279351491203`*^9, 3.8954279435683675`*^9}, {3.8954281159799*^9, 
   3.8954281166961107`*^9}, 3.8954281579797754`*^9, {3.895428238357767*^9, 
   3.8954282402653947`*^9}, {3.895658672283351*^9, 3.8956586758470488`*^9}, {
   3.8956587442102966`*^9, 3.895658775516533*^9}, 3.8956588845424643`*^9, 
   3.895660012819561*^9, {3.895669176646825*^9, 3.8956691804870205`*^9}, {
   3.895669282131542*^9, 3.8956692951223326`*^9}, {3.895756390242838*^9, 
   3.895756402623145*^9}, {3.8957582128860664`*^9, 3.895758258119711*^9}, {
   3.895758570600191*^9, 3.895758574517352*^9}, 3.895819240073947*^9, {
   3.8958363884659786`*^9, 3.8958364148518105`*^9}, 3.8970650611252403`*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"5cbca695-ca74-488b-a139-a446b3ff92a4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kernel of the Jacobian matrix", "Title",
 CellChangeTimes->{{3.8952358174342804`*^9, 3.895235823044009*^9}, {
  3.8954272089623084`*^9, 
  3.8954272093927565`*^9}},ExpressionUUID->"b4b8a194-920c-498a-838c-\
7ef029e5294d"],

Cell["\<\
Mathematica finds the kernel of the Jacobian matrix, after finding an \
invertible (n - 1)x(n - 1) submatrix on it, if the parameters for a \
bifurcation were provided.\
\>", "Text",
 CellChangeTimes->{{3.8968753077334957`*^9, 
  3.8968753761997833`*^9}},ExpressionUUID->"b4d74d42-b282-4d76-a057-\
3e600b12bab6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dummymat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dmat", 
      RowBox[{"row", ",", "col"}]], ",", 
     RowBox[{"{", 
      RowBox[{"row", ",", "nvar"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dummyvec", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["dvec", "varnum"], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jacobianmat", "=", 
   RowBox[{"jacmat", "-", 
    RowBox[{"\[Mu]NF", "*", "diffmatrix"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerodet", "=", 
   RowBox[{"Det", "[", "dummymat", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerodet", "=", 
   RowBox[{"zerodet", "/.", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dummymat", "[", 
         RowBox[{"[", 
          RowBox[{"row", ",", "col"}], "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"jacobianmat", "[", 
          RowBox[{"[", 
           RowBox[{"row", ",", "col"}], "]"}], "]"}], "-", 
         RowBox[{"\[Lambda]NF", "*", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "nvar", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"row", ",", "col"}], "]"}], "]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"row", ",", "nvar"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonzero", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"zerodet", ",", "\[Lambda]NF"}], "]"}], "/.", 
    RowBox[{"\[Lambda]NF", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zerodet", "=", 
   RowBox[{"zerodet", "/.", 
    RowBox[{"\[Lambda]NF", "->", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeroder", "=", 
   RowBox[{"D", "[", 
    RowBox[{"zerodet", ",", "\[Mu]NF"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "eq", "]"}], ">", "1"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Mu]val", "=", 
      RowBox[{"Quiet", "@", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"zeroder", "==", "0"}], "/.", "eq"}], "/.", "fixedpar"}], 
          "/.", "parval"}], ",", "\[Mu]NF"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"solnum", "=", "1"}], ",", 
       RowBox[{"solnum", "<=", 
        RowBox[{"Length", "[", "\[Mu]val", "]"}]}], ",", 
       RowBox[{"solnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", 
                 RowBox[{
                  RowBox[{"\[Mu]NF", "/.", 
                   RowBox[{"\[Mu]val", "[", 
                    RowBox[{"[", "solnum", "]"}], "]"}]}], ",", "Choptol"}], 
                 "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Abs", "[", "zerodet", "]"}], "<", "tol"}]}], "/.", 
              RowBox[{"\[Mu]val", "[", 
               RowBox[{"[", "solnum", "]"}], "]"}]}], "/.", "eq"}], "/.", 
            "fixedpar"}], "/.", "parval"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Mu]val", "=", 
            RowBox[{"\[Mu]val", "[", 
             RowBox[{"[", "solnum", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "==", 
           RowBox[{"Length", "[", "\[Mu]val", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", 
           "\"\<You are not actually at a Turing bifurcation\>\"", "]"}]}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["v", "varnum"], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ValueQ", "[", "\[Mu]val", "]"}], " ", "&&", " ", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"\[Mu]val", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "0"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getout", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"row", "=", "1"}], ",", 
       RowBox[{"row", "<=", "nvar"}], ",", 
       RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"getout", "==", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Break", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"col", "=", "1"}], ",", 
          RowBox[{"col", "<=", "nvar"}], ",", 
          RowBox[{"col", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"submatrixrows", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Range", "[", "nvar", "]"}], ",", 
              RowBox[{"{", "row", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"submatrixcols", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Range", "[", "nvar", "]"}], ",", 
              RowBox[{"{", "col", "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"jacobianmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], 
                    "]"}], "/.", "\[Mu]val"}], "/.", "eq"}], "/.", 
                 "fixedpar"}], "/.", "parval"}], "]"}], "!=", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"criticalrow", "=", "row"}], ";", "\[IndentingNewLine]", 
              RowBox[{"criticalcol", "=", "col"}], ";", "\[IndentingNewLine]", 
              RowBox[{"getout", "=", "1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"criticalrow", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"criticalcol", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"submatrixrows", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "nvar", "]"}], ",", 
        RowBox[{"{", "criticalrow", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submatrixcols", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "nvar", "]"}], ",", 
        RowBox[{"{", "criticalcol", "}"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{"[", "criticalcol", "]"}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]sol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"jacobianmat", "[", 
          RowBox[{"[", 
           RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], "]"}], ",", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"[", "submatrixcols", "]"}], "]"}]}], "]"}], "==", 
       RowBox[{"-", 
        RowBox[{"jacobianmat", "[", 
         RowBox[{"[", 
          RowBox[{"submatrixrows", ",", 
           RowBox[{"{", "criticalcol", "}"}]}], "]"}], "]"}]}]}], ",", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"[", "submatrixcols", "]"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"\[Phi]", "/.", "\[Phi]sol"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"varnum", "=", "1"}], ",", 
   RowBox[{"varnum", "<=", "nvar"}], ",", 
   RowBox[{"varnum", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"varnum", "<=", 
      RowBox[{"nvar", "-", "numberofzerotemporalderivatives"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], "=", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], "=", "0"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["sol", 
    RowBox[{"1", ",", "1"}]], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["W", 
        RowBox[{"1", ",", "1", ",", "varnum"}]], "[", "X", "]"}], "->", 
      RowBox[{
       RowBox[{
        SubscriptBox["A", "1"], "[", "X", "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["dersol", 
    RowBox[{"1", ",", "1"}]], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["sol", 
      RowBox[{"1", ",", "1"}]], ",", "X"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["der2sol", 
    RowBox[{"1", ",", "1"}]], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     SubscriptBox["dersol", 
      RowBox[{"1", ",", "1"}]], ",", "X"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8908379421660953`*^9, 3.890837946760846*^9}, {
   3.8908380222019863`*^9, 3.8908382649902353`*^9}, {3.890838365633258*^9, 
   3.890838426499406*^9}, {3.890838479992857*^9, 3.890838482586275*^9}, {
   3.890838607433332*^9, 3.8908386239350843`*^9}, {3.890838673494182*^9, 
   3.8908386737417946`*^9}, {3.891008642610325*^9, 3.891008644034711*^9}, {
   3.8910087260908203`*^9, 3.8910087975807967`*^9}, {3.8910118244593515`*^9, 
   3.8910118523420944`*^9}, {3.8910119824088306`*^9, 
   3.8910119826545744`*^9}, {3.891278350096554*^9, 3.8912783923494434`*^9}, {
   3.891278458954806*^9, 3.8912784660273476`*^9}, {3.891278501955251*^9, 
   3.89127850611102*^9}, 3.8912786009765697`*^9, {3.8912786331950736`*^9, 
   3.8912786879474154`*^9}, 3.8912804114370003`*^9, {3.8913612177548866`*^9, 
   3.891361227008133*^9}, {3.891364034104721*^9, 3.8913640610554056`*^9}, {
   3.891364107204362*^9, 3.8913641086450863`*^9}, {3.8913641469071274`*^9, 
   3.891364174366186*^9}, {3.891364208732103*^9, 3.891364220034178*^9}, {
   3.8913642564583707`*^9, 3.8913642807167935`*^9}, {3.8913643270564504`*^9, 
   3.8913643358626833`*^9}, {3.89136439009624*^9, 3.891364491301955*^9}, {
   3.8913663064801884`*^9, 3.8913663662993965`*^9}, {3.891366522555418*^9, 
   3.891366609210707*^9}, {3.891367171183612*^9, 3.8913671822246265`*^9}, {
   3.8913675577347636`*^9, 3.891367558153657*^9}, {3.8914134941734686`*^9, 
   3.8914135077422967`*^9}, {3.891413715633811*^9, 3.8914137160588055`*^9}, {
   3.8914138770782223`*^9, 3.891413895491497*^9}, {3.8914139449896317`*^9, 
   3.891413971203255*^9}, {3.891414030453076*^9, 3.89141405585074*^9}, {
   3.8914337082728815`*^9, 3.8914337114239798`*^9}, {3.891436168612285*^9, 
   3.8914361888684034`*^9}, {3.89143870885564*^9, 3.891438715505005*^9}, {
   3.891439447339345*^9, 3.891439463429737*^9}, {3.8952351757753725`*^9, 
   3.895235487469984*^9}, {3.8952355477364445`*^9, 3.8952355595561967`*^9}, {
   3.895235855996832*^9, 3.895235914451939*^9}, {3.895236246289893*^9, 
   3.895236251791911*^9}, 3.895236520005498*^9, {3.8952366208132496`*^9, 
   3.8952366599519987`*^9}, {3.8952367421895084`*^9, 
   3.8952367462766495`*^9}, {3.8952368169516697`*^9, 3.895236845765771*^9}, {
   3.8952368778025265`*^9, 3.895236915236767*^9}, {3.8952371216206827`*^9, 
   3.8952371260016947`*^9}, {3.895237192767122*^9, 3.895237199850296*^9}, {
   3.895237408805979*^9, 3.8952374112973557`*^9}, {3.8952375588551593`*^9, 
   3.8952375590845704`*^9}, {3.8952411886409626`*^9, 3.895241220504713*^9}, {
   3.8952417060403585`*^9, 3.8952417293689284`*^9}, {3.8952417597882147`*^9, 
   3.8952417783894787`*^9}, {3.895393730860072*^9, 3.8953937791531734`*^9}, {
   3.8953938101744404`*^9, 3.8953938138031025`*^9}, {3.8953938576330137`*^9, 
   3.895393910978653*^9}, {3.8953940010407352`*^9, 3.8953940081864667`*^9}, {
   3.8953940410956645`*^9, 3.8953940428038034`*^9}, 3.8953955571175847`*^9, {
   3.895399236559389*^9, 3.895399246451634*^9}, {3.8954261788249826`*^9, 
   3.8954261798863125`*^9}, {3.895426216467985*^9, 3.895426263961667*^9}, {
   3.8954269583481116`*^9, 3.895426974379551*^9}, {3.895427020312051*^9, 
   3.8954270742402925`*^9}, {3.895428175911461*^9, 3.895428184280898*^9}, 
   3.895428223199233*^9, {3.8954318954029365`*^9, 3.8954319810627813`*^9}, 
   3.895432148649288*^9, {3.8954322564973297`*^9, 3.895432284718607*^9}, {
   3.8956432237181787`*^9, 3.89564325345604*^9}, {3.8956442858563457`*^9, 
   3.895644304309688*^9}, {3.8956664101122203`*^9, 3.8956664115739717`*^9}, {
   3.8957579460792184`*^9, 3.8957580462823725`*^9}, {3.8957595945827866`*^9, 
   3.8957596121874332`*^9}, {3.8957597573003397`*^9, 
   3.8957597779536095`*^9}, {3.8957599582635236`*^9, 3.895759987428463*^9}, {
   3.8957609203735356`*^9, 3.895760923095827*^9}, {3.8957610656304965`*^9, 
   3.895761068347578*^9}, {3.8958364676425543`*^9, 3.8958364683926353`*^9}, {
   3.8958428950809965`*^9, 3.895842954520792*^9}, {3.8958429870253105`*^9, 
   3.8958430538461485`*^9}, 3.8958434352304773`*^9, {3.8958435394691396`*^9, 
   3.8958435434784813`*^9}, {3.896344725950115*^9, 3.896344734872848*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"ba1473d1-5aed-4060-aac2-2c3cb7a6c1f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Kernel of the adjoint", "Title",
 CellChangeTimes->{{3.895235922290038*^9, 3.895235925682999*^9}, {
  3.896367021269752*^9, 
  3.896367021574452*^9}},ExpressionUUID->"5cafe80f-fe2b-43f2-bc97-\
220a654ba175"],

Cell["\<\
Mathematica finds the kernel of the transpose of the Jacobian matrix, using \
the same submatrix used before.\
\>", "Text",
 CellChangeTimes->{{3.89687543375546*^9, 
  3.896875474093751*^9}},ExpressionUUID->"ae428f0a-a208-480c-87b1-\
50551fc4c33b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox["v", "varnum"], ",", 
     RowBox[{"{", 
      RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "[", 
    RowBox[{"[", "criticalrow", "]"}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]sol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"jacobianmat", "[", 
           RowBox[{"[", 
            RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], "]"}], 
          "]"}], ",", 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"[", "submatrixrows", "]"}], "]"}]}], "]"}], "==", 
       RowBox[{"-", 
        RowBox[{"Transpose", "[", 
         RowBox[{"jacobianmat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"{", "criticalrow", "}"}], ",", "submatrixcols"}], "]"}], 
          "]"}], "]"}]}]}], ",", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"[", "submatrixrows", "]"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"\[Psi]", "/.", "\[Psi]sol"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8910064420472236`*^9, 3.891006549455819*^9}, {
   3.891006637611881*^9, 3.8910066458966446`*^9}, {3.891278394256345*^9, 
   3.8912784204155545`*^9}, 3.8913675607521257`*^9, {3.8914356032726283`*^9, 
   3.891435603484974*^9}, 3.8952359347473354`*^9, 3.895237241468288*^9, {
   3.895758057977438*^9, 3.8957580912663546`*^9}, {3.895759315833376*^9, 
   3.8957593268934336`*^9}, {3.895759575754737*^9, 3.8957595759442425`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"a3894b42-9b16-446b-99f4-b500710381cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bifurcation curves", "Title",
 CellChangeTimes->{{3.8954278300192676`*^9, 3.89542783307276*^9}, {
  3.8963597852607503`*^9, 
  3.896359785550768*^9}},ExpressionUUID->"4488db71-1104-4303-b187-\
bae35678313d"],

Cell["\<\
Mathematica finds the bifurcation curves satisfying all the constraints \
imposed by the kinetics and the Turing conditions. To do that, it solves an \
initial value problem starting at a bifurcation point found using the lines \
to search defined above.\
\>", "Text",
 CellChangeTimes->{{3.8968754831658187`*^9, 
  3.896875630069837*^9}},ExpressionUUID->"87af798e-5705-4784-8e1b-\
1bc1ecdc431f"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "par", "]"}], "==", "2"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"variabledependence", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "varnum", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"kineticsaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"kinetics", "/.", "fixedpar"}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zerodetaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"zerodet", "/.", "fixedpar"}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zeroderaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"zeroder", "/.", "fixedpar"}], "/.", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", "zeroderaux"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"D", "[", 
      RowBox[{"equations", ",", "time"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{"\[Mu]NF", "'"}], "[", "time", "]"}], "2"], "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"varnum", "=", "1"}], "nvar"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
         "2"]}], "-", 
       SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equations", "[", 
         RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"equationnumber", ",", 
         RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equationsGlobalLP", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"kineticsaux", ",", 
       RowBox[{"zerodetaux", "/.", 
        RowBox[{
         RowBox[{"\[Mu]NF", "[", "time", "]"}], "->", "0"}]}]}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"equationsGlobalLP", "=", 
     RowBox[{"D", "[", 
      RowBox[{"equationsGlobalLP", ",", "time"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equationsGlobalLP", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"varnum", "=", "1"}], "nvar"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
         "2"]}], "-", 
       SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equationsGlobalLP", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equationsGlobalLP", "[", 
         RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"equationnumber", ",", 
         RowBox[{"Length", "[", "equationsGlobalLP", "]"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvar", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", "\[Mu]NF"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvartimedependent", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"allvar", "[", 
         RowBox[{"[", "nvar", "]"}], "]"}], "[", "time", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"nvar", ",", 
         RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"allvarGlobalLP", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvarGlobalLP", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvarGlobalLP", ",", 
      RowBox[{"par", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvarGlobalLPtimedependent", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"allvarGlobalLP", "[", 
         RowBox[{"[", "nvar", "]"}], "]"}], "[", "time", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"nvar", ",", 
         RowBox[{"Length", "[", "allvarGlobalLP", "]"}]}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"numberofbifurcationcurves", "=", 
     RowBox[{"Length", "[", "initialvalueTuring", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"solutioncurves", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"solutioncurvesGlobalLP", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"bifnum", "=", "1"}], ",", 
      RowBox[{"bifnum", "<=", "numberofbifurcationcurves"}], ",", 
      RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fixedparameter", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"par", ",", 
            RowBox[{
             RowBox[{"initialvalueTuring", "[", 
              RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fixedparameter", "==", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"anotherparameter", "=", "2"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"anotherparameter", "=", "1"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "eq", "]"}], "==", "1"}], " ", "||", " ", 
          RowBox[{"simpleeq", "==", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"initialvalues", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"zerodet", ",", "zeroder"}], "}"}], ",", 
                   "kinetics"}], "]"}], "==", "0"}], "/.", "fixedpar"}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "anotherparameter", "]"}], "]"}], ",", 
                   "\[Mu]NF"}], "}"}], ",", "var"}], "]"}], "//", 
               "Evaluate"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"initialvaluesGlobalLP", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", "zerodet", "}"}], ",", "kinetics"}], "]"}], "==",
                   "0"}], "/.", "fixedpar"}], "/.", 
                RowBox[{"\[Mu]NF", "->", "0"}]}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "anotherparameter", "]"}], "]"}], "}"}], ",", 
                 "var"}], "]"}], "//", "Evaluate"}]}], "]"}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"initialvalues", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"zerodet", ",", "zeroder"}], "}"}], "==", "0"}], "/.",
                  "eq"}], "/.", "fixedpar"}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "anotherparameter", "]"}], "]"}], ",", 
                 "\[Mu]NF"}], "}"}], "//", "Evaluate"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"initialvaluesGlobalLP", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NSolve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"zerodet", "==", "0"}], "/.", 
                  RowBox[{"\[Mu]NF", "->", "0"}]}], "/.", "eq"}], "/.", 
                "fixedpar"}], "/.", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"initialvalueTuring", "[", 
                  RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"par", "[", 
                RowBox[{"[", "anotherparameter", "]"}], "]"}], "//", 
               "Evaluate"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialvalues", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"initialvalues", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "varnum", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "->", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"initialvalues", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "varnum", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"varnum", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"initialvalues", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"initialsolnum", ",", 
            RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"initialvalues", "=", 
        RowBox[{"DeleteDuplicates", "[", "initialvalues", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"initialsolnum", "=", "1"}], ",", 
         RowBox[{"initialsolnum", "<=", 
          RowBox[{"Length", "[", "initialvalues", "]"}]}], ",", 
         RowBox[{"initialsolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"initialvalueTuring", "[", 
               RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"simpleeq", "==", "1"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Length", "[", "eq", "]"}], ">", "1"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Quiet", " ", "@", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{"var", "\[Element]", "Reals"}], ")"}]}], "/.", 
                   "eq"}], "/.", "fixedpar"}], "/.", 
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ",", 
                RowBox[{"Continue", "[", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"initialvalues", "[", 
               RowBox[{"[", "initialsolnum", "]"}], "]"}], "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"initialvalues", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "/.", "eq"}], "/.", 
                    "fixedpar"}], "/.", 
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ")"}]}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Activate", "[", 
             RowBox[{"Inactivate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"\[Mu]NF", ",", "Choptol"}], "]"}], "!=", "0"}], 
                 " ", "&&", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"Abs", "[", 
                    RowBox[{"{", 
                    RowBox[{"zerodet", ",", "zeroder"}], "}"}], "]"}], "]"}], 
                  "<", "tol"}], " ", "&&", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "eq", "]"}], ">", "1"}], ",", 
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"var", "/.", "eq"}], ")"}], "-", "var"}], "]"}], 
                    "<", "tol"}], ",", "True"}], "]"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<=", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "anotherparameter", "]"}], "]"}], "<=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"Chop", "[", 
                   RowBox[{"nonzero", ",", "Choptol"}], "]"}], "!=", "0"}]}], 
                "/.", "fixedpar"}], "/.", 
               RowBox[{"initialvalues", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}]}], "]"}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dereval", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"varnum", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"initialderivatives", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"equations", "/.", 
                   RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
                  RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"dernumber", "=", "1"}], ",", 
               RowBox[{"dernumber", "<=", 
                RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
               RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equations", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialvalues", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equationsaux", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tempsol", "=", 
                 RowBox[{"Quiet", "@", 
                  RowBox[{"NDSolve", "[", 
                   RowBox[{"equationsaux", ",", "allvar", ",", 
                    RowBox[{"{", 
                    RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], 
                    ",", 
                    RowBox[{"Method", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<EquationSimplification\>\"", "->", 
                    "\"\<Residual\>\""}], "}"}]}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], "&&",
                    " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"solutioncurves", ",", "tempsol"}], "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initialvaluesGlobalLP", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"initialvaluesGlobalLP", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "varnum", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "->", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"initialvaluesGlobalLP", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "varnum", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"varnum", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"initialvaluesGlobalLP", "[", 
                RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"initialsolnum", ",", 
            RowBox[{"Length", "[", "initialvaluesGlobalLP", "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialvaluesGlobalLP", "=", 
        RowBox[{"DeleteDuplicates", "[", "initialvaluesGlobalLP", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"initialsolnum", "=", "1"}], ",", 
         RowBox[{"initialsolnum", "<=", 
          RowBox[{"Length", "[", "initialvaluesGlobalLP", "]"}]}], ",", 
         RowBox[{"initialsolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{
            RowBox[{"initialvaluesGlobalLP", "[", 
             RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"par", "[", 
              RowBox[{"[", "fixedparameter", "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"initialvalueTuring", "[", 
               RowBox[{"[", "bifnum", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"simpleeq", "==", "1"}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"Length", "[", "eq", "]"}], ">", "1"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Quiet", "@", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Not]", 
                    RowBox[{"(", 
                    RowBox[{"var", "\[Element]", "Reals"}], ")"}]}], "/.", 
                   "eq"}], "/.", "fixedpar"}], "/.", 
                 RowBox[{"initialvaluesGlobalLP", "[", 
                  RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ",", 
                RowBox[{"Continue", "[", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"initialvaluesGlobalLP", "[", 
               RowBox[{"[", "initialsolnum", "]"}], "]"}], "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"initialvaluesGlobalLP", "[", 
                 RowBox[{"[", "initialsolnum", "]"}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "/.", "eq"}], "/.", 
                    "fixedpar"}], "/.", 
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}]}], ")"}]}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], 
               "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Activate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"zerodet", "/.", 
                    RowBox[{"\[Mu]NF", "->", "0"}]}], "]"}], "<", "tol"}], 
                 " ", "&&", " ", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "eq", "]"}], ">", "1"}], ",", 
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"var", "/.", "eq"}], ")"}], "-", "var"}], "]"}], 
                    "<", "tol"}], ",", "True"}], "]"}], " ", "&&", " ", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<=", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "anotherparameter", "]"}], "]"}], "<=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"anotherparameter", "==", "1"}], ",", 
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "]"}], "/.", 
               "fixedpar"}], "/.", 
              RowBox[{"initialvaluesGlobalLP", "[", 
               RowBox[{"[", "initialsolnum", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dereval", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"varnum", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"initialderivatives", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"equationsGlobalLP", "/.", 
                   RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{"allvarGlobalLPtimedependent", ",", "time"}], 
                   "]"}], "/.", 
                  RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"dernumber", "=", "1"}], ",", 
               RowBox[{"dernumber", "<=", 
                RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
               RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equationsGlobalLP", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialvaluesGlobalLP", "[", 
                    RowBox[{"[", "initialsolnum", "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"equationsaux", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"equationsaux", ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"initialderivatives", "[", 
                    RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"equationsaux", ",", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "==", 
                    RowBox[{
                    RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    "smalldifferential"}]}], "//", "Evaluate"}], ",", 
                    "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tempsol", "=", 
                 RowBox[{"Quiet", "@", 
                  RowBox[{"NDSolve", "[", 
                   RowBox[{"equationsaux", ",", "allvarGlobalLP", ",", 
                    RowBox[{"{", 
                    RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], 
                    ",", 
                    RowBox[{"Method", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<EquationSimplification\>\"", "->", 
                    "\"\<Residual\>\""}], "}"}]}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], " ", 
                   "&&", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"solutioncurvesGlobalLP", ",", "tempsol"}], "]"}],
                    ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&",
        " ", 
       RowBox[{
        RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{
            "{", "\"\<This script could not find a Turing bifurcation curve \
or a BD-line for your desired parameters. Try changing tolerances or initial \
values\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}]}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBmIQXfFXofwD61vH2fMO1oBom+meU0F03M7+RSDa9VT0
MjB/McN6EC2y3WgXiD6z6dhREB0QMuMCiO7U8bwEouumz/4Boo228/0G0QvM
Cv+D6BMsRswfgTSX2zJhEL33535REH3V5agsiBaxElYD0T+em5uD6LQNBWDa
5skV1U9Amrf9oAGInnGltBxEH1j+C0zPu1ns8xlIP7rk5g+imW7LRYDoQ0Wq
YPoVl2ACiGbPDMkCi1/pP8LO9tbRwXo5mD5039GVC0jvOcXlDqKvygT7gGiO
5RFgWtchamIkkE4Ucp8Joi1+cO2JBtJi67zA9I8pRkdAdFnL+pMg+pvpJOZE
ID17miQbiF4T9slpPZBWYV7pDqL1Tkj0bWB/6ygfOaEfRDec7jLdDKR/3zGx
ANFhhy+kbQfSTFnZOSD6znzdz7uA9P7LkV9ANAB5CdC7
  "],
 CellLabel->"In[59]:=",ExpressionUUID->"fdb328a8-4025-4938-acf3-217bd8eb2181"]
}, Closed]],

Cell[CellGroupData[{

Cell["Auxiliary variables", "Title",
 CellChangeTimes->{{3.895390247342123*^9, 
  3.8953902504363685`*^9}},ExpressionUUID->"59e5598c-b1a4-495f-b255-\
391127440ca6"],

Cell["\<\
If the third and/or fifth-order coefficients were already found and saved, \
this section only loads the corresponding files. Otherwise, this section \
defines the variables to make the Taylor expansion of the system\
\>", "Text",
 CellChangeTimes->{{3.89687573324382*^9, 
  3.896875807479829*^9}},ExpressionUUID->"14a70aa0-2798-4b9a-8ecd-\
60aaee713a2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coefs", "=", "\"\<y\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"nmax", ">=", "5"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
       "FileExistsQ", "[", "\"\<Third-order coefficient.mx\>\"", "]"}], " ", "&&",
        " ", 
       RowBox[{
       "FileExistsQ", "[", "\"\<Fifth-order coefficient.mx\>\"", "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"C3", "=", 
        RowBox[{"Import", "[", "\"\<Third-order coefficient.mx\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"C5", "=", 
        RowBox[{"Import", "[", "\"\<Fifth-order coefficient.mx\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"coefs", "=", "\"\<n\>\""}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FileExistsQ", "[", "\"\<Third-order coefficient.mx\>\"", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C3", "=", 
       RowBox[{"Import", "[", "\"\<Third-order coefficient.mx\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"coefs", "=", "\"\<n\>\""}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"conjpar", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
           RowBox[{"parval", "[", 
            RowBox[{"[", "parnum", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"parval", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"parnum", ",", 
          RowBox[{"Length", "[", "parval", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conjpar", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"conjpar", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"fixedpar", "[", 
              RowBox[{"[", "parnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"fixedpar", "[", 
             RowBox[{"[", "parnum", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"parnum", ",", 
            RowBox[{"Length", "[", "fixedpar", "]"}]}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"conjpar", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"conjpar", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", "\[Mu]NF", "]"}], "->", "\[Mu]NF"}], ",", 
          RowBox[{
           RowBox[{"Conjugate", "[", "kNF", "]"}], "->", "kNF"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"conjpar", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"conjpar", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"var", "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "]"}], "->", 
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["sol", 
       RowBox[{"0", ",", "0"}]], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["W", 
           RowBox[{"0", ",", "0", ",", "varnum"}]], "[", "X", "]"}], "->", 
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["dersol", 
      RowBox[{"0", ",", "0"}]], "=", 
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["sol", 
        RowBox[{"0", ",", "0"}]], ",", "X"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["der2sol", 
      RowBox[{"0", ",", "0"}]], "=", 
     RowBox[{"D", "[", 
      RowBox[{
       SubscriptBox["dersol", 
        RowBox[{"0", ",", "0"}]], ",", "X"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "1"}], ",", 
      RowBox[{"order", "<=", "5"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"sub", "=", "0"}], ",", 
        RowBox[{"sub", "<=", "5"}], ",", 
        RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"EvenQ", "[", "order", "]"}], "&&", " ", 
             RowBox[{"\[Not]", 
              RowBox[{"EvenQ", "[", "sub", "]"}]}]}], ")"}], " ", "||", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Not]", 
              RowBox[{"EvenQ", "[", "order", "]"}]}], " ", "&&", " ", 
             RowBox[{"EvenQ", "[", "sub", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SubscriptBox["sol", 
             RowBox[{"order", ",", "sub"}]], "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["W", 
                 RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                "]"}], "->", "0"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["dersol", 
             RowBox[{"order", ",", "sub"}]], "=", 
            RowBox[{"D", "[", 
             RowBox[{
              SubscriptBox["sol", 
               RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["der2sol", 
             RowBox[{"order", ",", "sub"}]], "=", 
            RowBox[{"D", "[", 
             RowBox[{
              SubscriptBox["dersol", 
               RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"jacobianmat", "=", 
     RowBox[{"jacobianmat", "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"jacobianmatr", "=", 
     RowBox[{
      RowBox[{"jacmat", "-", 
       RowBox[{
        SuperscriptBox["mul", "2"], "*", "\[Mu]NF", "*", "diffmatrix"}]}], "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]", "=", 
     RowBox[{"\[Phi]", "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Psi]", "=", 
     RowBox[{"\[Psi]", "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["sol", 
      RowBox[{"1", ",", "1"}]], "=", 
     RowBox[{
      SubscriptBox["sol", 
       RowBox[{"1", ",", "1"}]], "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["dersol", 
      RowBox[{"1", ",", "1"}]], "=", 
     RowBox[{
      SubscriptBox["dersol", 
       RowBox[{"1", ",", "1"}]], "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["der2sol", 
      RowBox[{"1", ",", "1"}]], "=", 
     RowBox[{
      SubscriptBox["der2sol", 
       RowBox[{"1", ",", "1"}]], "/.", 
      RowBox[{"\[Mu]NF", "->", 
       SuperscriptBox["kNF", "2"]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"conjprime", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "'"}], "[", "y_", "]"}], "->", 
       RowBox[{"HoldForm", "[", 
        FractionBox[
         RowBox[{"Conjugate", "[", 
          RowBox[{"D", "[", 
           RowBox[{"y", ",", "X"}], "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{"y", ",", "X"}], "]"}]], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"absprime", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "'"}], "[", "y_", "]"}], "->", 
       RowBox[{"HoldForm", "[", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"y", ",", "X"}], "]"}], "*", 
           RowBox[{"Conjugate", "[", "y", "]"}]}], "+", 
          RowBox[{"y", "*", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"D", "[", 
             RowBox[{"y", ",", "X"}], "]"}], "]"}]}]}], 
         RowBox[{"2", "*", 
          RowBox[{"D", "[", 
           RowBox[{"y", ",", "X"}], "]"}], "*", 
          RowBox[{"Abs", "[", "y", "]"}]}]], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"toexpand", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox[
                  RowBox[{
                  "var", "\[LeftDoubleBracket]", "varnum", 
                   "\[RightDoubleBracket]"}], "order"], "[", 
                 RowBox[{"x", ",", "X"}], "]"}], "\[Rule]", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"sub", "=", 
                   RowBox[{"-", "order"}]}], "order"], 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                   "]"}], " ", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                   "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", "x"}]]}]}]}],
                "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "index"}], ",", "varnum"}]], "[", "X", "]"}],
                   "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "index", ",", "varnum"}]], "[", "X",
                     "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"index", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["sol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["sol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["sol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["sol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["sol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["sol", 
       RowBox[{"4", ",", "3"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"toexpandderxx", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox[
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "varnum", 
                    "\[RightDoubleBracket]"}], "order"], "[", 
                   RowBox[{"x", ",", "X"}], "]"}], ",", "x", ",", "x"}], 
                 "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"-", 
                  SuperscriptBox["kNF", "2"]}], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"sub", "=", 
                    RowBox[{"-", "order"}]}], "order"], 
                  RowBox[{
                   SuperscriptBox["sub", "2"], "*", 
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                    "]"}], " ", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", 
                    "x"}]]}]}]}]}], "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "index"}], ",", "varnum"}]], "[", "X", "]"}],
                   "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "index", ",", "varnum"}]], "[", "X",
                     "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"index", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["sol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["sol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["sol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["sol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["sol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["sol", 
       RowBox[{"4", ",", "3"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"toexpandderXx", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox[
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "varnum", 
                    "\[RightDoubleBracket]"}], "order"], "[", 
                   RowBox[{"x", ",", "X"}], "]"}], ",", "X", ",", "x"}], 
                 "]"}], "\[Rule]", 
                RowBox[{"\[ImaginaryI]", "*", "kNF", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"sub", "=", 
                    RowBox[{"-", "order"}]}], "order"], 
                  RowBox[{"sub", "*", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "'"}], "[",
                     "X", "]"}], " ", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", 
                    "x"}]]}]}]}]}], "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "index"}], ",", "varnum"}]], "'"}], "[", "X",
                    "]"}], "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "index", ",", "varnum"}]], "'"}], 
                    "[", "X", "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"index", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["dersol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["dersol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["dersol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["dersol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["dersol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["dersol", 
       RowBox[{"4", ",", "3"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"toexpandderXX", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox[
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "varnum", 
                    "\[RightDoubleBracket]"}], "order"], "[", 
                   RowBox[{"x", ",", "X"}], "]"}], ",", "X", ",", "X"}], 
                 "]"}], "\[Rule]", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"sub", "=", 
                   RowBox[{"-", "order"}]}], "order"], 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "''"}], 
                   "[", "X", "]"}], " ", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                   "\[ImaginaryI]", " ", "sub", " ", "kNF", " ", "x"}]]}]}]}],
                "/.", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", 
                    RowBox[{"-", "index"}], ",", "varnum"}]], "''"}], "[", 
                   "X", "]"}], "->", 
                  RowBox[{"Conjugate", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "index", ",", "varnum"}]], "''"}], 
                    "[", "X", "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"index", ",", "order"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"order", ",", "0", ",", "nmax"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "]"}], "/.", 
           SubscriptBox["der2sol", 
            RowBox[{"1", ",", "0"}]]}], "/.", 
          SubscriptBox["der2sol", 
           RowBox[{"2", ",", "1"}]]}], "/.", 
         SubscriptBox["der2sol", 
          RowBox[{"3", ",", "0"}]]}], "/.", 
        SubscriptBox["der2sol", 
         RowBox[{"3", ",", "2"}]]}], "/.", 
       SubscriptBox["der2sol", 
        RowBox[{"4", ",", "1"}]]}], "/.", 
      SubscriptBox["der2sol", 
       RowBox[{"4", ",", "3"}]]}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8910075082946806`*^9, 3.8910075228152714`*^9}, {
   3.8910075706375017`*^9, 3.891007689903224*^9}, {3.8910077460377865`*^9, 
   3.89100774930982*^9}, {3.891007781849799*^9, 3.891007853468502*^9}, {
   3.891008017415059*^9, 3.891008151150443*^9}, {3.891008309202035*^9, 
   3.8910083581326866`*^9}, {3.891008492978525*^9, 3.8910085112878*^9}, {
   3.8910114915883617`*^9, 3.8910114920076375`*^9}, {3.89101165773881*^9, 
   3.891011664017143*^9}, {3.891012046920682*^9, 3.891012074440398*^9}, {
   3.891012184596204*^9, 3.8910122163935204`*^9}, {3.8912780055534644`*^9, 
   3.8912780076960373`*^9}, {3.8912781218703036`*^9, 
   3.8912781221263046`*^9}, {3.891278194962117*^9, 3.8912782303170443`*^9}, {
   3.891278773046852*^9, 3.8912788436643534`*^9}, {3.8912791446026573`*^9, 
   3.891279188314161*^9}, {3.8912793497010527`*^9, 3.8912793594701085`*^9}, {
   3.8912794172856817`*^9, 3.891279423112281*^9}, {3.891281897496488*^9, 
   3.891281897817503*^9}, {3.89136248810867*^9, 3.891362502184837*^9}, {
   3.8913645114700565`*^9, 3.8913645152918234`*^9}, {3.891367278640957*^9, 
   3.891367311495427*^9}, {3.8914130421374617`*^9, 3.8914130425740347`*^9}, {
   3.8914135362760963`*^9, 3.8914135365610948`*^9}, {3.8914137076765785`*^9, 
   3.891413741796623*^9}, {3.891416307164044*^9, 3.8914163075049815`*^9}, {
   3.891431515366051*^9, 3.8914315265106297`*^9}, {3.8914337264079776`*^9, 
   3.8914337268015714`*^9}, {3.8914376763669553`*^9, 
   3.8914376981032567`*^9}, {3.8914411070760384`*^9, 3.891441136546509*^9}, {
   3.8914413822835703`*^9, 3.8914413825704365`*^9}, {3.8915051980182953`*^9, 
   3.8915052271374483`*^9}, {3.891520166658786*^9, 3.8915201671307216`*^9}, {
   3.8915324782089343`*^9, 3.891532527759901*^9}, {3.895235584088151*^9, 
   3.895235630890587*^9}, {3.8952360909410243`*^9, 3.895236171829955*^9}, {
   3.895237288409603*^9, 3.8952372889664936`*^9}, {3.895241359118166*^9, 
   3.895241409028061*^9}, {3.8952417993318014`*^9, 3.89524183646583*^9}, {
   3.895387170081184*^9, 3.895387182519307*^9}, {3.8953898661484537`*^9, 
   3.8953898856723824`*^9}, {3.8953899194144177`*^9, 
   3.8953899197517204`*^9}, {3.8953905885563765`*^9, 3.895390607315241*^9}, {
   3.895391450865588*^9, 3.8953919242326593`*^9}, 3.895391985075384*^9, {
   3.8953920211990776`*^9, 3.8953920213375607`*^9}, {3.8953933668274937`*^9, 
   3.8953933801894655`*^9}, {3.8953955006391563`*^9, 3.895395563968426*^9}, {
   3.8953968363902445`*^9, 3.8953968801065164`*^9}, {3.8954257449541216`*^9, 
   3.8954257480811863`*^9}, {3.8956433566674643`*^9, 
   3.8956433943818407`*^9}, {3.8956437465872154`*^9, 3.895643807006666*^9}, {
   3.895644396848751*^9, 3.8956445458389225`*^9}, {3.895645045137765*^9, 
   3.8956450784398155`*^9}, {3.8956451094188623`*^9, 3.895645279526049*^9}, {
   3.8956457387859163`*^9, 3.895645821088733*^9}, {3.8956459070171146`*^9, 
   3.895646290172578*^9}, {3.8956471644067316`*^9, 3.895647165409175*^9}, {
   3.895647215957505*^9, 3.8956472201018324`*^9}, 3.8956586185623446`*^9, 
   3.895659105957363*^9, {3.895818642104947*^9, 3.895818642857977*^9}, {
   3.8958364306277103`*^9, 3.8958364312688327`*^9}, {3.896978202783913*^9, 
   3.89697820375253*^9}, {3.896981413824418*^9, 3.8969814142464595`*^9}, {
   3.8969822643910036`*^9, 3.896982280329732*^9}, {3.8969866438788176`*^9, 
   3.8969866540083656`*^9}, {3.8969871294289417`*^9, 3.896987170791191*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"badd11d8-df7e-46a4-8c64-95e5572ef76a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Taylor expansion", "Title",
 CellChangeTimes->{{3.8910073887548065`*^9, 3.891007390926674*^9}, {
  3.8910074344942245`*^9, 3.8910074359215517`*^9}, {3.891007515161849*^9, 
  3.891007516479077*^9}, {3.891008916433653*^9, 3.891008955749086*^9}, {
  3.891280453469096*^9, 3.8912804539701233`*^9}, {3.8915177889106903`*^9, 
  3.891517795162298*^9}, {3.8952372661344137`*^9, 3.89523726799854*^9}, {
  3.8952373039945*^9, 3.895237320623995*^9}, {3.8952385424550734`*^9, 
  3.895238543013917*^9}, {3.8953902584084578`*^9, 
  3.8953902709160185`*^9}},ExpressionUUID->"975f7379-5e89-4c9d-9c35-\
2517707099ec"],

Cell["\<\
Mathematica computes the Taylor expansion of the system up to order nmax\
\>", "Text",
 CellChangeTimes->{{3.896875836206487*^9, 
  3.8968758511092*^9}},ExpressionUUID->"a0fefe8f-2f26-4637-bafc-edd7bea0a157"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expr", "=", 
     RowBox[{"kinetics", "/.", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"var", "[", 
          RowBox[{"[", "varnum", "]"}], "]"}], "->", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"order", "=", "0"}], "nmax"], 
          RowBox[{
           SuperscriptBox["\[Epsilon]NF", "order"], "*", 
           RowBox[{
            SubscriptBox[
             RowBox[{"var", "[", 
              RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
            RowBox[{"x", ",", "X"}], "]"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"expansion", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "1"}], ",", 
      RowBox[{"order", "<=", "nmax"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"expansion", ",", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"order", "!"}]], 
           RowBox[{"D", "[", 
            RowBox[{"expr", ",", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]NF", ",", "order"}], "}"}]}], "]"}]}], "/.", 
          RowBox[{"\[Epsilon]NF", "->", "0"}]}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8906785957145324`*^9, 3.890678609403802*^9}, {
  3.8906787105192423`*^9, 3.890678711054577*^9}, {3.890678776838481*^9, 
  3.8906789625892935`*^9}, {3.89067904003786*^9, 3.89067906663437*^9}, {
  3.891011486353433*^9, 3.891011487715682*^9}, {3.8953902601780715`*^9, 
  3.895390261127928*^9}, {3.8956445610139427`*^9, 3.8956445900903425`*^9}, {
  3.89564629823055*^9, 3.8956463281548204`*^9}, {3.8958430822551403`*^9, 
  3.8958430910459814`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"2e32b0e0-a41c-4002-a99b-e9daae978379"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ansatz expansion", "Title",
 CellChangeTimes->{{3.895390281334725*^9, 
  3.8953902927520714`*^9}},ExpressionUUID->"31009231-e5e1-4bd5-b49d-\
53ebf474df13"],

Cell["\<\
Addition of the linear operator to the expansion of the reaction\
\>", "Text",
 CellChangeTimes->{{3.89687604221647*^9, 
  3.896876070671256*^9}},ExpressionUUID->"9ef0a0d4-5957-4304-b51d-\
4fa62a57d438"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"equations", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "1"}], ",", 
      RowBox[{"order", "<=", "nmax"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"order", "<=", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"equations", ",", 
           RowBox[{
            RowBox[{"expansion", "[", 
             RowBox[{"[", "order", "]"}], "]"}], "+", 
            RowBox[{"Dot", "[", 
             RowBox[{"diffmatrix", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{"x", ",", "x"}]], 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
                  RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}]}]}],
           "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"3", "<=", "order", "<=", "4"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"equations", ",", 
             RowBox[{
              RowBox[{"expansion", "[", 
               RowBox[{"[", "order", "]"}], "]"}], "+", 
              RowBox[{"Dot", "[", 
               RowBox[{"diffmatrix", ",", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "x"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "+", 
                 RowBox[{"2", "*", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "X"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], 
                    RowBox[{"order", "-", "2"}]], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}]}], 
               "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"equations", ",", 
             RowBox[{
              RowBox[{"expansion", "[", 
               RowBox[{"[", "order", "]"}], "]"}], "+", 
              RowBox[{"Dot", "[", 
               RowBox[{"diffmatrix", ",", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "x"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "order"], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}], "+", 
                 RowBox[{"2", "*", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"x", ",", "X"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], 
                    RowBox[{"order", "-", "2"}]], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "+", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"X", ",", "X"}]], 
                    RowBox[{
                    SubscriptBox[
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], 
                    RowBox[{"order", "-", "4"}]], "[", 
                    RowBox[{"x", ",", "X"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], 
               "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8906791447797537`*^9, 3.890679343841946*^9}, {
   3.890679378735796*^9, 3.890679438306658*^9}, {3.8906794761291485`*^9, 
   3.8906796054668407`*^9}, {3.8906800011264915`*^9, 
   3.8906801277077518`*^9}, {3.8906802622761917`*^9, 3.890680278573492*^9}, {
   3.8906805125437913`*^9, 3.8906805224712844`*^9}, {3.8906807449302835`*^9, 
   3.8906808237528253`*^9}, {3.890680891412051*^9, 3.8906810999806385`*^9}, {
   3.891007076654664*^9, 3.8910070774451733`*^9}, {3.8910114394876986`*^9, 
   3.8910114495627565`*^9}, {3.891412511472025*^9, 3.89141251316732*^9}, {
   3.891435688412567*^9, 3.891435688740713*^9}, {3.8953902012661343`*^9, 
   3.895390202476407*^9}, 3.8953923005432415`*^9, {3.8956446055515337`*^9, 
   3.895644667269793*^9}, {3.8956463128668165`*^9, 3.895646322060215*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"751cb34e-5132-4079-9042-ce30049ea319"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving equations at each order", "Title",
 CellChangeTimes->{{3.8953903043084345`*^9, 
  3.8953903089576807`*^9}},ExpressionUUID->"5a3a3e1d-f27d-43c0-b2b2-\
1e5928aa479d"],

Cell["\<\
Mathematica solves the equation at each order to find the symbolic \
coefficients\
\>", "Text",
 CellChangeTimes->{{3.8968760866469383`*^9, 3.8968760903322105`*^9}, {
  3.896876163011267*^9, 
  3.896876197654064*^9}},ExpressionUUID->"1415cb93-4b04-4cb2-959b-\
6a17fceb7fdb"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solvcond", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"solvcond", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "2"}], ",", 
      RowBox[{"order", "<=", "nmax"}], ",", 
      RowBox[{"order", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "order", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"solvcond", ",", "0"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"equation", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"equations", "[", 
             RowBox[{"[", "order", "]"}], "]"}], "/.", "toexpand"}], "/.", 
           "toexpandderxx"}], "/.", "toexpandderXx"}], "/.", 
         "toexpandderXX"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"sub", "=", "0"}], ",", 
         RowBox[{"sub", "<=", "order"}], ",", 
         RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"EvenQ", "[", "order", "]"}], "&&", " ", 
               RowBox[{"\[Not]", " ", 
                RowBox[{"EvenQ", "[", "sub", "]"}]}]}], ")"}], " ", "||", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Not]", " ", 
                RowBox[{"EvenQ", "[", "order", "]"}]}], " ", "&&", " ", 
               RowBox[{"EvenQ", "[", "sub", "]"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"order", "==", "nmax"}], " ", "&&", " ", 
             RowBox[{"sub", "!=", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"order", "==", "4"}], " ", "&&", " ", 
             RowBox[{"sub", ">", "2"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"auxeq", "=", 
           RowBox[{
            RowBox[{
             FractionBox["kNF", 
              RowBox[{"2", "\[Pi]"}]], 
             RowBox[{
              SubsuperscriptBox["\[Integral]", "0", 
               FractionBox[
                RowBox[{"2", "\[Pi]"}], "kNF"]], 
              RowBox[{"equation", "*", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "\[ImaginaryI]"}], "*", "sub", "*", "kNF", "*", 
                 "x"}]], 
               RowBox[{"\[DifferentialD]", "x"}]}]}]}], "//", "Simplify"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"auxeq", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "auxeq"}], "/.", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["W", 
                  RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                 "]"}], "->", "0"}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "//", 
            "Simplify"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"order", "!=", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"sub", "!=", "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"auxsol", "=", 
                 RowBox[{"LinearSolve", "[", 
                  RowBox[{"dummymat", ",", "dummyvec"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"auxsol", "=", 
                 RowBox[{
                  RowBox[{"auxsol", "/.", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"dummymat", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}], "->", 
                    RowBox[{"jacobianmatr", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}]}], "/.", 
                    RowBox[{"mul", "->", "sub"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"row", ",", "nvar"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}], "]"}]}], "/.", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"dummyvec", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"auxeq", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["sol", 
                  RowBox[{"order", ",", "sub"}]], "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], "[", "X", 
                    "]"}], "->", 
                    RowBox[{"auxsol", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"solvcond", ",", 
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{"Dot", "[", 
                    RowBox[{"auxeq", ",", "\[Psi]"}], "]"}], 
                    RowBox[{"Dot", "[", 
                    RowBox[{"\[Phi]", ",", "\[Psi]"}], "]"}]]}]}], "]"}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"order", "!=", "nmax"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"usefulvec", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["auxvec", 
                    RowBox[{"order", ",", "sub", ",", "varnum"}]], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"auxsol", "=", 
                    RowBox[{"LinearSolve", "[", 
                    RowBox[{
                    RowBox[{"dummymat", "[", 
                    RowBox[{"[", 
                    RowBox[{"submatrixrows", ",", "submatrixcols"}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"dummyvec", "[", 
                    RowBox[{"[", "submatrixcols", "]"}], "]"}]}], "]"}]}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"auxsol", "=", 
                    RowBox[{
                    RowBox[{"auxsol", "/.", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dummymat", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}], "->", 
                    RowBox[{"jacobianmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"row", ",", "col"}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"row", ",", "nvar"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"col", ",", "nvar"}], "}"}]}], "]"}], "]"}]}], "/.", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dummyvec", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"auxeq", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"usefulvec", "[", 
                    RowBox[{"[", "submatrixcols", "]"}], "]"}], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", 
                    RowBox[{"submatrixcols", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}]], "[", "X", "]"}], "->", 
                    RowBox[{"auxsol", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"nvar", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"usefulvec", "[", 
                    RowBox[{"[", "criticalcol", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"order", ",", "sub", ",", "criticalcol"}]], "[", 
                    "X", "]"}], "->", "0"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["sol", 
                    RowBox[{"order", ",", "sub"}]], "=", "usefulvec"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["dersol", 
               RowBox[{"order", ",", "sub"}]], "=", 
              RowBox[{"ReleaseHold", "[", 
               RowBox[{
                RowBox[{"ReleaseHold", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    SubscriptBox["sol", 
                    RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}], "/.", 
                  "conjprime"}], "]"}], "/.", "absprime"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["der2sol", 
               RowBox[{"order", ",", "sub"}]], "=", 
              RowBox[{"ReleaseHold", "[", 
               RowBox[{
                RowBox[{"ReleaseHold", "[", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    SubscriptBox["dersol", 
                    RowBox[{"order", ",", "sub"}]], ",", "X"}], "]"}], "/.", 
                  "conjprime"}], "]"}], "/.", "absprime"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8912782820412655`*^9, 3.8912783111581135`*^9}, {
   3.8912784377134094`*^9, 3.891278443135502*^9}, {3.891278547331915*^9, 
   3.8912785888709354`*^9}, {3.8912787467529783`*^9, 3.891278749711026*^9}, {
   3.891278884536026*^9, 3.8912789916188087`*^9}, {3.8912790229653907`*^9, 
   3.89127906433963*^9}, {3.8912792188225007`*^9, 3.8912792198615007`*^9}, {
   3.8912794585216045`*^9, 3.8912794593986015`*^9}, {3.8912805880085635`*^9, 
   3.891280684080511*^9}, {3.8912807150591526`*^9, 3.8912807153991485`*^9}, {
   3.891280936699304*^9, 3.8912811108317165`*^9}, {3.8912812803294473`*^9, 
   3.8912813268544416`*^9}, {3.891281426236225*^9, 3.891281427969783*^9}, {
   3.8912815336214547`*^9, 3.891281639249179*^9}, {3.8912818701198297`*^9, 
   3.8912818713888297`*^9}, {3.8912819208155813`*^9, 
   3.8912819218095827`*^9}, {3.8912822076171083`*^9, 3.891282318313404*^9}, {
   3.8912825751115723`*^9, 3.8912826212847123`*^9}, {3.8912826546672583`*^9, 
   3.8912827145909233`*^9}, {3.8912828335963106`*^9, 
   3.8912828475783844`*^9}, {3.8913597954389353`*^9, 
   3.8913597978244534`*^9}, {3.891360330784241*^9, 3.8913603596211195`*^9}, {
   3.891360394197403*^9, 3.891360585624901*^9}, 3.8913606412383013`*^9, {
   3.89136104632998*^9, 3.8913610734971437`*^9}, {3.891361381676696*^9, 
   3.8913613906487255`*^9}, {3.8913621324210224`*^9, 3.891362229178543*^9}, {
   3.8913623344309015`*^9, 3.8913623436758027`*^9}, {3.8913625553554554`*^9, 
   3.8913625559284544`*^9}, {3.8913626078647614`*^9, 3.891362654793866*^9}, {
   3.891362715307205*^9, 3.8913627557212315`*^9}, {3.891362811221194*^9, 
   3.8913628542578225`*^9}, {3.891362940667872*^9, 3.891362999093012*^9}, {
   3.8913630898132877`*^9, 3.8913630901710696`*^9}, {3.8913632512516766`*^9, 
   3.8913632663831987`*^9}, {3.891363317248144*^9, 3.891363333514456*^9}, {
   3.8913633991670904`*^9, 3.8913634050460224`*^9}, {3.8913636663207836`*^9, 
   3.891363680134602*^9}, {3.8913637145884824`*^9, 3.8913637379783926`*^9}, 
   3.8913638270912437`*^9, {3.8913649928255935`*^9, 3.8913649931821613`*^9}, {
   3.8913654030721235`*^9, 3.8913654040671744`*^9}, {3.891367716953764*^9, 
   3.8913677221237383`*^9}, {3.89136782317605*^9, 3.8913678236042204`*^9}, {
   3.891367885566408*^9, 3.891367888664566*^9}, {3.8913679499782033`*^9, 
   3.891367971310688*^9}, {3.8914120375132008`*^9, 3.891412094986128*^9}, {
   3.891413268910467*^9, 3.8914132726870594`*^9}, {3.891414023563636*^9, 
   3.8914140262890253`*^9}, {3.8914140893393936`*^9, 
   3.8914142612164865`*^9}, {3.891414297934016*^9, 3.8914143301329975`*^9}, {
   3.891414389180242*^9, 3.8914145836630306`*^9}, {3.8914146560237517`*^9, 
   3.8914146614727545`*^9}, {3.891414770984223*^9, 3.8914147763257947`*^9}, {
   3.8914148073470697`*^9, 3.8914148208622484`*^9}, {3.891414860723753*^9, 
   3.891414860999753*^9}, {3.891414952547634*^9, 3.8914150775504436`*^9}, {
   3.891415125237281*^9, 3.891415216515827*^9}, {3.8914153285519023`*^9, 
   3.8914153681869173`*^9}, {3.8914154624744463`*^9, 3.891415527370666*^9}, {
   3.891415661139343*^9, 3.8914157039301195`*^9}, {3.8914159487332935`*^9, 
   3.891415950212698*^9}, {3.891415984105797*^9, 3.8914160079108534`*^9}, {
   3.8914161656298094`*^9, 3.891416213046152*^9}, {3.891416625295349*^9, 
   3.891416635596052*^9}, {3.8914229218997636`*^9, 3.8914229499401245`*^9}, {
   3.89142341798869*^9, 3.8914234228096504`*^9}, {3.8914237507109375`*^9, 
   3.8914237798933787`*^9}, {3.8914238113235064`*^9, 3.891423851109641*^9}, {
   3.891431260440771*^9, 3.8914313209382906`*^9}, {3.8914316657846155`*^9, 
   3.8914316696687536`*^9}, {3.891431960817112*^9, 3.891431962101017*^9}, {
   3.8914331017937126`*^9, 3.8914331398788943`*^9}, {3.8914358792440586`*^9, 
   3.891435885571937*^9}, {3.8914373217754726`*^9, 3.89143737285233*^9}, {
   3.8914378120762835`*^9, 3.891437841168311*^9}, {3.8914384295278845`*^9, 
   3.891438485090257*^9}, {3.891439668887679*^9, 3.891439694809305*^9}, {
   3.8915254782568507`*^9, 3.8915254800623455`*^9}, {3.891861080858152*^9, 
   3.8918610850888844`*^9}, {3.891880980796477*^9, 3.891880981846337*^9}, 
   3.8952389171276217`*^9, {3.895386693938452*^9, 3.895386709906249*^9}, 
   3.895387135780505*^9, {3.89538733045947*^9, 3.8953873313278723`*^9}, {
   3.8953874439392195`*^9, 3.895387472823164*^9}, {3.8953886634166393`*^9, 
   3.895388672060294*^9}, {3.895388965816328*^9, 3.895388991205279*^9}, {
   3.8953892095953755`*^9, 3.8953893127219553`*^9}, {3.8953893975602894`*^9, 
   3.8953894049376087`*^9}, {3.895390869137729*^9, 3.895390877633423*^9}, {
   3.8953912939928827`*^9, 3.8953912941087017`*^9}, {3.89539240555837*^9, 
   3.8953924060524006`*^9}, {3.8953925959865284`*^9, 3.895392602446885*^9}, {
   3.895392719176372*^9, 3.895392794091338*^9}, {3.895395301884531*^9, 
   3.8953953824839306`*^9}, {3.895396729801237*^9, 3.8953967501278334`*^9}, {
   3.8953970110206327`*^9, 3.895397019191662*^9}, {3.8953973833150415`*^9, 
   3.8953973834903526`*^9}, {3.895427323722612*^9, 3.895427337797324*^9}, {
   3.895481074434719*^9, 3.895481074714653*^9}, {3.895643822710439*^9, 
   3.895643831466565*^9}, {3.8956446825851464`*^9, 3.8956448012286882`*^9}, {
   3.8956453241579204`*^9, 3.895645417297291*^9}, {3.8956463340940247`*^9, 
   3.8956463462501907`*^9}, 3.8956980341804876`*^9, {3.895759629460738*^9, 
   3.895759629992372*^9}, {3.895760009026192*^9, 3.895760009460331*^9}, {
   3.895818656147724*^9, 3.895818656857855*^9}, {3.8969818518012753`*^9, 
   3.8969819146601405`*^9}, {3.8969823003510447`*^9, 3.8969823570997996`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"5a683087-6769-48aa-a98b-e2a85730a676"]
}, Closed]],

Cell[CellGroupData[{

Cell["Getting coefficients", "Title",
 CellChangeTimes->{{3.895390348620699*^9, 3.895390351819915*^9}, {
  3.8969647630835314`*^9, 3.896964763411282*^9}, {3.896978745939216*^9, 
  3.8969787539730344`*^9}, {3.896991348668049*^9, 3.896991348986017*^9}, {
  3.8969920861948833`*^9, 
  3.896992086478943*^9}},ExpressionUUID->"b720bbc5-22a5-423a-bc30-\
2c9c18f99b35"],

Cell[TextData[{
 "Mathematica extracts the third and fifth-order coefficients from the \
previous expansion.Also, Mathematica finds the coefficients ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Alpha]", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1c5345f7-0a35-4c7d-ae45-1213626b5d6e"],
 " that determine the equation the amplitude solves at a codimension-two point"
}], "Text",
 CellChangeTimes->{{3.8968762104715314`*^9, 3.8968762359741545`*^9}, {
  3.8968762702631063`*^9, 3.896876270463159*^9}, {3.8968763144780784`*^9, 
  3.896876362736129*^9}},ExpressionUUID->"246e49dc-2627-4f96-b123-\
14166c8ea7ee"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"coefs", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C3", "=", 
     RowBox[{"solvcond", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"order", "=", "2"}], ",", 
      RowBox[{"order", ">=", "0"}], ",", 
      RowBox[{"order", "--"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"sub", "=", "0"}], ",", 
        RowBox[{"sub", "<=", "order"}], ",", 
        RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"C3", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"C3", "/.", 
             SubscriptBox["sol", 
              RowBox[{"order", ",", "sub"}]]}], "/.", 
            SubscriptBox["dersol", 
             RowBox[{"order", ",", "sub"}]]}], "/.", 
           SubscriptBox["der2sol", 
            RowBox[{"order", ",", "sub"}]]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"C3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"C3", "/.", "conjpar"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "->", "0"}]}], "/.", 
      RowBox[{
       RowBox[{
        SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<Third-order coefficient.mx\>\"", ",", "C3"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"nmax", ">=", "5"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"C5", "=", 
        RowBox[{"solvcond", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"order", "=", "4"}], ",", 
         RowBox[{"order", ">=", "0"}], ",", 
         RowBox[{"order", "--"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"sub", "=", "0"}], ",", 
           RowBox[{"sub", "<=", "order"}], ",", 
           RowBox[{"sub", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"order", "==", "4"}], " ", "&&", " ", 
               RowBox[{"sub", ">", "2"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"C5", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"C5", "/.", 
                SubscriptBox["sol", 
                 RowBox[{"order", ",", "sub"}]]}], "/.", 
               SubscriptBox["dersol", 
                RowBox[{"order", ",", "sub"}]]}], "/.", 
              SubscriptBox["der2sol", 
               RowBox[{"order", ",", "sub"}]]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"alphaval", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"C5", "=", 
           RowBox[{
            RowBox[{"FunctionExpand", "[", "C5", "]"}], "/.", "conjpar"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Alpha]NF", "1"], "=", 
           RowBox[{
            RowBox[{"C5", "/.", 
             RowBox[{
              RowBox[{
               SubscriptBox["A", "1"], "[", "X", "]"}], "->", "0"}]}], "/.", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["A", "1"], "''"}], "[", "X", "]"}], "->", 
             "1"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"C5", "=", 
           RowBox[{"C5", "/.", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["A", "1"], "''"}], "[", "X", "]"}], "->", 
             "0"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Alpha]NF", "2"], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Coefficient", "[", 
                RowBox[{
                 RowBox[{"C5", "/.", 
                  RowBox[{
                   RowBox[{"Conjugate", "[", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "]"}], "->",
                    "0"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["A", "1"], "'"}], "[", "X", "]"}]}], "]"}], "/.", 
               RowBox[{
                RowBox[{
                 SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}], 
              ")"}]}], "/.", "conjpar"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Alpha]NF", "3"], "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], "*", 
              RowBox[{"Coefficient", "[", 
               RowBox[{"C5", ",", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "]"}]}], 
               "]"}]}], "/.", 
             RowBox[{
              RowBox[{
               SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}], "/.", 
            "conjpar"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"C5", "=", 
           RowBox[{
            RowBox[{"C5", "/.", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "->", "0"}]}],
             "/.", 
            RowBox[{
             RowBox[{
              SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"\"\<alpha1.mx\>\"", ",", 
            SubscriptBox["\[Alpha]NF", "1"]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"\"\<alpha2.mx\>\"", ",", 
            SubscriptBox["\[Alpha]NF", "2"]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"\"\<alpha3.mx\>\"", ",", 
            SubscriptBox["\[Alpha]NF", "3"]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"C5", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"C5", "/.", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["A", "1"], "''"}], "[", "X", "]"}], "->", 
               "0"}]}], "/.", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["A", "1"], "'"}], "[", "X", "]"}], "->", "0"}]}],
             "/.", 
            RowBox[{
             RowBox[{
              SubscriptBox["A", "1"], "[", "X", "]"}], "->", "1"}]}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<Fifth-order coefficient.mx\>\"", ",", "C5"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8914376241605654`*^9, 3.891437625671474*^9}, 
   3.8914382911451178`*^9, {3.8914388897827864`*^9, 3.891439065182951*^9}, {
   3.891439119608291*^9, 3.891439168326683*^9}, {3.8914392353822303`*^9, 
   3.891439238500129*^9}, {3.891439560881304*^9, 3.891439565447703*^9}, {
   3.8914400015391097`*^9, 3.891440019625805*^9}, {3.8914403390958195`*^9, 
   3.8914403516674366`*^9}, {3.8914503903976126`*^9, 
   3.8914504018431015`*^9}, {3.8915013270022745`*^9, 3.891501330139021*^9}, {
   3.8915022961652966`*^9, 3.891502359730925*^9}, {3.891502469505395*^9, 
   3.8915024719227877`*^9}, {3.8915026141559153`*^9, 
   3.8915026503921366`*^9}, {3.891502714836328*^9, 3.8915027182923822`*^9}, {
   3.891502760885398*^9, 3.8915027844538755`*^9}, {3.8915028902000794`*^9, 
   3.8915028969473505`*^9}, {3.8915029384217854`*^9, 
   3.8915029648688636`*^9}, {3.891503052754713*^9, 3.8915030588663254`*^9}, {
   3.891505260377139*^9, 3.891505293340233*^9}, {3.8915064733065796`*^9, 
   3.8915065087743053`*^9}, {3.891508234492185*^9, 3.8915082502339034`*^9}, {
   3.891508472614611*^9, 3.8915084755185566`*^9}, {3.8915325670930986`*^9, 
   3.8915325770378704`*^9}, {3.89188095188918*^9, 3.891880952091041*^9}, {
   3.891884474856989*^9, 3.8918844757016673`*^9}, {3.8952373955893164`*^9, 
   3.895237396042495*^9}, {3.895237865421593*^9, 3.8952378690960236`*^9}, 
   3.8952382192690163`*^9, {3.895241558859524*^9, 3.8952415837353716`*^9}, {
   3.8952418549496403`*^9, 3.895241859580656*^9}, {3.89538783589052*^9, 
   3.8953878858010006`*^9}, {3.8953882186605673`*^9, 
   3.8953882296697774`*^9}, {3.8953976961694365`*^9, 
   3.8953977172602215`*^9}, {3.895397761957958*^9, 3.895397762277561*^9}, {
   3.8953978074834905`*^9, 3.895397933607459*^9}, {3.8953980014624505`*^9, 
   3.8953984672575445`*^9}, {3.895398504039594*^9, 3.895398527169013*^9}, {
   3.8953986402722783`*^9, 3.895398675379572*^9}, {3.8953987079759316`*^9, 
   3.895398728270647*^9}, 3.895398884226127*^9, {3.8953994783501787`*^9, 
   3.895399481227302*^9}, {3.8953995321779966`*^9, 3.8953995382616615`*^9}, {
   3.8953998690952263`*^9, 3.895399896780435*^9}, {3.8954254166535406`*^9, 
   3.8954254181848574`*^9}, {3.895425454771001*^9, 3.895425507004882*^9}, {
   3.895425773777924*^9, 3.8954258414560623`*^9}, {3.8954336902439423`*^9, 
   3.895433701819147*^9}, {3.895434167089511*^9, 3.895434171103548*^9}, {
   3.8956454298322716`*^9, 3.8956454658611383`*^9}, {3.895646352585684*^9, 
   3.895646363160283*^9}, 3.8956464994453096`*^9, {3.895698040743148*^9, 
   3.8956980442315083`*^9}, {3.8969646650379877`*^9, 3.896964673279891*^9}, {
   3.896964754579067*^9, 3.8969647548365417`*^9}, {3.8969787045808268`*^9, 
   3.89697873816442*^9}, {3.896991323794711*^9, 3.896991329217147*^9}, {
   3.8969919460924926`*^9, 3.8969920822575912`*^9}, {3.896992353091651*^9, 
   3.8969924445599003`*^9}, {3.896992570074011*^9, 3.896992590843325*^9}, {
   3.8970573919606304`*^9, 3.8970574701667337`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"92b76d96-921d-4849-a40c-d06b5af83e61"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"C3", "/.", "eq"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C5", "/.", "eq"}], "/.", "parval"}], "/.", 
  RowBox[{"kNF", "->", 
   SubscriptBox["q", "c"]}]}]}], "Input",
 CellChangeTimes->{{3.8970651151239433`*^9, 3.897065141402752*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"2b9511a3-b4e7-432c-aedd-09566707b7bc"],

Cell[BoxData[
 RowBox[{"3", " ", 
  SubscriptBox["b", "3"]}]], "Output",
 CellChangeTimes->{{3.897065116014099*^9, 3.897065142073347*^9}},
 CellLabel->"Out[81]=",ExpressionUUID->"65b3fd25-a8e7-422f-a7b8-5c55e4fcebdf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "10"}], " ", 
   SubscriptBox["b", "5"]}], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    SubsuperscriptBox["b", "3", "2"]}], 
   RowBox[{"64", " ", 
    SubsuperscriptBox["q", "c", "4"]}]]}]], "Output",
 CellChangeTimes->{{3.897065116014099*^9, 3.897065142076347*^9}},
 CellLabel->"Out[82]=",ExpressionUUID->"c6ea37ed-4c5a-4ee1-9aa8-fc87969ec7ff"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross-order coefficient", "Title",
 CellChangeTimes->{{3.8958441162737217`*^9, 3.8958441751882124`*^9}, {
  3.896978624828581*^9, 
  3.8969786250025845`*^9}},ExpressionUUID->"22ed8e9a-ac08-49b1-a105-\
ccaa93207ba4"],

Cell["Mathematica finds the cross-order coefficient, if requested", "Text",
 CellChangeTimes->{{3.8968762944456177`*^9, 
  3.896876307054241*^9}},ExpressionUUID->"33f00c93-f20f-42d8-bde1-\
743c401a23cc"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"crosscoef", "==", "\"\<y\>\""}], " ", "&&", " ", 
    RowBox[{
     RowBox[{"Length", "[", "eq", "]"}], ">", "1"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "crosspar", "]"}], "==", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"crosspar", "=", 
        RowBox[{"crosspar", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"C11", "=", 
     FractionBox[
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"jacobianmat", "/.", "eq"}], ",", "crosspar"}], "]"}], 
          ",", "\[Phi]"}], "]"}], ",", "\[Psi]"}], "]"}], 
      RowBox[{"Dot", "[", 
       RowBox[{"\[Phi]", ",", "\[Psi]"}], "]"}]]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8958441601729593`*^9, 3.8958442156110077`*^9}, {
   3.89584428961308*^9, 3.8958443871887455`*^9}, {3.895844422323782*^9, 
   3.8958444232395816`*^9}, 3.89584446009347*^9, {3.895844536249735*^9, 
   3.8958445441398525`*^9}, {3.8968762769944887`*^9, 3.896876277839266*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"c55ec3d7-8d3f-4fab-8804-a4ea848a2cb1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Changes of criticality", "Title",
 CellChangeTimes->{{3.8954324193678913`*^9, 3.895432430516776*^9}, {
  3.8968763837307997`*^9, 
  3.896876386803398*^9}},ExpressionUUID->"8258dbe0-d1fc-429e-b0fe-\
ea1230796fe6"],

Cell["Mathematica finds the changes of criticality if requested", "Text",
 CellChangeTimes->{{3.8968763943004045`*^9, 
  3.8968764032385044`*^9}},ExpressionUUID->"be60d8d7-f0cb-4095-b82c-\
19e8939f49b4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Catch", "[", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&", 
     " ", 
     RowBox[{
      RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Throw", "[", 
      "\"\<This script could not find a bifurcation curve for this \
system\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nmax", ">=", "5"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fifthcoeff", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"criticalitychanges", "!=", "\"\<y\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Throw", "[", 
         "\"\<You do not want to find changes of criticality\>\"", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"codimensiontwopoints", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"outersolnum", "=", "1"}], ",", 
       RowBox[{"outersolnum", "<=", 
        RowBox[{"Length", "[", "solutioncurves", "]"}]}], ",", 
       RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"innersolnum", "=", "1"}], ",", 
         RowBox[{"innersolnum", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"solutioncurves", "[", 
            RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aux", "=", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
             "]"}], "/.", "variabledependence"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Variables", "[", 
              RowBox[{
               RowBox[{"aux", "/.", 
                RowBox[{
                 RowBox[{"solutioncurves", "[", 
                  RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
               RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"auxC3", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", "time", "}"}], ",", "#", ",", 
               RowBox[{"RuntimeOptions", "->", 
                RowBox[{"{", 
                 RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}], 
                 "}"}]}]}], "]"}], "&"}], "@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"C3", "/.", "fixedpar"}], "/.", 
                   RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{"\[Mu]NF", "->", 
                 RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
               "variabledependence"}], "/.", 
              RowBox[{
               RowBox[{"solutioncurves", "[", 
                RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"allvals", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{"auxC3", "[", "time", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "timedifference"}], 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vals", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"valnum", "=", "1"}], ",", 
            RowBox[{"valnum", "<=", 
             RowBox[{
              RowBox[{"Length", "[", "allvals", "]"}], "-", "1"}]}], ",", 
            RowBox[{"valnum", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"allvals", "[", 
                   RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "*", 
                 RowBox[{
                  RowBox[{"allvals", "[", 
                   RowBox[{"[", 
                    RowBox[{"valnum", "+", "1"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "<", "0"}], " ", "&&", 
               " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"allvals", "[", 
                  RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ">", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Chop", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", 
                    RowBox[{
                    RowBox[{"allvals", "[", 
                    RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  "Choptol"}], "]"}], "!=", "0"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"vals", ",", 
                RowBox[{
                 RowBox[{"allvals", "[", 
                  RowBox[{"[", "valnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"tnum", "=", "1"}], ",", 
            RowBox[{"tnum", "<=", 
             RowBox[{"Length", "[", "vals", "]"}]}], ",", 
            RowBox[{"tnum", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"initialvalueoft", "=", 
              RowBox[{"vals", "[", 
               RowBox[{"[", "tnum", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"critchangetemp", "=", 
              RowBox[{"time", "/.", 
               RowBox[{"Quiet", "@", 
                RowBox[{"FindRoot", "[", 
                 RowBox[{
                  RowBox[{"auxC3", "[", "time", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"time", ",", "initialvalueoft"}], "}"}]}], 
                 "]"}]}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<=", "critchangetemp", "<=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], " ", "&&", " ", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"auxC3", "[", "critchangetemp", "]"}], "]"}], "<", 
                 "tol"}], " ", "&&", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "critchangetemp", "]"}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}], ">", 
                 "0"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"auxiliaryarray", "=", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"\[Mu]NF", "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}], 
                  "/.", 
                  RowBox[{"time", "->", "critchangetemp"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"codimensiontwopoints", ",", "auxiliaryarray"}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"ValueQ", "[", "fifthcoeff", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"fifthcoeff", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
                    RowBox[{"time", "->", "critchangetemp"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"C5", "/.", "fixedpar"}], "/.", 
                    RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                    RowBox[{"\[Mu]NF", "->", 
                    RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
                    "variabledependence"}], "/.", 
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
                    RowBox[{"time", "->", "critchangetemp"}]}], "}"}]}], 
                    "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "codimensiontwopoints", "]"}], ">", "0"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"codimensiontwopoints", "=", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"par", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "\[Mu]NF"}], "}"}], ",", 
            "var"}], "]"}], "/.", "codimensiontwopoints"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"codimensiontwopoints", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"codimensiontwopoints", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"EuclideanDistance", "[", "##", "]"}], "<", "disttol"}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"critchange", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "->", 
              RowBox[{
               RowBox[{"codimensiontwopoints", "[", 
                RowBox[{"[", "critnum", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "->", 
              RowBox[{
               RowBox[{"codimensiontwopoints", "[", 
                RowBox[{"[", "critnum", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"critnum", ",", 
             RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"codimensiontwopoints", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"par", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"codimensiontwopoints", "[", 
                  RowBox[{"[", "critnum", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"3", "+", "varnum"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"critnum", ",", 
             RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ValueQ", "[", "fifthcoeff", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"auxarr", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"critnum", "=", "1"}], ",", 
             RowBox[{"critnum", "<=", 
              RowBox[{"Length", "[", "critchange", "]"}]}], ",", 
             RowBox[{"critnum", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"getout", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"fifthnum", "=", "1"}], ",", 
                RowBox[{"fifthnum", "<=", 
                 RowBox[{"Length", "[", "fifthcoeff", "]"}]}], ",", 
                RowBox[{"fifthnum", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"getout", "==", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"fifthcoeff", "[", 
                    RowBox[{"[", "fifthnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "/.", 
                   RowBox[{"critchange", "[", 
                    RowBox[{"[", "critnum", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"auxarr", ",", 
                    RowBox[{"fifthcoeff", "[", 
                    RowBox[{"[", "fifthnum", "]"}], "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"getout", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fifthcoeff", "=", "auxarr"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ValueQ", "[", "fifthcoeff", "]"}], " ", "&&", " ", 
           RowBox[{
            RowBox[{"Length", "[", "fifthcoeff", "]"}], ">", "0"}]}], ",", 
          RowBox[{
           RowBox[{"Export", "[", 
            RowBox[{
            "\"\<Fifth-order coefficient at codimension-two bifurcation \
points.txt\>\"", ",", "fifthcoeff"}], "]"}], ";"}], "\[IndentingNewLine]", 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ValueQ", "[", "critchange", "]"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"Length", "[", "critchange", "]"}], ">", "0"}]}], ",", 
             RowBox[{"Export", "[", 
              RowBox[{
              "\"\<Codimension-two bifurcation points.txt\>\"", ",", 
               "critchange"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]",
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.895432439016435*^9, 3.89543244673415*^9}, {
   3.8954324990803785`*^9, 3.895432586711835*^9}, {3.8954326762482696`*^9, 
   3.8954326770459056`*^9}, {3.895432715266409*^9, 3.8954327174397974`*^9}, {
   3.8954327690198593`*^9, 3.8954328375704412`*^9}, {3.8954329061120834`*^9, 
   3.8954329190150194`*^9}, {3.8954329516860323`*^9, 3.895433003076493*^9}, {
   3.8954332756657686`*^9, 3.8954332813660984`*^9}, {3.8954341875323477`*^9, 
   3.895434191486082*^9}, {3.8954342660500345`*^9, 3.895434311458144*^9}, {
   3.8954343612755375`*^9, 3.8954344420803947`*^9}, {3.895434646750369*^9, 
   3.8954346543234153`*^9}, {3.895434697269803*^9, 3.895434699002818*^9}, {
   3.895434768338003*^9, 3.895434806713364*^9}, {3.8956434054218225`*^9, 
   3.895643468187522*^9}, {3.89564383977068*^9, 3.8956438451513195`*^9}, {
   3.895650088308819*^9, 3.89565009062534*^9}, {3.895650267321447*^9, 
   3.8956502706981363`*^9}, {3.8956591154363317`*^9, 
   3.8956591175214195`*^9}, {3.8956593009952574`*^9, 
   3.8956593011714635`*^9}, {3.895659333807905*^9, 3.8956594333466425`*^9}, {
   3.895661053455301*^9, 3.8956610563638334`*^9}, 3.8956622091287374`*^9, {
   3.895664293872265*^9, 3.8956643251240177`*^9}, {3.8956663634840117`*^9, 
   3.8956663636448126`*^9}, {3.8956680905655947`*^9, 3.8956681955856557`*^9}, 
   3.8969786155944386`*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"1563a7cb-eece-4d24-ae39-9fc8fff20e3b"],

Cell[BoxData["\<\"This script could not find a bifurcation curve for this \
system\"\>"], "Output",
 CellChangeTimes->{3.897065103310952*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"d54a548b-7aba-46e2-97e5-6721aff2138d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Bifurcation diagram plotting", "Title",
 CellChangeTimes->{{3.895435198809738*^9, 
  3.8954352032012653`*^9}},ExpressionUUID->"d50f385e-4539-490d-b5a5-\
aafb6b65b078"],

Cell[TextData[{
 "Mathematica plots the bifurcation curves found colored according to the \
sign of the third order coefficient and the sign of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["k", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "20efb386-542a-4ae2-82e3-506004c3f2d9"]
}], "Text",
 CellChangeTimes->{{3.896876499310449*^9, 
  3.8968765237501154`*^9}},ExpressionUUID->"bd19fffe-c90d-4430-8d32-\
8e9cca6e1e30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Catch", "[", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "solutioncurves", "]"}], "==", "0"}], " ", "&&", 
     " ", 
     RowBox[{
      RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}], "==", "0"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Throw", "[", 
      "\"\<This script could not find a bifurcation curve for this \
system\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "parnames", "]"}], "<", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"parnames", "=", "par"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ValueQ", "[", "critchange", "]"}], " ", "&&", " ", 
        RowBox[{
         RowBox[{"Length", "[", "critchange", "]"}], ">=", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"critpoints", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/.", 
                RowBox[{"critchange", "[", 
                 RowBox[{"[", "critnum", "]"}], "]"}]}], "]"}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"critnum", ",", 
             RowBox[{"Length", "[", "critchange", "]"}]}], "}"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"bifcurveplot", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"GlobalLPplot", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"outersolnum", "=", "1"}], ",", 
       RowBox[{"outersolnum", "<=", 
        RowBox[{"Length", "[", "solutioncurves", "]"}]}], ",", 
       RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"innersolnum", "=", "1"}], ",", 
         RowBox[{"innersolnum", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"solutioncurves", "[", 
            RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aux", "=", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{
                 RowBox[{"par", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
             "]"}], "/.", "variabledependence"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Variables", "[", 
              RowBox[{
               RowBox[{"aux", "/.", 
                RowBox[{
                 RowBox[{"solutioncurves", "[", 
                  RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
               RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"auxnonzero", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", "time", "}"}], ",", "#", ",", 
               RowBox[{"RuntimeOptions", "->", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
              "]"}], "&"}], "@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar"}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{"\[Mu]NF", "->", 
                 RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
               "variabledependence"}], "/.", 
              RowBox[{
               RowBox[{"solutioncurves", "[", 
                RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"auxC3", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", "time", "}"}], ",", "#", ",", 
               RowBox[{"RuntimeOptions", "->", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
              "]"}], "&"}], "@", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"C3", "/.", "fixedpar"}], "/.", 
                   RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{"\[Mu]NF", "->", 
                 RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
               "variabledependence"}], "/.", 
              RowBox[{
               RowBox[{"solutioncurves", "[", 
                RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
               RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempplot", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"ParametricPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                     " ", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], "<", "0"}]}], 
                   "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                     " ", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], ">", "0"}]}], 
                   "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], "<", "0"}]}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Mu]NF", "[", "time", "]"}], "==", "0"}], "/.", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}], " ", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                    RowBox[{
                    RowBox[{"par", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                    "}"}], "/.", " ", 
                   RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"time", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Red", ",", "Blue", ",", 
                 RowBox[{"{", 
                  RowBox[{"Green", ",", "Dotted"}], "}"}], ",", "Gray"}], 
                "}"}]}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"bifcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"outersolnum", "=", "1"}], ",", 
       RowBox[{"outersolnum", "<=", 
        RowBox[{"Length", "[", "solutioncurvesGlobalLP", "]"}]}], ",", 
       RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"innersolnum", "=", "1"}], ",", 
         RowBox[{"innersolnum", "<=", 
          RowBox[{"Length", "[", 
           RowBox[{"solutioncurvesGlobalLP", "[", 
            RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tempplot", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"ParametricPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                 RowBox[{
                  RowBox[{"par", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}], 
                "}"}], "/.", " ", 
               RowBox[{
                RowBox[{"solutioncurvesGlobalLP", "[", 
                 RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"time", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurvesGlobalLP", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurvesGlobalLP", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", "Gray", "}"}]}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervalx", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"intervaly", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"GlobalLPplot", ",", "tempplot"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bifcurveplot", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"bifcurveplot", ",", "GlobalLPplot"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CreateDocument", "[", 
      RowBox[{
       RowBox[{"Dynamic", "[", "plot2", "]"}], ",", 
       RowBox[{"WindowSize", "->", 
        RowBox[{"{", 
         RowBox[{"500", ",", "500"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", "critpoints", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plot2", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"bifcurveplot", ",", "critpoints", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
             ",", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"RotateLabel", "->", "False"}], ",", 
          RowBox[{"FrameStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
          RowBox[{"AspectRatio", "->", "1"}]}], "]"}]}], " ", 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"plot2", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"bifcurveplot", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
             ",", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"parnames", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"RotateLabel", "->", "False"}], ",", 
          RowBox[{"FrameStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
          RowBox[{"AspectRatio", "->", "1"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8954352407655687`*^9, 3.895435351307047*^9}, {
  3.895435406752877*^9, 3.8954354378472877`*^9}, {3.8954355841780214`*^9, 
  3.8954356080053015`*^9}, {3.895475873745516*^9, 3.8954758751751575`*^9}, {
  3.8956434806516714`*^9, 3.89564351456166*^9}, {3.8956438539857783`*^9, 
  3.895643854171158*^9}, {3.8956678403166037`*^9, 3.895667883594569*^9}, {
  3.8956699925482097`*^9, 3.8956699934140873`*^9}, {3.8956702605384316`*^9, 
  3.895670260998264*^9}, {3.8956708198734627`*^9, 3.895670823120852*^9}, {
  3.8956708941952596`*^9, 3.8956709050484095`*^9}, {3.8956710648408823`*^9, 
  3.8956711092212105`*^9}, {3.8956711766630573`*^9, 3.8956711773613887`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"9b433723-f3b4-4c41-a9c6-27561d0be08d"],

Cell[BoxData["\<\"This script could not find a bifurcation curve for this \
system\"\>"], "Output",
 CellChangeTimes->{3.8956700947369757`*^9, 3.8956704419192724`*^9, 
  3.895671025046344*^9, 3.895671254475441*^9, 3.8956731260791807`*^9, 
  3.8956764888689327`*^9, 3.8956790576497917`*^9, 3.8957485733674126`*^9, 
  3.8957532853548174`*^9, 3.895756524712311*^9, 3.8957587518790207`*^9, 
  3.895758977726225*^9, 3.8957593422901907`*^9, 3.895759403106267*^9, 
  3.8957596390214477`*^9, 3.895759691609788*^9, 3.895759827472419*^9, 
  3.895760059676918*^9, 3.8957609334321327`*^9, 3.8957609943004365`*^9, 
  3.8957611641402364`*^9, 3.895818725760618*^9, 3.895818826517378*^9, 
  3.8958188862515516`*^9, 3.895819259166627*^9, 3.8958193730309353`*^9, 
  3.89581951139474*^9, 3.89584361864001*^9, 3.89584445451706*^9, 
  3.8970651033740616`*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"776cb83a-b48c-4855-bfbe-c251a41427ad"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3D bifurcation curves", "Title",
 CellChangeTimes->{{3.895475618755782*^9, 3.895475622324048*^9}, {
  3.8956477345179358`*^9, 
  3.895647736795082*^9}},ExpressionUUID->"1b7279de-0e9a-4073-b020-\
f91d9b567541"],

Cell["Mathematica continues codimension-two curves, if requested", "Text",
 CellChangeTimes->{{3.8968765379964027`*^9, 
  3.89687654933407*^9}},ExpressionUUID->"6e5294df-fd8c-47fb-85ca-\
cd85145d1851"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"checker", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Not]", 
     RowBox[{"ValueQ", "[", "critchange", "]"}]}], " ", "||", " ", 
    RowBox[{
     RowBox[{"Length", "[", "critchange", "]"}], "==", "0"}], " ", "||", " ", 
    RowBox[{"cod2", "!=", "\"\<y\>\""}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"checker", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lowerbound", "=", 
     RowBox[{"Range", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"upperbound", "=", 
     RowBox[{"Range", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"otherpar", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", "3"}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"par", ",", 
          RowBox[{"par3", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"index", "=", "1"}], ",", 
          RowBox[{"index", "<=", "2"}], ",", 
          RowBox[{"index", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", "parnum", "]"}], "]"}], "==", 
             RowBox[{"par", "[", 
              RowBox[{"[", "index", "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"index", "==", "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervalx", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervalx", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervaly", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", "parnum", "]"}], "]"}], "=", 
                 RowBox[{"intervaly", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"otherpar", ",", "parnum"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"lowerbound", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "=", 
          RowBox[{"extrainterval", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"upperbound", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "=", 
          RowBox[{"extrainterval", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fixedparameter3", "=", "parnum"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"parval3", "=", "parval"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", 
       RowBox[{"Length", "[", "fixedpar", "]"}]}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "fixedparameter3", "]"}], "]"}], "==", 
         RowBox[{
          RowBox[{"fixedpar", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"parval3", ",", 
           RowBox[{"fixedpar", "[", 
            RowBox[{"[", "parnum", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"incond", "=", 
          RowBox[{"fixedpar", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"fixedpar3", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{"fixedpar", ",", 
       RowBox[{"{", 
        RowBox[{"parval3", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"conjprime3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "'"}], "[", "y_", "]"}], "->", 
       RowBox[{"HoldForm", "[", 
        FractionBox[
         RowBox[{"Conjugate", "[", 
          RowBox[{"D", "[", 
           RowBox[{"y", ",", "time"}], "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{"y", ",", "time"}], "]"}]], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"absprime3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "'"}], "[", "y_", "]"}], "->", 
       RowBox[{"HoldForm", "[", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"y", ",", "time"}], "]"}], "*", 
           RowBox[{"Conjugate", "[", "y", "]"}]}], "+", 
          RowBox[{"y", "*", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"D", "[", 
             RowBox[{"y", ",", "time"}], "]"}], "]"}]}]}], 
         RowBox[{"2", "*", 
          RowBox[{"D", "[", 
           RowBox[{"y", ",", "time"}], "]"}], "*", 
          RowBox[{"Abs", "[", "y", "]"}]}]], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"kineticsaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"kinetics", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zerodetaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zerodet", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zeroderaux", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zeroder", "/.", "fixedpar3"}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"auxC3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"C3", "/.", "fixedpar3"}], "/.", 
           RowBox[{"kNF", "->", 
            SqrtBox["\[Mu]NF"]}]}], "/.", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "->", 
          RowBox[{
           RowBox[{"par3", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"par3", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "->", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
       RowBox[{"\[Mu]NF", "->", 
        RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
      "variabledependence"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", "zeroderaux"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", "auxC3"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"ReleaseHold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"equations", ",", "time"}], "]"}], "/.", "conjprime3"}], "/.",
        "absprime3"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"equations", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "'"}], "[", "time", "]"}], "2"], 
       "+", 
       SuperscriptBox[
        RowBox[{
         RowBox[{"\[Mu]NF", "'"}], "[", "time", "]"}], "2"], "+", 
       RowBox[{
        UnderoverscriptBox["\[Sum]", 
         RowBox[{"varnum", "=", "1"}], "nvar"], 
        SuperscriptBox[
         RowBox[{
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}], 
         "2"]}], "-", 
       SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equations", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"equations", "[", 
         RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"equationnumber", ",", 
         RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"allvar", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "varnum", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", "nvar"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par3", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par3", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", 
      RowBox[{"par3", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"allvar", ",", "\[Mu]NF"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"allvartimedependent", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"allvar", "[", 
         RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"varnum", ",", 
         RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"initialconditions", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "codimensiontwopoints", "]"}], "==", "1"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"initialconditions", ",", 
         RowBox[{"codimensiontwopoints", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"pointnum", "=", "1"}], ",", 
        RowBox[{"pointnum", "<=", 
         RowBox[{"Length", "[", "codimensiontwopoints", "]"}]}], ",", 
        RowBox[{"pointnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"inp", "=", 
          RowBox[{"HoldForm", "[", 
           RowBox[{"Input", "[", 
            RowBox[{
            "\"\<Would you like to continue point \>\"", " ", "<>", " ", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"codimensiontwopoints", "[", 
                RowBox[{"[", "pointnum", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", "2"}], "]"}], "]"}], "]"}], " ", "<>", " ", 
             "\"\<[y/n]\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"inp", "==", "\"\<y\>\""}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"initialconditions", ",", 
              RowBox[{"codimensiontwopoints", "[", 
               RowBox[{"[", "pointnum", "]"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"solutioncurves3", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"bifnum", "=", "1"}], ",", 
      RowBox[{"bifnum", "<=", "numberofbifurcationcurves"}], ",", 
      RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"initialvalues", "=", 
        RowBox[{"initialconditions", "[", 
         RowBox[{"[", "bifnum", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"initialvalues", ",", "incond"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dereval", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"initialvalues", "[", 
              RowBox[{"[", "varnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"varnum", ",", 
            RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"initialderivatives", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"equations", "/.", 
             RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
            RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"dernumber", "=", "1"}], ",", 
         RowBox[{"dernumber", "<=", 
          RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
         RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equations", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialvalues", "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                RowBox[{
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equationsaux", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", 
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time", 
                 "]"}], "==", 
                RowBox[{
                 RowBox[{"extrainterval", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time", 
                 "]"}], "==", 
                RowBox[{
                 RowBox[{"extrainterval", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempsol", "=", 
           RowBox[{"Quiet", "@", 
            RowBox[{"NDSolve", "[", 
             RowBox[{"equationsaux", ",", "allvar", ",", 
              RowBox[{"{", 
               RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], ",", 
              RowBox[{"Method", "->", 
               RowBox[{"{", 
                RowBox[{
                "\"\<EquationSimplification\>\"", "->", "\"\<Residual\>\""}], 
                "}"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], " ", "&&", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"solutioncurves3", ",", "tempsol"}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "solutioncurves3", "]"}], "==", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aux", "=", 
        RowBox[{"CreateDocument", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"aux", ",", "Next", ",", "Cell"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookWrite", "[", 
        RowBox[{"aux", ",", 
         RowBox[{"Cell", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{
            "{", "\"\<This script could not find a Codimension-two \
bifurcation curve for your desired parameters. Try changing tolerances or \
initial values\>\"", "}"}], "]"}], ",", "\"\<Output\>\""}], "]"}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8954756273405137`*^9, 3.895475680722141*^9}, {
   3.8954757199021873`*^9, 3.8954758654317746`*^9}, 3.8954810434786043`*^9, {
   3.89564353007386*^9, 3.8956435618080664`*^9}, {3.895647645975181*^9, 
   3.8956476865588245`*^9}, {3.8956479328569984`*^9, 3.895648092395144*^9}, 
   3.895649018040077*^9, {3.8956490500832844`*^9, 3.895649257820964*^9}, {
   3.8956493077475405`*^9, 3.8956494188913093`*^9}, {3.8956494644125137`*^9, 
   3.895649605964903*^9}, {3.8956500643300824`*^9, 3.895650070246585*^9}, 
   3.8956592913265467`*^9, {3.8956594469643993`*^9, 3.895659453193489*^9}, {
   3.895676570492354*^9, 3.89567657344588*^9}, {3.89568350308055*^9, 
   3.895683648539012*^9}, {3.8956836910193853`*^9, 3.89568370386314*^9}, {
   3.8956838209975967`*^9, 3.895683821660875*^9}, {3.895683863637514*^9, 
   3.8956838645487967`*^9}, {3.89568419948907*^9, 3.895684221602098*^9}, {
   3.8956846921169868`*^9, 3.895684698108713*^9}, {3.8956847421099863`*^9, 
   3.895684746342307*^9}, {3.8956849028087263`*^9, 3.8956849624188795`*^9}, {
   3.8956856734041705`*^9, 3.895685693929438*^9}, {3.8956857512385283`*^9, 
   3.895685751506445*^9}, {3.895686549929406*^9, 3.8956865528353987`*^9}, {
   3.8956866047754164`*^9, 3.8956867482981462`*^9}, {3.8956869361394515`*^9, 
   3.8956869599486666`*^9}, {3.895686991707305*^9, 3.8956870677566414`*^9}, {
   3.895687116649618*^9, 3.8956871189746037`*^9}, {3.8956871879575033`*^9, 
   3.8956872009934635`*^9}, {3.8956876620715685`*^9, 
   3.8956876940470743`*^9}, {3.895687746184574*^9, 3.895687759124637*^9}, {
   3.8956880062896843`*^9, 3.895688031844426*^9}, {3.8956881548866568`*^9, 
   3.895688155786559*^9}, {3.895688257910473*^9, 3.8956882936422844`*^9}, {
   3.8956883257030473`*^9, 3.895688403244361*^9}, {3.8956887751194715`*^9, 
   3.8956887801966853`*^9}, {3.8956888209053383`*^9, 3.895688824966505*^9}, {
   3.8956889656555414`*^9, 3.895688973744858*^9}, {3.895748654960019*^9, 
   3.8957486551683736`*^9}, {3.8957523722513633`*^9, 3.895752373768447*^9}, {
   3.8968770243344393`*^9, 3.89687703636053*^9}, {3.8968770668907347`*^9, 
   3.896877075466335*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"482e93db-e6df-423f-ba70-4d0a435202b3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Other Turing bifurcation curves", "Title",
 CellChangeTimes->{{3.89547591085975*^9, 
  3.895475915530171*^9}},ExpressionUUID->"8aeea5b5-47a5-4bfc-91b2-\
e38b668c0d13"],

Cell["\<\
As for the continuation of codimension two curves, an extra parameter is \
needed, this section computes more Turing bifurcation curves when that \
parameter is fixed at the parameter values provided above. The initial \
conditions considered are the codimension-two points found for that fixed \
parameter value in the previous cell\
\>", "Text",
 CellChangeTimes->{{3.896876563234068*^9, 3.89687660243521*^9}, {
  3.8968766546217346`*^9, 3.8968766615603895`*^9}, {3.8968771223123074`*^9, 
  3.896877169142969*^9}},ExpressionUUID->"54680546-436d-411a-b1b4-\
4c7c938a4711"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fixedparametervalues", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"initialconditions", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"turingbifurcationcurves", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"turingnumber", "=", "1"}], ",", 
      RowBox[{"turingnumber", "<=", 
       RowBox[{"Length", "[", "otherTuring", "]"}]}], ",", 
      RowBox[{"turingnumber", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"fixedparametervalues", ",", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "fixedparameter3", "]"}], "]"}], "->", 
          RowBox[{"otherTuring", "[", 
           RowBox[{"[", "turingnumber", "]"}], "]"}]}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"turingnumber", "=", "1"}], ",", 
      RowBox[{"turingnumber", "<=", 
       RowBox[{"Length", "[", "otherTuring", "]"}]}], ",", 
      RowBox[{"turingnumber", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"getout", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"outersolnum", "=", "1"}], ",", 
         RowBox[{"outersolnum", "<=", 
          RowBox[{"Length", "[", "solutioncurves3", "]"}]}], ",", 
         RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"getout", "==", "1"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"innersolnum", "=", "1"}], ",", 
            RowBox[{"innersolnum", "<=", 
             RowBox[{"Length", "[", 
              RowBox[{"solutioncurves3", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"solt", "=", 
              RowBox[{"Quiet", "@", 
               RowBox[{"NMinimize", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time",
                     "]"}], "-", 
                    RowBox[{
                    RowBox[{"fixedparametervalues", "[", 
                    RowBox[{"[", "turingnumber", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"], "/.", 
                  RowBox[{
                   RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                   RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", "time"}], 
                "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<=", 
                RowBox[{"(", 
                 RowBox[{"time", "/.", 
                  RowBox[{"solt", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "<=", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"solt", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "tol"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"initialconditions", ",", 
                    RowBox[{"Check", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "/.", 
                    RowBox[{"solt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "Null"}], "]"}]}], 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"initialconditions", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"allvar", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allvar", "[", 
                    RowBox[{"[", "varnum", "]"}], "]"}], "[", "time", "]"}], "/.", 
                    RowBox[{"initialconditions", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}], "/.", 
                    RowBox[{"solt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"varnum", ",", 
                    RowBox[{"Length", "[", "allvar", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"getout", "=", "1"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]",
                 "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"bifnum", "=", "1"}], ",", 
      RowBox[{"bifnum", "<=", 
       RowBox[{"Length", "[", "initialconditions", "]"}]}], ",", 
      RowBox[{"bifnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fixedparametereval", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "fixedparameter3", "]"}], "]"}], "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", "fixedparameter3", "]"}], "]"}], "/.", 
            RowBox[{"initialconditions", "[", 
             RowBox[{"[", "bifnum", "]"}], "]"}]}], ")"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kineticsaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"kinetics", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", 
                RowBox[{"otherpar", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", 
              RowBox[{"otherpar", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"\[Mu]NF", "->", 
           RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zerodetaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"zerodet", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", 
                RowBox[{"otherpar", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", 
              RowBox[{"otherpar", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"\[Mu]NF", "->", 
           RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zeroderaux", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"zeroder", "/.", "fixedpar3"}], "/.", 
             "fixedparametereval"}], "/.", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", 
                RowBox[{"otherpar", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time", 
              "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"par3", "[", 
             RowBox[{"[", 
              RowBox[{"otherpar", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "->", 
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time", 
             "]"}]}]}], "/.", 
          RowBox[{"\[Mu]NF", "->", 
           RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
         "variabledependence"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"kineticsaux", ",", "zerodetaux"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", "zeroderaux"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", 
         RowBox[{
          RowBox[{"par3", "[", 
           RowBox[{"[", "fixedparameter3", "]"}], "]"}], "[", "time", "]"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"D", "[", 
         RowBox[{"equations", ",", "time"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"equations", ",", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "'"}], "[", 
            "time", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{
             RowBox[{"par3", "[", 
              RowBox[{"[", 
               RowBox[{"otherpar", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "'"}], "[", 
            "time", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"\[Mu]NF", "'"}], "[", "time", "]"}], "2"], "+", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"varnum", "=", "1"}], "nvar"], 
           SuperscriptBox[
            RowBox[{
             RowBox[{
              RowBox[{"var", "[", 
               RowBox[{"[", "varnum", "]"}], "]"}], "'"}], "[", "time", "]"}],
             "2"]}], "-", 
          SuperscriptBox["curvespeed", "2"]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"equations", "[", 
            RowBox[{"[", "equationnumber", "]"}], "]"}], "==", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"equationnumber", ",", 
            RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"initialvalues", "=", 
        RowBox[{"initialconditions", "[", 
         RowBox[{"[", "bifnum", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dereval", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"initialvalues", "[", 
              RowBox[{"[", "varnum", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "->", 
           RowBox[{
            RowBox[{"initialvalues", "[", 
             RowBox[{"[", "varnum", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"varnum", ",", 
            RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"initialderivatives", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"equations", "/.", 
             RowBox[{"time", "->", "0"}]}], "/.", "dereval"}], ",", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"allvartimedependent", ",", "time"}], "]"}], "/.", 
            RowBox[{"time", "->", "0"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"dernumber", "=", "1"}], ",", 
         RowBox[{"dernumber", "<=", 
          RowBox[{"Length", "[", "initialderivatives", "]"}]}], ",", 
         RowBox[{"dernumber", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equations", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialvalues", "[", 
                   RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", "0", "]"}], "==", 
                RowBox[{
                 RowBox[{"initialvalues", "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", "initialvalues", "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"equationsaux", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"equationsaux", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", 
                RowBox[{
                 RowBox[{
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "[", 
                  RowBox[{"[", "varnum", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"varnum", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"initialderivatives", "[", 
                   RowBox[{"[", "dernumber", "]"}], "]"}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"lowerbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "-", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equationsaux", ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", "time",
                  "]"}], "==", 
                RowBox[{
                 RowBox[{"upperbound", "[", 
                  RowBox[{"[", 
                   RowBox[{"otherpar", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "+", 
                 "smalldifferential"}]}], "//", "Evaluate"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempsol", "=", 
           RowBox[{"NDSolve", "[", 
            RowBox[{"equationsaux", ",", "allvar", ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", "initialt", ",", "finalt"}], "}"}], ",", 
             RowBox[{"Method", "->", 
              RowBox[{"{", 
               RowBox[{
               "\"\<EquationSimplification\>\"", "->", "\"\<Residual\>\""}], 
               "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tempsol", "]"}], ">", "0"}], " ", "&&", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"tempsol", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"turingbifurcationcurves", ",", "tempsol"}], "]"}], 
             ";"}], ","}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8954759238653526`*^9, 3.8954759865585675`*^9}, {
  3.895643572304961*^9, 3.8956436047670174`*^9}, {3.8956481296260095`*^9, 
  3.89564820575352*^9}, {3.895649650965356*^9, 3.8956497256967926`*^9}, {
  3.895689469106891*^9, 3.895689484387652*^9}, {3.895689532343933*^9, 
  3.895689617869485*^9}, {3.895689674770615*^9, 3.8956896828142223`*^9}, {
  3.8956897253476787`*^9, 3.895689735228913*^9}, {3.8956898088363514`*^9, 
  3.895689912624589*^9}, {3.8956899615465884`*^9, 3.895689967384285*^9}, {
  3.895690037784216*^9, 3.8956900603790655`*^9}, {3.8956901129443216`*^9, 
  3.8956902457114444`*^9}, {3.89569030592418*^9, 3.8956903156685514`*^9}, {
  3.896877206445666*^9, 3.896877212330518*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"d1a38189-a75f-495a-8e90-0c9d80700ad3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Codimension-two bifurcation diagram plotting", "Title",
 CellChangeTimes->{
  3.8954760027248507`*^9},ExpressionUUID->"d8e321cb-8dd8-47b4-8dd2-\
a1cdcb039ab4"],

Cell["\<\
Mathematica plots the codimension-two curve with all the other Turing \
bifurcation curves found in the previous cell. The intersections between the \
Turing curves and the codimension-two curve will also be marked.\
\>", "Text",
 CellChangeTimes->{{3.8968766738681097`*^9, 
  3.8968767413823028`*^9}},ExpressionUUID->"abc3d507-0518-4b9a-a98d-\
7d6f72638fbd"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"checker", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"parnames3", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"counter", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"parnum", "=", "1"}], ",", 
      RowBox[{"parnum", "<=", "3"}], ",", 
      RowBox[{"parnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"par", ",", 
          RowBox[{"par3", "[", 
           RowBox[{"[", "parnum", "]"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"parnames3", ",", 
           RowBox[{"parnames", "[", 
            RowBox[{"[", "counter", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"counter", "=", 
          RowBox[{"counter", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "par3name", "]"}], "==", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"parnames3", ",", "par3name"}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"parnames3", ",", 
            RowBox[{"par3", "[", 
             RowBox[{"[", "fixedparameter3", "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"bifcurveplot", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"turingcurveplot", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"critpoints", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par3", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"par3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"par3", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/.", 
            RowBox[{"initialconditions", "[", 
             RowBox[{"[", "bifnum", "]"}], "]"}]}], "]"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"bifnum", ",", 
         RowBox[{"Length", "[", "initialconditions", "]"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"outersolnum", "=", "1"}], ",", 
      RowBox[{"outersolnum", "<=", 
       RowBox[{"Length", "[", "turingbifurcationcurves", "]"}]}], ",", 
      RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"innersolnum", "=", "1"}], ",", 
        RowBox[{"innersolnum", "<=", 
         RowBox[{"Length", "[", 
          RowBox[{"turingbifurcationcurves", "[", 
           RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"aux", "=", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
            "]"}], "/.", "variabledependence"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Variables", "[", 
             RowBox[{
              RowBox[{"aux", "/.", 
               RowBox[{
                RowBox[{"turingbifurcationcurves", "[", 
                 RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
              RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"auxnonzero", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}], 
                "}"}]}]}], "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar3"}], "/.", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"turingbifurcationcurves", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"auxC3", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}], 
                "}"}]}]}], "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"C3", "/.", "fixedpar3"}], "/.", 
                   RowBox[{"kNF", "->", 
                    SqrtBox["\[Mu]NF"]}]}], "/.", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"turingbifurcationcurves", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                   " ", 
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], "<", "0"}]}], 
                 " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}], " ", "&&",
                   " ", 
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxC3", "[", "time", "]"}], ",", "Choptol"}], 
                    "]"}], "\[Element]", "Reals"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"Re", "[", 
                    RowBox[{"auxC3", "[", "time", "]"}], "]"}], ">", "0"}]}], 
                 " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], "<", "0"}]}], " ", "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", 
                 RowBox[{
                  RowBox[{"turingbifurcationcurves", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"turingbifurcationcurves", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Green", ",", "Dotted"}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"turingcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"outersolnum", "=", "1"}], ",", 
      RowBox[{"outersolnum", "<=", 
       RowBox[{"Length", "[", "solutioncurves3", "]"}]}], ",", 
      RowBox[{"outersolnum", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"innersolnum", "=", "1"}], ",", 
        RowBox[{"innersolnum", "<=", 
         RowBox[{"Length", "[", 
          RowBox[{"solutioncurves3", "[", 
           RowBox[{"[", "outersolnum", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"innersolnum", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"aux", "=", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{
                RowBox[{"par3", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}], ",", 
               RowBox[{"\[Mu]NF", "[", "time", "]"}]}], "}"}], ",", "var"}], 
            "]"}], "/.", "variabledependence"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Variables", "[", 
             RowBox[{
              RowBox[{"aux", "/.", 
               RowBox[{
                RowBox[{"solutioncurves3", "[", 
                 RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                RowBox[{"[", "innersolnum", "]"}], "]"}]}], "/.", 
              RowBox[{"time", "->", "0"}]}], "]"}], "!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"auxnonzero", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", "time", "}"}], ",", "#", ",", 
              RowBox[{"RuntimeOptions", "->", 
               RowBox[{"\"\<EvaluateSymbolically\>\"", "->", "False"}]}]}], 
             "]"}], "&"}], "@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"nonzero", "/.", "fixedpar3"}], "/.", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"par3", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "->", 
                 RowBox[{
                  RowBox[{"par3", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}]}], "/.", 
               RowBox[{"\[Mu]NF", "->", 
                RowBox[{"\[Mu]NF", "[", "time", "]"}]}]}], "/.", 
              "variabledependence"}], "/.", 
             RowBox[{
              RowBox[{"solutioncurves3", "[", 
               RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
              RowBox[{"[", "innersolnum", "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", 
          RowBox[{"Quiet", "@", 
           RowBox[{"ParametricPlot3D", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Chop", "[", 
                    RowBox[{
                    RowBox[{"auxnonzero", "[", "time", "]"}], ",", 
                    "Choptol"}], "]"}], "!=", "0"}], " ", "&&", " ", 
                  RowBox[{
                   RowBox[{"\[Mu]NF", "[", "time", "]"}], ">", "0"}]}], "/.", 
                 RowBox[{
                  RowBox[{"solutioncurves3", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", "time", "]"}], ",", 
                   RowBox[{
                    RowBox[{"par3", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", "time", "]"}]}], 
                  "}"}], "/.", " ", 
                 RowBox[{
                  RowBox[{"solutioncurves3", "[", 
                   RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                  RowBox[{"[", "innersolnum", "]"}], "]"}]}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"time", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"solutioncurves3", "[", 
                    RowBox[{"[", "outersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "innersolnum", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", "\"\<Domain\>\"", 
                  "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "->", "Black"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"lowerbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"upperbound", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"bifcurveplot", ",", "tempplot"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bifcurveplot", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"turingcurveplot", ",", "bifcurveplot"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"CreateDocument", "[", 
     RowBox[{
      RowBox[{"Dynamic", "[", "plot3", "]"}], ",", 
      RowBox[{"WindowSize", "->", 
       RowBox[{"{", 
        RowBox[{"500", ",", "500"}], "}"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ValueQ", "[", "critpoints", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"plot3", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"bifcurveplot", ",", "critpoints", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "StandardForm"}], "]"}]}],
            "}"}]}], ",", 
         RowBox[{"RotateLabel", "->", "False"}], ",", 
         RowBox[{"AxesStyle", "->", 
          RowBox[{"Directive", "[", 
           RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
         RowBox[{"BoxRatios", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}], " ", 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"plot3", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"bifcurveplot", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "StandardForm"}], "]"}], 
            ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"parnames3", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "StandardForm"}], "]"}]}],
            "}"}]}], ",", 
         RowBox[{"RotateLabel", "->", "False"}], ",", 
         RowBox[{"AxesStyle", "->", 
          RowBox[{"Directive", "[", 
           RowBox[{"FontSize", "->", "15"}], "]"}]}], ",", 
         RowBox[{"BoxRatios", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.895476046596933*^9, 3.89547608140477*^9}, {
   3.8956436164038916`*^9, 3.89564364598274*^9}, {3.8956482322981625`*^9, 
   3.8956482508370934`*^9}, {3.8956499003847294`*^9, 
   3.8956499217983027`*^9}, {3.895690376580452*^9, 3.895690472517498*^9}, {
   3.8956914996468005`*^9, 3.8956915003492856`*^9}, {3.895691549426552*^9, 
   3.895691587904831*^9}, {3.895691918821433*^9, 3.8956919555170517`*^9}, {
   3.8956920251025147`*^9, 3.89569206214524*^9}, {3.895692094525321*^9, 
   3.895692109882864*^9}, {3.895692978415348*^9, 3.8956930242312098`*^9}, {
   3.895693206646363*^9, 3.8956932422293415`*^9}, {3.895693997116338*^9, 
   3.895694001905223*^9}, {3.895697246384327*^9, 3.8956972559521537`*^9}, 
   3.8956974256394386`*^9, {3.89569763833916*^9, 3.8956976811608944`*^9}, {
   3.895751951268671*^9, 3.8957520009447107`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"7d6aac12-cf9b-4179-a52e-ac2b6dc47746"]
}, Closed]]
},
WindowSize->{1428., 735.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.3 Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"533841ac-82d1-44a9-bf7e-86a6e75e106d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 165, 3, 126, "Title",ExpressionUUID->"ea61d8e4-711d-4d74-b25b-761ac764db40"],
Cell[748, 27, 240, 6, 45, "Text",ExpressionUUID->"fb852f10-685d-44ae-b15a-4cf30567a1b9"],
Cell[991, 35, 179, 3, 36, "Input",ExpressionUUID->"4dd8c56a-24c9-40ec-9db2-0034b1e9c701"]
}, Closed]],
Cell[CellGroupData[{
Cell[1207, 43, 307, 5, 91, "Title",ExpressionUUID->"64324ed7-52be-4b1e-98cb-d02a137df024"],
Cell[1517, 50, 309, 6, 45, "Text",ExpressionUUID->"edf22f9a-7a61-4ca6-96ad-ede52a777aa8"],
Cell[1829, 58, 5772, 124, 730, "Input",ExpressionUUID->"cc69dd3d-cbfb-4595-8acd-5d98b925aded"]
}, Closed]],
Cell[CellGroupData[{
Cell[7638, 187, 153, 3, 91, "Title",ExpressionUUID->"4ef2af19-48fd-4c88-b205-32b86bb1aa82"],
Cell[7794, 192, 458, 9, 75, "Text",ExpressionUUID->"5554f862-fa6d-4737-b089-27d14a42d11b"],
Cell[8255, 203, 8028, 175, 854, "Input",ExpressionUUID->"5cbca695-ca74-488b-a139-a446b3ff92a4"]
}, Closed]],
Cell[CellGroupData[{
Cell[16320, 383, 227, 4, 91, "Title",ExpressionUUID->"b4b8a194-920c-498a-838c-7ef029e5294d"],
Cell[16550, 389, 322, 7, 45, "Text",ExpressionUUID->"b4d74d42-b282-4d76-a057-3e600b12bab6"],
Cell[16875, 398, 14767, 354, 1451, "Input",ExpressionUUID->"ba1473d1-5aed-4060-aac2-2c3cb7a6c1f1"]
}, Closed]],
Cell[CellGroupData[{
Cell[31679, 757, 213, 4, 91, "Title",ExpressionUUID->"5cafe80f-fe2b-43f2-bc97-220a654ba175"],
Cell[31895, 763, 258, 6, 45, "Text",ExpressionUUID->"ae428f0a-a208-480c-87b1-50551fc4c33b"],
Cell[32156, 771, 1872, 48, 161, "Input",ExpressionUUID->"a3894b42-9b16-446b-99f4-b500710381cf"]
}, Closed]],
Cell[CellGroupData[{
Cell[34065, 824, 213, 4, 91, "Title",ExpressionUUID->"4488db71-1104-4303-b187-bae35678313d"],
Cell[34281, 830, 406, 8, 75, "Text",ExpressionUUID->"87af798e-5705-4784-8e1b-1bc1ecdc431f"],
Cell[34690, 840, 47377, 1113, 3175, "Input",ExpressionUUID->"fdb328a8-4025-4938-acf3-217bd8eb2181"]
}, Closed]],
Cell[CellGroupData[{
Cell[82104, 1958, 164, 3, 91, "Title",ExpressionUUID->"59e5598c-b1a4-495f-b255-391127440ca6"],
Cell[82271, 1963, 365, 7, 75, "Text",ExpressionUUID->"14a70aa0-2798-4b9a-8ecd-60aaee713a2f"],
Cell[82639, 1972, 23516, 577, 1698, "Input",ExpressionUUID->"badd11d8-df7e-46a4-8c64-95e5572ef76a"]
}, Closed]],
Cell[CellGroupData[{
Cell[106192, 2554, 606, 9, 91, "Title",ExpressionUUID->"975f7379-5e89-4c9d-9c35-2517707099ec"],
Cell[106801, 2565, 218, 4, 45, "Text",ExpressionUUID->"a0fefe8f-2f26-4637-bafc-edd7bea0a157"],
Cell[107022, 2571, 2159, 52, 291, "Input",ExpressionUUID->"2e32b0e0-a41c-4002-a99b-e9daae978379"]
}, Closed]],
Cell[CellGroupData[{
Cell[109218, 2628, 161, 3, 91, "Title",ExpressionUUID->"31009231-e5e1-4bd5-b49d-53ebf474df13"],
Cell[109382, 2633, 213, 5, 45, "Text",ExpressionUUID->"9ef0a0d4-5957-4304-b51d-4fa62a57d438"],
Cell[109598, 2640, 6204, 138, 463, "Input",ExpressionUUID->"751cb34e-5132-4079-9042-ce30049ea319"]
}, Closed]],
Cell[CellGroupData[{
Cell[115839, 2783, 178, 3, 91, "Title",ExpressionUUID->"5a3a3e1d-f27d-43c0-b2b2-1e5928aa479d"],
Cell[116020, 2788, 284, 7, 45, "Text",ExpressionUUID->"1415cb93-4b04-4cb2-959b-6a17fceb7fdb"],
Cell[116307, 2797, 17437, 343, 1277, "Input",ExpressionUUID->"5a683087-6769-48aa-a98b-e2a85730a676"]
}, Closed]],
Cell[CellGroupData[{
Cell[133781, 3145, 362, 6, 91, "Title",ExpressionUUID->"b720bbc5-22a5-423a-bc30-2c9c18f99b35"],
Cell[134146, 3153, 641, 13, 75, "Text",ExpressionUUID->"246e49dc-2627-4f96-b123-14166c8ea7ee"],
Cell[134790, 3168, 10539, 238, 880, "Input",ExpressionUUID->"92b76d96-921d-4849-a40c-d06b5af83e61"],
Cell[CellGroupData[{
Cell[145354, 3410, 357, 8, 62, "Input",ExpressionUUID->"2b9511a3-b4e7-432c-aedd-09566707b7bc"],
Cell[145714, 3420, 217, 4, 41, "Output",ExpressionUUID->"65b3fd25-a8e7-422f-a7b8-5c55e4fcebdf"],
Cell[145934, 3426, 399, 11, 88, "Output",ExpressionUUID->"c6ea37ed-4c5a-4ee1-9aa8-fc87969ec7ff"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[146382, 3443, 221, 4, 91, "Title",ExpressionUUID->"22ed8e9a-ac08-49b1-a105-ccaa93207ba4"],
Cell[146606, 3449, 203, 3, 45, "Text",ExpressionUUID->"33f00c93-f20f-42d8-bde1-743c401a23cc"],
Cell[146812, 3454, 1404, 36, 211, "Input",ExpressionUUID->"c55ec3d7-8d3f-4fab-8804-a4ea848a2cb1"]
}, Closed]],
Cell[CellGroupData[{
Cell[148253, 3495, 218, 4, 91, "Title",ExpressionUUID->"8258dbe0-d1fc-429e-b0fe-ea1230796fe6"],
Cell[148474, 3501, 203, 3, 45, "Text",ExpressionUUID->"be60d8d7-f0cb-4095-b82c-19e8939f49b4"],
Cell[CellGroupData[{
Cell[148702, 3508, 26463, 596, 2164, "Input",ExpressionUUID->"1563a7cb-eece-4d24-ae39-9fc8fff20e3b"],
Cell[175168, 4106, 220, 3, 70, "Output",ExpressionUUID->"d54a548b-7aba-46e2-97e5-6721aff2138d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[175437, 4115, 173, 3, 91, "Title",ExpressionUUID->"d50f385e-4539-490d-b5a5-aafb6b65b078"],
Cell[175613, 4120, 449, 11, 45, "Text",ExpressionUUID->"bd19fffe-c90d-4430-8d32-8e9cca6e1e30"],
Cell[CellGroupData[{
Cell[176087, 4135, 22902, 527, 1545, "Input",ExpressionUUID->"9b433723-f3b4-4c41-a9c6-27561d0be08d"],
Cell[198992, 4664, 917, 13, 70, "Output",ExpressionUUID->"776cb83a-b48c-4855-bfbe-c251a41427ad"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[199958, 4683, 215, 4, 91, "Title",ExpressionUUID->"1b7279de-0e9a-4073-b020-f91d9b567541"],
Cell[200176, 4689, 201, 3, 45, "Text",ExpressionUUID->"6e5294df-fd8c-47fb-85ca-cd85145d1851"],
Cell[200380, 4694, 29556, 721, 2656, "Input",ExpressionUUID->"482e93db-e6df-423f-ba70-4d0a435202b3"]
}, Closed]],
Cell[CellGroupData[{
Cell[229973, 5420, 173, 3, 91, "Title",ExpressionUUID->"8aeea5b5-47a5-4bfc-91b2-e38b668c0d13"],
Cell[230149, 5425, 583, 10, 105, "Text",ExpressionUUID->"54680546-436d-411a-b1b4-4c7c938a4711"],
Cell[230735, 5437, 23432, 556, 1654, "Input",ExpressionUUID->"d1a38189-a75f-495a-8e90-0c9d80700ad3"]
}, Closed]],
Cell[CellGroupData[{
Cell[254204, 5998, 165, 3, 91, "Title",ExpressionUUID->"d8e321cb-8dd8-47b4-8dd2-a1cdcb039ab4"],
Cell[254372, 6003, 369, 7, 75, "Text",ExpressionUUID->"abc3d507-0518-4b9a-a98d-7d6f72638fbd"],
Cell[254744, 6012, 33751, 784, 2227, "Input",ExpressionUUID->"7d6aac12-cf9b-4179-a52e-ac2b6dc47746"]
}, Closed]]
}
]
*)

